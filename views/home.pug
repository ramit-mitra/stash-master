extends layout

block navbar
  nav.navbar.navbar-expand-lg.navbar-light.bg-white
    a.navbar-brand(href='/') 
      img(src="https://png.icons8.com/color/48/000000/yoda.png")
      |   Stash Master
    button.navbar-toggler(type='button', data-toggle='collapse', data-target='#navbarSupportedContent', aria-controls='navbarSupportedContent', aria-expanded='false', aria-label='Toggle navigation')
      span.navbar-toggler-icon
    #navbarSupportedContent.collapse.navbar-collapse
      ul.navbar-nav.mr-auto
        li.nav-item.active
          a.nav-link(href='/home')
            | Home 
            span.sr-only (current)
        li.nav-item
          a.nav-link(href='/manage-users') User Management
        li.nav-item.dropdown
          a#navbarDropdown.nav-link.dropdown-toggle(href='#', role='button', data-toggle='dropdown', aria-haspopup='true', aria-expanded='false')
            | Jenkins
          .dropdown-menu(aria-labelledby='navbarDropdown')
            a.dropdown-item(href='#', ng-controller="svcintgn", ng-click="showJenkinsOutput()") Service Status
        li.nav-item
          a.nav-link(ng-click="showAbout()", href='#') About

block content
  .container
    .row
      .col-12.text-center
        br
        .alert.alert-warning Repository Overview
  .container-fluid
    .row(ng-init="getRepoDetails()")
      .col-4(ng-repeat="item in stashlist")
        .card
          .card-body.text-center
            h5.card-title {{item}}
            hr
            p.card-text Clone this repository,
            h6.card-subtitle.mb-2.text-muted 
              kbd git clone http://{{host}}/{{item}}.git
            br
            a.card-link(href="/repository-dashboard/{{item}}") Goto Repository Dashboard
          .card-footer.text-center.bg-dark
            .btn-group(role='group', aria-label='Repository Actions')
              button.btn.btn-success(ng-click="userRepoMgmnt(item)", type='button', data-toggle="modal", data-target="#manageusrperm") Manage UA
              button.btn.btn-danger(ng-click="deleteRepo(item)", type='button') Delete Repository
      .col-12.text-center(ng-if="stashlist.length == 0")
        .alert.alert-primary.font-weight-bold 
          br
          br
          img(src="https://png.icons8.com/dusk/64/000000/empty-box.png")
          br
          br
          | Create a repository to get started !
          br
          br
  .modal.fade#manageusrperm(tabindex='-1', role='dialog')
    .modal-dialog(role='document')
      .modal-content
        .modal-header
          h5.modal-title Manage User Access
        .modal-body
          .container-fluid
            .row
              .col-12
                p.text-justify.font-weight-light
                    | Grant & revoke access to this repository over http/https. To add/remove users, visit the User Management section. R stands
                    | for Read Only access and W stands for Write Only access. To provide Read & Write access, check both the options.
                hr
                .alert.alert-primary
                  h5.font-weight-light Permission Overview
                br
          .container-fluid
            form.text-center.row
              .form-group.col-12(ng-repeat='user in permstack.users.active')
                .row
                  .col-4
                    label.font-weight-bold(ng-model="updatedpermstack[$index][0]", for='username') {{ user.username }}
                    input(type="hidden", ng-init="usrs[$index] = user.username")
                  .col-4
                    .form-check.form-check-inline
                      input#inlineCheckbox1.form-check-input(ng-model="readP[$index]", type='checkbox', value='read')
                      label.form-check-label(for='inlineCheckbox1') Read (R)
                  .col-4
                    .form-check.form-check-inline
                      input#inlineCheckbox2.form-check-input(ng-model="writeP[$index]", type='checkbox', value='write')
                      label.form-check-label(for='inlineCheckbox2') Write (W)
              br
        .modal-footer
          button.btn.btn-warning(ng-click="submitUserRepoMgmnt(permstack.reponame)", type='button', data-dismiss="modal") Save
          button.btn.btn-secondary(type='button', data-dismiss="modal") Close

