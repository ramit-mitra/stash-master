{"version":3,"sources":["webpack:///./src/main/js/components/common/LocationIndex.tsx","webpack:///./src/main/js/components/icons-components/StatusIcon.tsx","webpack:///./src/main/js/components/shared/StatusHelper.tsx","webpack:///./src/main/js/components/icons-components/ListIcon.tsx","webpack:///./src/main/js/components/icons-components/EllipsisIcon.tsx","webpack:///./src/main/js/components/issue/components/IssueChangelogDiff.js","webpack:///./src/main/js/components/issue/popups/ChangelogPopup.js","webpack:///./src/main/js/components/issue/components/IssueChangelog.js","webpack:///./src/main/js/components/issue/components/IssueMessage.js","webpack:///./src/main/js/components/common/SelectListItem.js","webpack:///./src/main/js/components/common/SelectList.js","webpack:///./src/main/js/components/issue/popups/SimilarIssuesPopup.js","webpack:///./src/main/js/components/issue/components/SimilarIssuesFilter.js","webpack:///./src/main/js/components/issue/components/IssueTitleBar.js","webpack:///./src/main/js/components/issue/popups/SetAssigneePopup.js","webpack:///./src/main/js/components/issue/components/IssueAssign.js","webpack:///./src/main/js/components/issue/actions.js","webpack:///./src/main/js/components/issue/popups/CommentPopup.js","webpack:///./src/main/js/components/issue/components/IssueCommentAction.js","webpack:///./src/main/js/components/issue/popups/SetSeverityPopup.js","webpack:///./src/main/js/components/issue/components/IssueSeverity.js","webpack:///./src/main/js/components/issue/popups/SetIssueTagsPopup.tsx","webpack:///./src/main/js/components/issue/components/IssueTags.js","webpack:///./src/main/js/components/issue/popups/SetTransitionPopup.js","webpack:///./src/main/js/components/issue/components/IssueTransition.js","webpack:///./src/main/js/components/issue/popups/SetTypePopup.js","webpack:///./src/main/js/components/issue/components/IssueType.js","webpack:///./src/main/js/components/issue/components/IssueActionsBar.js","webpack:///./src/main/js/components/issue/popups/CommentDeletePopup.js","webpack:///./src/main/js/components/issue/components/IssueCommentLine.js","webpack:///./src/main/js/components/issue/IssueView.js","webpack:///./src/main/js/components/issue/Issue.js","webpack:///./src/main/js/components/common/LocationMessage.tsx","webpack:///./src/main/js/components/SourceViewer/styles.css","webpack:///./src/main/js/components/SourceViewer/styles.css?b9b0","webpack:///./src/main/js/components/common/LocationMessage.css","webpack:///./src/main/js/components/common/LocationMessage.css?478d","webpack:///./src/main/js/components/issue/Issue.css","webpack:///./src/main/js/components/issue/Issue.css?0fe5","webpack:///./src/main/js/components/common/LocationIndex.css","webpack:///./src/main/js/components/common/LocationIndex.css?ad8e","webpack:///./src/main/js/components/measure/Measure.tsx","webpack:///./src/main/js/components/measure/utils.ts","webpack:///./src/main/js/components/SourceViewer/components/MeasuresOverlayMeasure.tsx","webpack:///./src/main/js/components/SourceViewer/components/MeasuresOverlayCoveredFiles.tsx","webpack:///./src/main/js/api/tests.ts","webpack:///./src/main/js/components/icons-components/TestStatusIcon.tsx","webpack:///./src/main/js/components/SourceViewer/components/MeasuresOverlayTestCase.tsx","webpack:///./src/main/js/components/SourceViewer/components/MeasuresOverlayTestCases.tsx","webpack:///./src/main/js/components/SourceViewer/components/MeasuresOverlay.tsx","webpack:///./src/main/js/components/SourceViewer/SourceViewerHeader.tsx","webpack:///./src/main/js/components/SourceViewer/components/LineOptionsPopup.tsx","webpack:///./src/main/js/components/SourceViewer/components/LineNumber.tsx","webpack:///./src/main/js/components/SourceViewer/components/SCMPopup.tsx","webpack:///./src/main/js/components/SourceViewer/components/LineSCM.tsx","webpack:///./src/main/js/components/SourceViewer/components/CoveragePopup.tsx","webpack:///./src/main/js/components/SourceViewer/components/LineCoverage.tsx","webpack:///./src/main/js/components/SourceViewer/components/LineDuplications.tsx","webpack:///./src/main/js/components/SourceViewer/components/LineDuplicationBlock.tsx","webpack:///./src/main/js/components/SourceViewer/components/LineIssuesIndicator.tsx","webpack:///./src/main/js/components/SourceViewer/components/LineIssuesList.tsx","webpack:///./src/main/js/components/SourceViewer/helpers/highlight.ts","webpack:///./src/main/js/components/SourceViewer/components/LineCode.tsx","webpack:///./src/main/js/components/SourceViewer/components/Line.tsx","webpack:///./src/main/js/components/SourceViewer/helpers/issueLocations.tsx","webpack:///./src/main/js/components/SourceViewer/SourceViewerCode.tsx","webpack:///./src/main/js/components/SourceViewer/components/DuplicationPopup.tsx","webpack:///./src/main/js/components/SourceViewer/helpers/loadIssues.tsx","webpack:///./src/main/js/components/SourceViewer/helpers/indexing.ts","webpack:///./src/main/js/components/SourceViewer/SourceViewerBase.tsx","webpack:///./src/main/js/components/SourceViewer/helpers/getCoverageStatus.tsx","webpack:///./src/main/js/components/SourceViewer/SourceViewer.tsx"],"names":["LocationIndex","props","children","leading","onClick","selected","other","__rest","clickAttributes","role","tabIndex","react__WEBPACK_IMPORTED_MODULE_0__","__assign","className","classnames__WEBPACK_IMPORTED_MODULE_1__","is-leading","statusIcons","open","_a","size","index_js_exposed","icons_components_Icon","d","style","fill","theme","confirmed","reopened","resolved","closed","StatusIcon","status","toLowerCase","Icon","StatusHelper","resolution","Object","l10n","ListIcon","_b","_Icon__WEBPACK_IMPORTED_MODULE_1__","EllipsisIcon","IssueChangelogDiff","message","diff","key","index_js_exposed_default","a","createElement","oldValue","newValue","measures","_super","ChangelogPopup","_this","apply","this","arguments","state","changelogs","__extends","prototype","componentDidMount","mounted","loadChangelog","componentWillUnmount","issues","issue","then","setState","onFail","render","author","Dropdown","DateTimeFormatter","date","creationDate","map","item","idx","userName","Avatar","hash","avatar","name","diffs","PureComponent","IssueChangelog","toggleChangelog","togglePopup","handleClick","handleClose","IssueChangelog_extends","Toggler","onRequestClose","isOpen","overlay","popups_ChangelogPopup","Tooltip","mouseEnterDelay","buttons","DateFromNow","DropdownIcon","IssueMessage","context","workspace","openRule","rule","organization","IssueMessage_extends","aria-label","engine","contextTypes","prop_types_default","object","isRequired","SelectListItem","handleSelect","evt","preventDefault","onSelect","handleHover","onHover","SelectListItem_extends","renderLink","href","classnames_default","active","onMouseOver","onFocus","title","undefined","placement","SelectList","call","attachShortcuts","previousKeyScope","keymaster_default","getScope","previousFilter","filter","currentKeyScope","uniqueId_default","setScope","event","tagName","target","srcElement","isInput","includes","keyCode","selectNextElement","selectPreviousElement","detachShortcuts","deleteScope","items","indexOf","length","renderChild","child","type","common_SelectListItem","cloneElement","currentItem","SelectList_extends","componentWillReceiveProps","nextProps","hasChildren","Children","count","SimilarIssuesPopup","property","onFilter","SimilarIssuesPopup_extends","tags","tag","subProject","noPadding","common_SelectList","IssueTypeIcon","query","SeverityHelper","severity","assignee","assigneeAvatar","assigneeName","path","ruleName","TagsIcon","QualifierIcon","qualifier","projectName","subProjectName","componentQualifier","componentLongName","SimilarIssuesFilter","handleFilter","SimilarIssuesFilter_extends","popups_SimilarIssuesPopup","FilterIcon","IssueTitleBar","hasSimilarIssuesFilter","locationsCount","secondaryLocations","flows","reduce","sum","locations","locationsBadge","displayLocations","displayLocationsCount","issueUrl","urls","project","branches","branchLike","components_IssueMessage","externalRuleEngine","components_IssueChangelog","currentPopup","textRange","endLine","displayLocationsLink","es","to","LinkIcon","components_SimilarIssuesFilter","LIST_SIZE","SetAssigneePopup_SetAssigneePopup","SetAssigneePopup","searchMembers","organizations","projectOrganization","q","ps","handleSearchResult","searchUsers","users","data","currentUser","login","handleSearchChange","defaultUsersArray","organizationsEnabled","isLoggedIn","concat","SetAssigneePopup_extends","SearchBox","autoFocus","minLength","onChange","placeholder","value","map_default","user","marginLeft","prop_types","popups_SetAssigneePopup","react_redux_es","rootReducer","IssueAssign","toggleAssign","IssueAssign_extends","renderAssignee","canAssign","closeOnEscape","onAssign","actions_updateIssue","resultPromise","oldIssue","newIssue","optimisticUpdate","response","helpers_issues","components","rules","error","CommentPopup","handleCommentChange","textComment","handleCommentClick","trim","onComment","handleCancelClick","toggleComment","handleKeyboard","metaKey","ctrlKey","stopPropagation","comment","markdown","CommentPopup_extends","onKeyDown","rows","disabled","MarkdownTips","IssueCommentAction","addComment","text","issueKey","IssueCommentAction_extends","popups_CommentPopup","commentPlaceholder","SEVERITY","SetSeverityPopup","SetSeverityPopup_extends","SeverityIcon","IssueSeverity","toggleSetSeverity","setSeverity","setIssueProperty","IssueSeverity_extends","canSetSeverity","popups_SetSeverityPopup","SetIssueTagsPopup_LIST_SIZE","SetIssueTagsPopup","searchResult","onSearch","Math","min","selectedTags","setTags","onUnselect","without_default","SetIssueTagsPopup_extends","availableTags","difference_default","popups","BottomRight","TagsSelector","listSize","IssueTags","toggleSetTags","IssueTags_assign","join","IssueTags_extends","canSetTags","popups_SetIssueTagsPopup","TagsList","allowUpdate","SetTransitionPopup","SetTransitionPopup_extends","transitions","transition","IssueTransition","setTransition","toggleSetTransition","IssueTransition_extends","hasTransitions","popups_SetTransitionPopup","TYPES","SetTypePopup","SetTypePopup_extends","IssueType","toggleSetType","setType","IssueType_extends","popups_SetTypePopup","IssueActionsBar","popup","apiCall","IssueActionsBar_assign","handleTransition","IssueActionsBar_extends","actions","canComment","components_IssueType","components_IssueSeverity","components_IssueTransition","components_IssueAssign","effort","components_IssueCommentAction","components_IssueTags","CommentDeletePopup","onDelete","IssueCommentLine","openPopup","handleEdit","onEdit","toggleEditPopup","handleDelete","toggleDeletePopup","popupName","force","prevState","closePopups","IssueCommentLine_extends","authorName","authorAvatar","dangerouslySetInnerHTML","__html","htmlText","createdAt","updatable","IssueView","handleCheck","onCheck","isClickable","node","toUpperCase","parentNode","editComment","deleteComment","IssueView_extends","hasCheckbox","issueClass","issue-with-checkbox","data-issue","components_IssueActionsBar","comments","components_IssueCommentLine","icon-checkbox-checked","checked","Issue_Issue","Issue","onPopupToggle","handleAssignement","handleFail","rootActions","store","dispatch","Issue_extends","bindShortcuts","componentWillUpdate","unbindShortcuts","componentDidUpdate","prevProps","unbind","issue_IssueView","defaultProps","LocationMessage","module","exports","__webpack_require__","push","i","content","options","hmr","transform","insertInto","locals","Measure","decimals","metricKey","metricType","small","_ui_Level__WEBPACK_IMPORTED_MODULE_3__","level","formattedValue","_helpers_measures__WEBPACK_IMPORTED_MODULE_5__","tooltip","_utils__WEBPACK_IMPORTED_MODULE_1__","Number","rating","_ui_Rating__WEBPACK_IMPORTED_MODULE_2__","_controls_Tooltip__WEBPACK_IMPORTED_MODULE_4__","KNOWN_RATINGS","enhanceMeasure","measure","metrics","metric","leak","periods","period","find","index","getLeakValue","getRatingTooltip","finalMetricKey","_helpers_measures__WEBPACK_IMPORTED_MODULE_0__","substr","MeasuresOverlayMeasure","data-metric","MeasuresOverlayCoveredFiles","loading","fetchCoveredFiles","testId","testCase","id","request","r","files","throwGlobalError","coveredFiles","DeferredSpinner","coveredFile","react_router_es","longName","coveredLines","stacktrace","ok","failure","fillRule","skipped","TestStatusIcon","MeasuresOverlayTestCase","handleTestCaseClick","currentTarget","blur","MeasuresOverlayTestCase_extends","hasAdditionalData","durationInMs","MeasuresOverlayTestCases","fetchTests","parameters","testFileKey","componentKey","catch","testCases","tests","handleTestCasesSortClick","sort","dataset","sortAsc","selectedTestId","MeasuresOverlayTestCases_extends","_c","selectedTest","test","colSpan","classnames","active-link","data-sort","mainOrder","orderBy_default","sortTestCases","components_MeasuresOverlayTestCase","components_MeasuresOverlayCoveredFiles","MeasuresOverlay","showAllMeasures","fetchData","Promise","all","fetchMeasures","fetchIssues","facets","MeasuresOverlay_assign","api_metrics","metricKeys","helpers_measures","api_measures","sourceViewerFile","withMetrics","keyBy_default","api_issues","componentKeys","severitiesFacet","f","tagsFacet","typesFacet","values","handleAllMeasuresClick","renderMeasure","renderLines","lines","ncloc","comment_lines","comment_lines_density","cognitive_complexity","complexity","function_complexity","renderBigMeasure","renderIssues","violations","sqale_index","sortBy_default","constants","val","renderCoverage","coverage","CoverageRating","uncovered_lines","lines_to_cover","uncovered_conditions","conditions_to_cover","renderDuplications","duplications","duplicated_lines_density","DuplicationsRating","muted","duplicated_blocks","duplicated_lines","renderTests","test_success_density","test_failures","test_errors","skipped_tests","test_execution_time","renderDomain","domain","renderAllMeasures","domains","groupBy_default","domainKeys","keys","odd","_","even","MeasuresOverlay_extends","Modal","contentLabel","large","onClose","components_MeasuresOverlayTestCases","SourceViewerHeader","measuresOverlay","handleShowMeasuresClick","handleMeasuresOverlayClose","openInWorkspace","openComponent","SourceViewerHeader_extends","uuid","isUnitTest","rawSourcesLink","querystring_es3","SourceViewerHeader_assign","helpers_path","canMarkAsFavorite","FavoriteContainer","pathname","overlayPlacement","components_MeasuresOverlay","fileUuids","duplicationDensity","LineOptionsPopup","line","permalink","LineOptionsPopup_assign","RightTop","LineNumber","handleTogglePopup","closePopup","LineNumber_extends","popupOpen","lineNumber","data-line-number","SCMPopup","scmAuthor","scmDate","DateFormatter","scmRevision","LineSCM","LineSCM_extends","previousLine","hasPopup","cell","s","p","changed","isSCMChanged","data-author","CoveragePopup","CoveragePopup_assign","sourceFileKey","sourceFileLineNumber","handleTestClick","CoveragePopup_extends","testCasesByFile","testFiles","fileKey","testSet","file","fileName","conditions","coveredConditions","testFile","data-key","LineCoverage","LineCoverage_extends","coverageStatus","components_CoveragePopup","LineDuplications","LineDuplications_extends","source-line-duplicated","duplicated","LineDuplicationBlock","LineDuplicationBlock_extends","data-index","renderDuplicationPopup","LineIssuesIndicator","LineIssuesIndicator_extends","hasIssues","source-line-with-issues","mostImportantIssue","LineIssuesList","issuePopup","displayIssueLocationsCount","displayIssueLocationsLink","onIssueChange","onIssueClick","onIssuePopupToggle","selectedIssue","ISSUE_LOCATION_CLASS","splitByTokens","code","rootClassName","container","document","tokens","innerHTML","forEach","childNodes","nodeType","fullClassName","innerTokens","nodeValue","markers","part","str","from","acc","highlightIssueLocations","issueLocations","location","nextTokens","markerAdded","startLine","token","s1","e1","s2","e2","x","max","p1","p2","p3","highlight_assign","newClassName","uniq_default","slice","LineCode","handleSymbolClick","match","onSymbolClick","LineCode_extends","attachEvents","highlightedLocationMessage","activeMarkerNode","scroll","detachEvents","codeNode","symbols","querySelectorAll","addEventListener","renderMarker","onLocationSelect","ref","highlightedSymbols","onIssueSelect","secondaryIssueLocations","showIssues","symbol","symbolRegExp","RegExp","highlightSymbol","has-issues","renderedTokens","leadingMarker","displayLocationMarkers","marker","Line","isPopupOpen","linePopup","handleIssuesIndicatorClick","openIssues","onIssuesClose","onIssueUnselect","onIssuesOpen","Line_extends","displayCoverage","duplicationsCount","filtered","source-line-highlighted","highlighted","source-line-filtered","source-line-filtered-dark","source-line-last","last","components_LineNumber","onLinePopupToggle","components_LineSCM","components_LineCoverage","displayDuplications","components_LineDuplications","loadDuplications","times_default","components_LineDuplicationBlock","displayIssues","displayAllIssues","components_LineIssuesIndicator","components_LineCode","getLinearLocations","startOffset","endOffset","EMPTY_ARRAY","ZERO_LINE","SourceViewerCode","getDuplicationsForLine","duplicationsByLine","getIssuesForLine","issuesByLine","getIssueLocationsForLine","issueLocationsByLine","getSecondaryIssueLocationsForLine","highlightedLocations","linearLocations","l","SourceViewerCode_assign","renderLine","filterLine","sources","issuesForLine","symbolsForLine","symbolsByLine","optimizedHighlightedSymbols","intersection_default","optimizedSelectedIssue","optimizedSecondaryIssueLocations","optimizedLocationMessage","some","components_Line","highlightedLine","hasSourcesAfter","openIssuesByLine","SourceViewerCode_extends","hasFileIssues","hasSourcesBefore","loadingSourcesBefore","loadSourcesBefore","loadingSourcesAfter","loadSourcesAfter","DuplicationPopup","isDifferentComponent","b","Boolean","handleFileClick","DuplicationPopup_extends","duplicatedFiles","groupedBlocks","blocks","fileRef","inRemovedComponent","duplication","block","data-line","PAGE_SIZE","loadPageAndNext","toLine","page","pageSize","loadIssues_assign","loadPage","lastIssue","nextIssues","loadIssues_loadIssues","component","_fromLine","additionalFields","buildQuery","resolve","locationsByLine","flatten_default","LINES","SourceViewerBase","loadSources","reject","aroundLine","safeLoadSources","firstSourceLine","safeLoadIssues","uniqBy_default","computeCoverageStatus","SourceViewerBase_assign","lastSourceLine","fromLine","changes","duplicationIndex","_ref","handleLinePopupToggle","samePopup","closeLinePopup","handleIssuePopupToggle","handleIssueSelect","handleIssueUnselect","handleOpenIssues","handleCloseIssues","handleIssueChange","newIssues","candidate","handleFilterLine","leakPeriodDate","dates","foundOne","outOfBounds","shouldDisplay","isOk","components_DuplicationPopup","notAccessible","notExist","sourceRemoved","SourceViewerBase_extends","fetchComponent","isLineOutsideOfRange","fetchSources","selectedIssue_1","reloadIssues","defineProperty","loadComponent","defaultLoadComponent","loadIssues","defaultLoadSources","lineHits","firstLine","lastList","safeLoadComponent","onReceiveComponent","finalSources_1","onLoaded","onFailLoadSources","finalSources_2","renderCode","SourceViewer_SourceViewerCode","source-duplications-expanded","SourceViewer_SourceViewerHeader","mapDispatchToProps","favorites","notFavorites","fav","duck","__webpack_exports__","SourceViewer_SourceViewerBase"],"mappings":"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","file":"js/4.eee34cef.chunk.js","sourcesContent":["/*\n * SonarQube\n * Copyright (C) 2009-2018 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport * as classNames from 'classnames';\nimport './LocationIndex.css';\n\ninterface Props {\n  children?: React.ReactNode;\n  leading?: boolean;\n  onClick?: () => void;\n  selected?: boolean;\n  [x: string]: any;\n}\n\nexport default function LocationIndex(props: Props) {\n  const { children, leading, onClick, selected, ...other } = props;\n  const clickAttributes = onClick ? { onClick, role: 'button', tabIndex: 0 } : {};\n  // put {...others} because Tooltip sets some event handlers\n  return (\n    <div\n      className={classNames('location-index', {\n        'is-leading': leading,\n        selected\n      })}\n      {...clickAttributes}\n      {...other}>\n      {children}\n    </div>\n  );\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2018 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport Icon, { IconProps } from './Icon';\nimport * as theme from '../../app/theme';\n\ninterface Props {\n  className?: string;\n  status: string;\n}\n\nconst statusIcons: { [x: string]: (props: IconProps) => React.ReactElement<any> } = {\n  open: OpenStatusIcon,\n  confirmed: ConfirmedStatusIcon,\n  reopened: ReopenedStatusIcon,\n  resolved: ResolvedStatusIcon,\n  closed: ClosedStatusIcon\n};\n\nexport default function StatusIcon(props: Props) {\n  const status = props.status.toLowerCase();\n  const Icon = statusIcons[status];\n  return Icon ? <Icon className={props.className} /> : null;\n}\n\nfunction OpenStatusIcon({ className, size }: IconProps) {\n  return (\n    <Icon className={className} size={size}>\n      <path\n        d=\"M8 3.75c-.77 0-1.482.19-2.133.57A4.25 4.25 0 0 0 4.32 5.867c-.38.65-.57 1.362-.57 2.133 0 .77.19 1.482.57 2.133.38.65.896 1.167 1.547 1.547.65.38 1.362.57 2.133.57.77 0 1.482-.19 2.133-.57a4.242 4.242 0 0 0 1.547-1.547c.38-.65.57-1.362.57-2.133 0-.77-.19-1.482-.57-2.133a4.25 4.25 0 0 0-1.547-1.547A4.153 4.153 0 0 0 8 3.75zM14 8c0 1.09-.268 2.092-.805 3.012a5.96 5.96 0 0 1-2.183 2.183A5.863 5.863 0 0 1 8 14a5.863 5.863 0 0 1-3.012-.805 5.96 5.96 0 0 1-2.183-2.183A5.863 5.863 0 0 1 2 8c0-1.09.268-2.092.805-3.012a5.96 5.96 0 0 1 2.183-2.183A5.863 5.863 0 0 1 8 2c1.09 0 2.092.268 3.012.805a5.96 5.96 0 0 1 2.183 2.183C13.732 5.908 14 6.91 14 8z\"\n        style={{ fill: theme.blue }}\n      />\n    </Icon>\n  );\n}\n\nfunction ConfirmedStatusIcon({ className, size }: IconProps) {\n  return (\n    <Icon className={className} size={size}>\n      <path\n        d=\"M10 8c0 .552-.195 1.023-.586 1.414-.39.39-.862.586-1.414.586a1.926 1.926 0 0 1-1.414-.586A1.928 1.928 0 0 1 6 8c0-.552.195-1.023.586-1.414C6.976 6.196 7.448 6 8 6c.552 0 1.023.195 1.414.586.39.39.586.862.586 1.414zM8 3.75c-.77 0-1.482.19-2.133.57A4.25 4.25 0 0 0 4.32 5.867c-.38.65-.57 1.362-.57 2.133 0 .77.19 1.482.57 2.133.38.65.896 1.167 1.547 1.547.65.38 1.362.57 2.133.57.77 0 1.482-.19 2.133-.57a4.242 4.242 0 0 0 1.547-1.547c.38-.65.57-1.362.57-2.133 0-.77-.19-1.482-.57-2.133a4.25 4.25 0 0 0-1.547-1.547A4.153 4.153 0 0 0 8 3.75zM14 8c0 1.09-.268 2.092-.805 3.012a5.96 5.96 0 0 1-2.183 2.183A5.863 5.863 0 0 1 8 14a5.863 5.863 0 0 1-3.012-.805 5.96 5.96 0 0 1-2.183-2.183A5.863 5.863 0 0 1 2 8c0-1.09.268-2.092.805-3.012a5.96 5.96 0 0 1 2.183-2.183A5.863 5.863 0 0 1 8 2c1.09 0 2.092.268 3.012.805a5.96 5.96 0 0 1 2.183 2.183C13.732 5.908 14 6.91 14 8z\"\n        style={{ fill: theme.blue }}\n      />\n    </Icon>\n  );\n}\n\nfunction ReopenedStatusIcon({ className, size }: IconProps) {\n  return (\n    <Icon className={className} size={size}>\n      <path\n        d=\"M8 12.25v-8.5c-.77 0-1.482.19-2.133.57A4.25 4.25 0 0 0 4.32 5.867c-.38.65-.57 1.362-.57 2.133 0 .77.19 1.482.57 2.133.38.65.896 1.167 1.547 1.547.65.38 1.362.57 2.133.57zM14 8c0 1.09-.268 2.092-.805 3.012a5.96 5.96 0 0 1-2.183 2.183A5.863 5.863 0 0 1 8 14a5.863 5.863 0 0 1-3.012-.805 5.96 5.96 0 0 1-2.183-2.183A5.863 5.863 0 0 1 2 8c0-1.09.268-2.092.805-3.012a5.96 5.96 0 0 1 2.183-2.183A5.863 5.863 0 0 1 8 2c1.09 0 2.092.268 3.012.805a5.96 5.96 0 0 1 2.183 2.183C13.732 5.908 14 6.91 14 8z\"\n        style={{ fill: theme.blue }}\n      />\n    </Icon>\n  );\n}\n\nfunction ResolvedStatusIcon({ className, size }: IconProps) {\n  return (\n    <Icon className={className} size={size}>\n      <path\n        d=\"M12.03 6.734a.49.49 0 0 0-.14-.36l-.71-.702a.48.48 0 0 0-.352-.15.474.474 0 0 0-.35.15l-3.19 3.18-1.765-1.766a.479.479 0 0 0-.35-.15.479.479 0 0 0-.353.15l-.71.703a.482.482 0 0 0-.14.358c0 .14.046.258.14.352l2.828 2.828c.098.1.216.15.35.15.142 0 .26-.05.36-.15l4.243-4.242a.475.475 0 0 0 .14-.352l-.001.001zM14 8c0 1.09-.268 2.092-.805 3.012a5.96 5.96 0 0 1-2.183 2.183A5.863 5.863 0 0 1 8 14a5.863 5.863 0 0 1-3.012-.805 5.96 5.96 0 0 1-2.183-2.183A5.863 5.863 0 0 1 2 8c0-1.09.268-2.092.805-3.012a5.96 5.96 0 0 1 2.183-2.183A5.863 5.863 0 0 1 8 2c1.09 0 2.092.268 3.012.805a5.96 5.96 0 0 1 2.183 2.183C13.732 5.908 14 6.91 14 8z\"\n        style={{ fill: theme.baseFontColor }}\n      />\n    </Icon>\n  );\n}\n\nfunction ClosedStatusIcon({ className, size }: IconProps) {\n  return (\n    <Icon className={className} size={size}>\n      <path\n        d=\"M14 8c0 1.09-.268 2.092-.805 3.012a5.96 5.96 0 0 1-2.183 2.183A5.863 5.863 0 0 1 8 14a5.863 5.863 0 0 1-3.012-.805 5.96 5.96 0 0 1-2.183-2.183A5.863 5.863 0 0 1 2 8c0-1.09.268-2.092.805-3.012a5.96 5.96 0 0 1 2.183-2.183A5.863 5.863 0 0 1 8 2c1.09 0 2.092.268 3.012.805a5.96 5.96 0 0 1 2.183 2.183C13.732 5.908 14 6.91 14 8z\"\n        style={{ fill: theme.baseFontColor }}\n      />\n    </Icon>\n  );\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2018 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport StatusIcon from '../icons-components/StatusIcon';\nimport { translate } from '../../helpers/l10n';\n\ninterface Props {\n  className?: string;\n  resolution: string | undefined;\n  status: string;\n}\n\nexport default function StatusHelper(props: Props) {\n  const resolution = props.resolution && ` (${translate('issue.resolution', props.resolution)})`;\n  return (\n    <span className={props.className}>\n      <StatusIcon className=\"little-spacer-right\" status={props.status} />\n      {translate('issue.status', props.status)}\n      {resolution}\n    </span>\n  );\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2018 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport Icon, { IconProps } from './Icon';\n\nexport default function ListIcon({ className, fill = 'currentColor', size }: IconProps) {\n  return (\n    <Icon className={className} size={size}>\n      <path\n        d=\"M15.045 11.526v1.007q0 0.204-0.149 0.354t-0.354 0.149h-13.084q-0.204 0-0.354-0.149t-0.149-0.354v-1.006q0-0.204 0.149-0.354t0.354-0.149h13.084q0.204 0 0.354 0.149t0.149 0.354zM15.045 8.506v1.006q0 0.204-0.149 0.354t-0.354 0.149h-13.084q-0.204 0-0.354-0.149t-0.149-0.354v-1.006q0-0.204 0.149-0.354t0.354-0.149h13.084q0.204 0 0.354 0.149t0.149 0.354zM15.045 5.487v1.006q0 0.204-0.149 0.354t-0.354 0.149h-13.084q-0.204 0-0.354-0.149t-0.149-0.354v-1.006q0-0.204 0.149-0.354t0.354-0.149h13.084q0.204 0 0.354 0.149t0.149 0.354zM15.045 2.468v1.006q0 0.204-0.149 0.354t-0.354 0.149h-13.084q-0.204 0-0.354-0.149t-0.149-0.354v-1.006q0-0.204 0.149-0.354t0.354-0.149h13.084q0.204 0 0.354 0.149t0.149 0.354z\"\n        style={{ fill }}\n      />\n    </Icon>\n  );\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2018 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport Icon, { IconProps } from './Icon';\n\nexport default function EllipsisIcon({ className, fill = 'currentColor', size }: IconProps) {\n  return (\n    <Icon className={className} size={size}>\n      <path\n        d=\"M5.273 7.182v1.636a.818.818 0 0 1-.818.818H2.818A.818.818 0 0 1 2 8.818V7.182c0-.452.366-.818.818-.818h1.637c.451 0 .818.366.818.818zm4.363 0v1.636a.818.818 0 0 1-.818.818H7.182a.818.818 0 0 1-.818-.818V7.182c0-.452.366-.818.818-.818h1.636c.452 0 .818.366.818.818zm4.364 0v1.636a.818.818 0 0 1-.818.818h-1.637a.818.818 0 0 1-.818-.818V7.182c0-.452.367-.818.818-.818h1.637c.452 0 .818.366.818.818z\"\n        style={{ fill }}\n      />\n    </Icon>\n  );\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2018 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\n// @flow\nimport React from 'react';\nimport { formatMeasure } from '../../../helpers/measures';\nimport { translate, translateWithParameters } from '../../../helpers/l10n';\n\n/*::\nexport type ChangelogDiff = {\n  key: string,\n  oldValue?: string,\n  newValue?: string\n};\n*/\n\nexport default function IssueChangelogDiff(props /*: { diff: ChangelogDiff } */) {\n  const { diff } = props;\n  if (diff.key === 'file') {\n    return (\n      <p>\n        {translateWithParameters(\n          'issue.change.file_move',\n          diff.oldValue || '',\n          diff.newValue || ''\n        )}\n      </p>\n    );\n  }\n  if (diff.key === 'from_long_branch') {\n    return (\n      <p>\n        {translateWithParameters(\n          'issue.change.from_long_branch',\n          diff.oldValue || '',\n          diff.newValue || ''\n        )}\n      </p>\n    );\n  }\n  if (diff.key === 'from_short_branch') {\n    return (\n      <p>\n        {translateWithParameters(\n          'issue.change.from_short_branch',\n          diff.oldValue || '',\n          diff.newValue || ''\n        )}\n      </p>\n    );\n  }\n\n  let message;\n  if (diff.newValue != null) {\n    let newValue /*: string */ = diff.newValue;\n    if (diff.key === 'effort') {\n      newValue = formatMeasure(diff.newValue, 'WORK_DUR');\n    }\n    message = translateWithParameters(\n      'issue.changelog.changed_to',\n      translate('issue.changelog.field', diff.key),\n      newValue\n    );\n  } else {\n    message = translateWithParameters(\n      'issue.changelog.removed',\n      translate('issue.changelog.field', diff.key)\n    );\n  }\n\n  if (diff.oldValue != null) {\n    let oldValue /*: string */ = diff.oldValue;\n    if (diff.key === 'effort') {\n      oldValue = formatMeasure(diff.oldValue, 'WORK_DUR');\n    }\n    message += ` (${translateWithParameters('issue.changelog.was', oldValue)})`;\n  }\n  return <p>{message}</p>;\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2018 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\n// @flow\nimport React from 'react';\nimport { getIssueChangelog } from '../../../api/issues';\nimport { translate } from '../../../helpers/l10n';\nimport Avatar from '../../../components/ui/Avatar';\nimport DateTimeFormatter from '../../../components/intl/DateTimeFormatter';\nimport IssueChangelogDiff from '../components/IssueChangelogDiff';\nimport { DropdownOverlay } from '../../controls/Dropdown';\n/*:: import type { ChangelogDiff } from '../components/IssueChangelogDiff'; */\n/*:: import type { Issue } from '../types'; */\n\n/*::\ntype Changelog = {\n  avatar?: string,\n  creationDate: string,\n  diffs: Array<ChangelogDiff>,\n  user: string,\n  userName: string\n};\n*/\n\n/*::\ntype Props = {\n  issue: Issue,\n  onFail: Error => void,\n  popupPosition?: {}\n};\n*/\n\n/*::\ntype State = {\n  changelogs: Array<Changelog>\n};\n*/\n\nexport default class ChangelogPopup extends React.PureComponent {\n  /*:: mounted: boolean; */\n  /*:: props: Props; */\n  state /*: State */ = {\n    changelogs: []\n  };\n\n  componentDidMount() {\n    this.mounted = true;\n    this.loadChangelog();\n  }\n\n  componentWillUnmount() {\n    this.mounted = false;\n  }\n\n  loadChangelog() {\n    getIssueChangelog(this.props.issue.key).then(changelogs => {\n      if (this.mounted) {\n        this.setState({ changelogs });\n      }\n    }, this.props.onFail);\n  }\n\n  render() {\n    const { issue } = this.props;\n    const { author } = issue;\n    return (\n      <DropdownOverlay>\n        <div className=\"menu is-container issue-changelog\">\n          <table className=\"spaced\">\n            <tbody>\n              <tr>\n                <td className=\"thin text-left text-top nowrap\">\n                  <DateTimeFormatter date={issue.creationDate} />\n                </td>\n                <td className=\"text-left text-top\">\n                  {author ? `${translate('created_by')} ${author}` : translate('created')}\n                </td>\n              </tr>\n\n              {this.state.changelogs.map((item, idx) => (\n                <tr key={idx}>\n                  <td className=\"thin text-left text-top nowrap\">\n                    <DateTimeFormatter date={item.creationDate} />\n                  </td>\n                  <td className=\"text-left text-top\">\n                    {item.userName && (\n                      <p>\n                        <Avatar\n                          className=\"little-spacer-right\"\n                          hash={item.avatar}\n                          name={item.userName}\n                          size={16}\n                        />\n                        {item.userName}\n                      </p>\n                    )}\n                    {item.diffs.map(diff => <IssueChangelogDiff diff={diff} key={diff.key} />)}\n                  </td>\n                </tr>\n              ))}\n            </tbody>\n          </table>\n        </div>\n      </DropdownOverlay>\n    );\n  }\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2018 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\n// @flow\nimport React from 'react';\nimport ChangelogPopup from '../popups/ChangelogPopup';\nimport DropdownIcon from '../../../components/icons-components/DropdownIcon';\nimport DateFromNow from '../../../components/intl/DateFromNow';\nimport DateTimeFormatter from '../../../components/intl/DateTimeFormatter';\nimport Toggler from '../../../components/controls/Toggler';\nimport Tooltip from '../../../components/controls/Tooltip';\nimport { Button } from '../../../components/ui/buttons';\n/*:: import type { Issue } from '../types'; */\n\n/*::\ntype Props = {\n  isOpen: boolean,\n  issue: Issue,\n  creationDate: string,\n  togglePopup: (string, boolean | void) => void,\n  onFail: Error => void\n};\n*/\n\nexport default class IssueChangelog extends React.PureComponent {\n  /*:: props: Props; */\n\n  toggleChangelog = (open /*: boolean | void */) => {\n    this.props.togglePopup('changelog', open);\n  };\n\n  handleClick = () => {\n    this.toggleChangelog();\n  };\n\n  handleClose = () => {\n    this.toggleChangelog(false);\n  };\n\n  render() {\n    return (\n      <div className=\"dropdown\">\n        <Toggler\n          onRequestClose={this.handleClose}\n          open={this.props.isOpen}\n          overlay={<ChangelogPopup issue={this.props.issue} onFail={this.props.onFail} />}>\n          <Tooltip\n            mouseEnterDelay={0.5}\n            overlay={<DateTimeFormatter date={this.props.creationDate} />}>\n            <Button\n              className=\"button-link issue-action issue-action-with-options js-issue-show-changelog\"\n              onClick={this.handleClick}>\n              <span className=\"issue-meta-label\">\n                <DateFromNow date={this.props.creationDate} />\n              </span>\n              <DropdownIcon className=\"little-spacer-left\" />\n            </Button>\n          </Tooltip>\n        </Toggler>\n      </div>\n    );\n  }\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2018 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\n// @flow\nimport React from 'react';\nimport PropTypes from 'prop-types';\nimport EllipsisIcon from '../../icons-components/EllipsisIcon';\nimport Tooltip from '../../controls/Tooltip';\nimport { translate, translateWithParameters } from '../../../helpers/l10n';\nimport { Button } from '../../ui/buttons';\n\nexport default class IssueMessage extends React.PureComponent {\n  /*:: props: {\n    engine?: string;\n    message: string,\n    organization: string,\n    rule: string\n  };\n  */\n\n  static contextTypes = {\n    workspace: PropTypes.object.isRequired\n  };\n\n  handleClick = () => {\n    this.context.workspace.openRule({\n      key: this.props.rule,\n      organization: this.props.organization\n    });\n  };\n\n  render() {\n    return (\n      <div className=\"issue-message\">\n        {this.props.message}\n        <Button\n          aria-label={translate('issue.rule_details')}\n          className=\"button-link issue-rule little-spacer-left\"\n          onClick={this.handleClick}>\n          <EllipsisIcon />\n        </Button>\n        {this.props.engine && (\n          <Tooltip\n            overlay={translateWithParameters('issue.from_external_rule_engine', this.props.engine)}>\n            <div className=\"outline-badge badge-tiny-height spacer-left vertical-text-top\">\n              {this.props.engine}\n            </div>\n          </Tooltip>\n        )}\n      </div>\n    );\n  }\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2018 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\n// @flow\nimport React from 'react';\nimport classNames from 'classnames';\nimport Tooltip from '../controls/Tooltip';\n\n/*::\ntype Props = {\n  active?: string,\n  children?: React.Element<*>,\n  item: string,\n  onSelect?: string => void,\n  onHover?: string => void,\n  title?: string\n};\n*/\n\nexport default class SelectListItem extends React.PureComponent {\n  /*:: props: Props; */\n\n  handleSelect = (evt /*: SyntheticInputEvent */) => {\n    evt.preventDefault();\n    if (this.props.onSelect) {\n      this.props.onSelect(this.props.item);\n    }\n  };\n\n  handleHover = () => {\n    if (this.props.onHover) {\n      this.props.onHover(this.props.item);\n    }\n  };\n\n  renderLink() {\n    let children = this.props.item;\n    if (this.props.children) {\n      children = this.props.children;\n    }\n    return (\n      <li>\n        <a\n          href=\"#\"\n          className={classNames({ active: this.props.active === this.props.item })}\n          onClick={this.handleSelect}\n          onMouseOver={this.handleHover}\n          onFocus={this.handleHover}>\n          {children}\n        </a>\n      </li>\n    );\n  }\n\n  render() {\n    return (\n      <Tooltip overlay={this.props.title || undefined} placement=\"right\">\n        {this.renderLink()}\n      </Tooltip>\n    );\n  }\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2018 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\n// @flow\nimport React from 'react';\nimport key from 'keymaster';\nimport { uniqueId } from 'lodash';\nimport classNames from 'classnames';\nimport SelectListItem from './SelectListItem';\n\n/*::\ntype Props = {\n  children?: SelectListItem,\n  className?: string,\n  items: Array<string>,\n  currentItem: string,\n  onSelect: string => void\n};\n*/\n\n/*::\ntype State = {\n  active: string\n};\n*/\n\nexport default class SelectList extends React.PureComponent {\n  /*:: currentKeyScope: string; */\n  /*:: previousFilter: Function; */\n  /*:: previousKeyScope: string; */\n  /*:: props: Props; */\n  /*:: state: State; */\n\n  constructor(props /*: Props */) {\n    super(props);\n    this.state = {\n      active: props.currentItem\n    };\n  }\n\n  componentDidMount() {\n    this.attachShortcuts();\n  }\n\n  componentWillReceiveProps(nextProps /*: Props */) {\n    if (\n      nextProps.currentItem !== this.props.currentItem &&\n      !nextProps.items.includes(this.state.active)\n    ) {\n      this.setState({ active: nextProps.currentItem });\n    }\n  }\n\n  componentWillUnmount() {\n    this.detachShortcuts();\n  }\n\n  attachShortcuts = () => {\n    this.previousKeyScope = key.getScope();\n    this.previousFilter = key.filter;\n    this.currentKeyScope = uniqueId('key-scope');\n    key.setScope(this.currentKeyScope);\n\n    // sometimes there is a *focused* search field next to the SelectList component\n    // we need to allow shortcuts in this case, but only for the used keys\n    key.filter = (event /*: KeyboardEvent & { target: HTMLElement } */) => {\n      const tagName = (event.target || event.srcElement).tagName;\n      const isInput = tagName === 'INPUT' || tagName === 'SELECT' || tagName === 'TEXTAREA';\n      return [13, 38, 40].includes(event.keyCode) || !isInput;\n    };\n\n    key('down', this.currentKeyScope, () => {\n      this.setState(this.selectNextElement);\n      return false;\n    });\n\n    key('up', this.currentKeyScope, () => {\n      this.setState(this.selectPreviousElement);\n      return false;\n    });\n\n    key('return', this.currentKeyScope, () => {\n      if (this.state.active != null) {\n        this.handleSelect(this.state.active);\n      }\n      return false;\n    });\n  };\n\n  detachShortcuts = () => {\n    key.setScope(this.previousKeyScope);\n    key.deleteScope(this.currentKeyScope);\n    key.filter = this.previousFilter;\n  };\n\n  handleSelect = (item /*: string */) => {\n    this.props.onSelect(item);\n  };\n\n  handleHover = (item /*: string */) => {\n    this.setState({ active: item });\n  };\n\n  selectNextElement = (state /*: State */, props /*: Props */) => {\n    const idx = props.items.indexOf(state.active);\n    if (idx < 0) {\n      return { active: props.items[0] };\n    }\n    return { active: props.items[(idx + 1) % props.items.length] };\n  };\n\n  selectPreviousElement = (state /*: State */, props /*: Props */) => {\n    const idx = props.items.indexOf(state.active);\n    if (idx <= 0) {\n      return { active: props.items[props.items.length - 1] };\n    }\n    return { active: props.items[idx - 1] };\n  };\n\n  renderChild = (child /*: Object */) => {\n    if (child == null) {\n      return null;\n    }\n    // do not pass extra props to children like `<li className=\"divider\" />`\n    if (child.type !== SelectListItem) {\n      return child;\n    }\n    return React.cloneElement(child, {\n      active: this.state.active,\n      onHover: this.handleHover,\n      onSelect: this.handleSelect\n    });\n  };\n\n  render() {\n    const { children } = this.props;\n    const hasChildren = React.Children.count(children) > 0;\n    return (\n      <ul className={classNames('menu', this.props.className)}>\n        {hasChildren && React.Children.map(children, this.renderChild)}\n        {!hasChildren &&\n          this.props.items.map(item => (\n            <SelectListItem\n              active={this.state.active}\n              item={item}\n              key={item}\n              onHover={this.handleHover}\n              onSelect={this.handleSelect}\n            />\n          ))}\n      </ul>\n    );\n  }\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2018 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\n// @flow\nimport React from 'react';\nimport SelectList from '../../../components/common/SelectList';\nimport SelectListItem from '../../../components/common/SelectListItem';\nimport { DropdownOverlay } from '../../../components/controls/Dropdown';\nimport SeverityHelper from '../../../components/shared/SeverityHelper';\nimport StatusHelper from '../../../components/shared/StatusHelper';\nimport QualifierIcon from '../../../components/icons-components/QualifierIcon';\nimport TagsIcon from '../../../components/icons-components/TagsIcon';\nimport IssueTypeIcon from '../../../components/ui/IssueTypeIcon';\nimport Avatar from '../../../components/ui/Avatar';\nimport { translate } from '../../../helpers/l10n';\nimport { fileFromPath, limitComponentName } from '../../../helpers/path';\n/*:: import type { Issue } from '../types'; */\n\n/*::\ntype Props = {|\n  issue: Issue,\n  onFilter: (property: string, issue: Issue) => void,\n|};\n*/\n\nexport default class SimilarIssuesPopup extends React.PureComponent {\n  /*:: props: Props; */\n\n  handleSelect = (property /*: string */) => {\n    this.props.onFilter(property, this.props.issue);\n  };\n\n  render() {\n    const { issue } = this.props;\n\n    const items = [\n      'type',\n      'severity',\n      'status',\n      'resolution',\n      'assignee',\n      'rule',\n      ...(issue.tags || []).map(tag => `tag###${tag}`),\n      'project',\n      // $FlowFixMe items are filtered later\n      issue.subProject ? 'module' : undefined,\n      'file'\n    ].filter(item => item);\n\n    return (\n      <DropdownOverlay noPadding={true}>\n        <header className=\"menu-search\">\n          <h6>{translate('issue.filter_similar_issues')}</h6>\n        </header>\n\n        <SelectList\n          className=\"issues-similar-issues-menu\"\n          currentItem={items[0]}\n          items={items}\n          onSelect={this.handleSelect}>\n          <SelectListItem item=\"type\">\n            <IssueTypeIcon className=\"little-spacer-right\" query={issue.type} />\n            {translate('issue.type', issue.type)}\n          </SelectListItem>\n\n          <SelectListItem item=\"severity\">\n            <SeverityHelper severity={issue.severity} />\n          </SelectListItem>\n\n          <SelectListItem item=\"status\">\n            <StatusHelper status={issue.status} />\n          </SelectListItem>\n\n          <SelectListItem item=\"resolution\">\n            {issue.resolution != null\n              ? translate('issue.resolution', issue.resolution)\n              : translate('unresolved')}\n          </SelectListItem>\n\n          <SelectListItem item=\"assignee\">\n            {issue.assignee != null ? (\n              <span>\n                {translate('assigned_to')}\n                <Avatar\n                  className=\"little-spacer-left little-spacer-right\"\n                  hash={issue.assigneeAvatar}\n                  name={issue.assigneeName || issue.assignee}\n                  size={16}\n                />\n                {issue.assigneeName || issue.assignee}\n              </span>\n            ) : (\n              translate('unassigned')\n            )}\n          </SelectListItem>\n\n          <li className=\"divider\" />\n\n          <SelectListItem item=\"rule\">{limitComponentName(issue.ruleName)}</SelectListItem>\n\n          {issue.tags != null &&\n            issue.tags.map(tag => (\n              <SelectListItem item={`tag###${tag}`} key={`tag###${tag}`}>\n                <TagsIcon className=\"icon-half-transparent little-spacer-right text-middle\" />\n                <span className=\"text-middle\">{tag}</span>\n              </SelectListItem>\n            ))}\n\n          <li className=\"divider\" />\n\n          <SelectListItem item=\"project\">\n            <QualifierIcon className=\"little-spacer-right\" qualifier=\"TRK\" />\n            {issue.projectName}\n          </SelectListItem>\n\n          {issue.subProject != null && (\n            <SelectListItem item=\"module\">\n              <QualifierIcon className=\"little-spacer-right\" qualifier=\"BRC\" />\n              {issue.subProjectName}\n            </SelectListItem>\n          )}\n\n          <SelectListItem item=\"file\">\n            <QualifierIcon className=\"little-spacer-right\" qualifier={issue.componentQualifier} />\n            {fileFromPath(issue.componentLongName)}\n          </SelectListItem>\n        </SelectList>\n      </DropdownOverlay>\n    );\n  }\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2018 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\n// @flow\nimport React from 'react';\nimport SimilarIssuesPopup from '../popups/SimilarIssuesPopup';\nimport Toggler from '../../../components/controls/Toggler';\nimport DropdownIcon from '../../../components/icons-components/DropdownIcon';\nimport FilterIcon from '../../../components/icons-components/FilterIcon';\nimport { Button } from '../../../components/ui/buttons';\nimport { translate } from '../../../helpers/l10n';\n/*:: import type { Issue } from '../types'; */\n\n/*::\ntype Props = {|\n  isOpen: boolean,\n  issue: Issue,\n  togglePopup: (string, boolean | void) => void,\n  onFail: Error => void,\n  onFilter: (property: string, issue: Issue) => void\n|};\n*/\n\nexport default class SimilarIssuesFilter extends React.PureComponent {\n  /*:: props: Props; */\n\n  handleClick = (evt /*: SyntheticInputEvent */) => {\n    evt.preventDefault();\n    this.togglePopup();\n  };\n\n  handleFilter = (property /*: string */, issue /*: Issue */) => {\n    this.togglePopup(false);\n    this.props.onFilter(property, issue);\n  };\n\n  togglePopup = (open /*: boolean | void */) => {\n    this.props.togglePopup('similarIssues', open);\n  };\n\n  handleClose = () => {\n    this.togglePopup(false);\n  };\n\n  render() {\n    return (\n      <div className=\"dropdown\">\n        <Toggler\n          onRequestClose={this.handleClose}\n          open={this.props.isOpen}\n          overlay={<SimilarIssuesPopup issue={this.props.issue} onFilter={this.handleFilter} />}>\n          <Button\n            aria-label={translate('issue.filter_similar_issues')}\n            className=\"js-issue-filter button-link issue-action issue-action-with-options\"\n            onClick={this.handleClick}\n            title={translate('issue.filter_similar_issues')}>\n            <FilterIcon className=\"icon-half-transparent\" />\n            <DropdownIcon className=\"icon-half-transparent\" />\n          </Button>\n        </Toggler>\n      </div>\n    );\n  }\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2018 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\n// @flow\nimport React from 'react';\nimport { Link } from 'react-router';\nimport IssueChangelog from './IssueChangelog';\nimport IssueMessage from './IssueMessage';\nimport SimilarIssuesFilter from './SimilarIssuesFilter';\nimport LinkIcon from '../../../components/icons-components/LinkIcon';\nimport LocationIndex from '../../common/LocationIndex';\nimport Tooltip from '../../controls/Tooltip';\nimport { getBranchLikeQuery } from '../../../helpers/branches';\nimport { getComponentIssuesUrl } from '../../../helpers/urls';\nimport { formatMeasure } from '../../../helpers/measures';\nimport { translate, translateWithParameters } from '../../../helpers/l10n';\n/*:: import type { Issue } from '../types'; */\n\n/*::\ntype Props = {|\n  branchLike?: { id?: string; name: string },\n  currentPopup: ?string,\n  displayLocationsCount?: boolean;\n  displayLocationsLink?: boolean;\n  issue: Issue,\n  onFail: Error => void,\n  onFilter?: (property: string, issue: Issue) => void,\n  togglePopup: (string, boolean | void) => void\n|};\n*/\n\nexport default function IssueTitleBar(props /*: Props */) {\n  const { issue } = props;\n  const hasSimilarIssuesFilter = props.onFilter != null;\n\n  const locationsCount =\n    issue.secondaryLocations.length +\n    issue.flows.reduce((sum, locations) => sum + locations.length, 0);\n\n  const locationsBadge = (\n    <Tooltip\n      overlay={translateWithParameters(\n        'issue.this_issue_involves_x_code_locations',\n        formatMeasure(locationsCount)\n      )}>\n      <LocationIndex>{locationsCount}</LocationIndex>\n    </Tooltip>\n  );\n\n  const displayLocations = props.displayLocationsCount && locationsCount > 0;\n\n  const issueUrl = getComponentIssuesUrl(issue.project, {\n    ...getBranchLikeQuery(props.branchLike),\n    issues: issue.key,\n    open: issue.key\n  });\n\n  return (\n    <div className=\"issue-row\">\n      <IssueMessage\n        engine={issue.externalRuleEngine}\n        message={issue.message}\n        organization={issue.organization}\n        rule={issue.rule}\n      />\n\n      <div className=\"issue-row-meta\">\n        <ul className=\"issue-meta-list\">\n          <li className=\"issue-meta\">\n            <IssueChangelog\n              creationDate={issue.creationDate}\n              isOpen={props.currentPopup === 'changelog'}\n              issue={issue}\n              onFail={props.onFail}\n              togglePopup={props.togglePopup}\n            />\n          </li>\n          {issue.textRange != null && (\n            <li className=\"issue-meta\">\n              <span className=\"issue-meta-label\" title={translate('line_number')}>\n                L{issue.textRange.endLine}\n              </span>\n            </li>\n          )}\n          {displayLocations && (\n            <li className=\"issue-meta\">\n              {props.displayLocationsLink ? (\n                <Link target=\"_blank\" to={issueUrl}>\n                  {locationsBadge}\n                </Link>\n              ) : (\n                locationsBadge\n              )}\n            </li>\n          )}\n          <li className=\"issue-meta\">\n            <Link\n              className=\"js-issue-permalink link-no-underline\"\n              target=\"_blank\"\n              title={translate('permalink')}\n              to={issueUrl}>\n              <LinkIcon />\n            </Link>\n          </li>\n          {hasSimilarIssuesFilter && (\n            <li className=\"issue-meta\">\n              <SimilarIssuesFilter\n                isOpen={props.currentPopup === 'similarIssues'}\n                issue={issue}\n                onFail={props.onFail}\n                onFilter={props.onFilter}\n                togglePopup={props.togglePopup}\n              />\n            </li>\n          )}\n        </ul>\n      </div>\n    </div>\n  );\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2018 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\n// @flow\nimport React from 'react';\nimport { map } from 'lodash';\nimport { connect } from 'react-redux';\nimport * as PropTypes from 'prop-types';\nimport Avatar from '../../../components/ui/Avatar';\nimport SelectList from '../../../components/common/SelectList';\nimport SelectListItem from '../../../components/common/SelectListItem';\nimport SearchBox from '../../../components/controls/SearchBox';\nimport { searchMembers } from '../../../api/organizations';\nimport { searchUsers } from '../../../api/users';\nimport { translate } from '../../../helpers/l10n';\nimport { getCurrentUser } from '../../../store/rootReducer';\nimport { DropdownOverlay } from '../../controls/Dropdown';\n/*:: import type { Issue } from '../types'; */\n\n/*::\ntype User = {\n  avatar?: string,\n  email?: string,\n  login: string,\n  name: string\n};\n*/\n\n/*::\ntype Props = {\n  currentUser: User,\n  issue: Issue,\n  onFail: Error => void,\n  onSelect: string => void,\n  popupPosition?: {}\n};\n*/\n\n/*::\ntype State = {\n  query: string,\n  users: Array<User>,\n  currentUser: string\n};\n*/\n\nconst LIST_SIZE = 10;\n\nclass SetAssigneePopup extends React.PureComponent {\n  /*:: defaultUsersArray: Array<User>; */\n  /*:: props: Props; */\n  /*:: state: State; */\n\n  static contextTypes = {\n    organizationsEnabled: PropTypes.bool\n  };\n\n  constructor(props /*: Props */) {\n    super(props);\n    this.defaultUsersArray = [{ login: '', name: translate('unassigned') }];\n\n    if (props.currentUser.isLoggedIn) {\n      this.defaultUsersArray = [props.currentUser, ...this.defaultUsersArray];\n    }\n\n    this.state = {\n      query: '',\n      users: this.defaultUsersArray,\n      currentUser: this.defaultUsersArray.length > 0 ? this.defaultUsersArray[0].login : ''\n    };\n  }\n\n  searchMembers = (query /*: string */) => {\n    searchMembers({\n      organization: this.props.issue.projectOrganization,\n      q: query,\n      ps: LIST_SIZE\n    }).then(this.handleSearchResult, this.props.onFail);\n  };\n\n  searchUsers = (query /*: string */) =>\n    searchUsers({ q: query, ps: LIST_SIZE }).then(this.handleSearchResult, this.props.onFail);\n\n  handleSearchResult = (data /*: Object */) => {\n    this.setState({\n      users: data.users,\n      currentUser: data.users.length > 0 ? data.users[0].login : ''\n    });\n  };\n\n  handleSearchChange = (query /*: string */) => {\n    if (query.length === 0) {\n      this.setState({\n        query,\n        users: this.defaultUsersArray,\n        currentUser: this.defaultUsersArray[0].login\n      });\n    } else {\n      this.setState({ query });\n      if (this.context.organizationsEnabled) {\n        this.searchMembers(query);\n      } else {\n        this.searchUsers(query);\n      }\n    }\n  };\n\n  render() {\n    return (\n      <DropdownOverlay noPadding={true}>\n        <div className=\"multi-select\">\n          <div className=\"menu-search\">\n            <SearchBox\n              autoFocus={true}\n              className=\"little-spacer-top\"\n              minLength={2}\n              onChange={this.handleSearchChange}\n              placeholder={translate('search.search_for_users')}\n              value={this.state.query}\n            />\n          </div>\n          <SelectList\n            currentItem={this.state.currentUser}\n            items={map(this.state.users, 'login')}\n            onSelect={this.props.onSelect}>\n            {this.state.users.map(user => (\n              <SelectListItem item={user.login} key={user.login}>\n                {!!user.login && (\n                  <Avatar className=\"spacer-right\" hash={user.avatar} name={user.name} size={16} />\n                )}\n                <span\n                  className=\"vertical-middle\"\n                  style={{ marginLeft: !user.login ? 24 : undefined }}>\n                  {user.name}\n                </span>\n              </SelectListItem>\n            ))}\n          </SelectList>\n        </div>\n      </DropdownOverlay>\n    );\n  }\n}\n\nconst mapStateToProps = state => ({\n  currentUser: getCurrentUser(state)\n});\n\nexport default connect(mapStateToProps)(SetAssigneePopup);\n","/*\n * SonarQube\n * Copyright (C) 2009-2018 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\n// @flow\nimport React from 'react';\nimport SetAssigneePopup from '../popups/SetAssigneePopup';\nimport Avatar from '../../../components/ui/Avatar';\nimport Toggler from '../../../components/controls/Toggler';\nimport DropdownIcon from '../../../components/icons-components/DropdownIcon';\nimport { Button } from '../../../components/ui/buttons';\nimport { translate } from '../../../helpers/l10n';\n/*:: import type { Issue } from '../types'; */\n\n/*::\ntype Props = {\n  isOpen: boolean,\n  issue: Issue,\n  canAssign: boolean,\n  onAssign: string => void,\n  onFail: Error => void,\n  togglePopup: (string, boolean | void) => void\n};\n*/\n\nexport default class IssueAssign extends React.PureComponent {\n  /*:: props: Props; */\n\n  toggleAssign = (open /*: boolean | void */) => {\n    this.props.togglePopup('assign', open);\n  };\n\n  handleClose = () => {\n    this.toggleAssign(false);\n  };\n\n  renderAssignee() {\n    const { issue } = this.props;\n    return (\n      <span>\n        {issue.assignee && (\n          <span className=\"text-top\">\n            <Avatar\n              className=\"little-spacer-right\"\n              hash={issue.assigneeAvatar}\n              name={issue.assigneeName || issue.assignee}\n              size={16}\n            />\n          </span>\n        )}\n        <span className=\"issue-meta-label\">\n          {issue.assignee ? issue.assigneeName || issue.assignee : translate('unassigned')}\n        </span>\n      </span>\n    );\n  }\n\n  render() {\n    if (this.props.canAssign) {\n      return (\n        <div className=\"dropdown\">\n          <Toggler\n            closeOnEscape={true}\n            onRequestClose={this.handleClose}\n            open={this.props.isOpen && this.props.canAssign}\n            overlay={\n              <SetAssigneePopup\n                issue={this.props.issue}\n                onFail={this.props.onFail}\n                onSelect={this.props.onAssign}\n              />\n            }>\n            <Button\n              className=\"button-link issue-action issue-action-with-options js-issue-assign\"\n              onClick={this.toggleAssign}>\n              {this.renderAssignee()}\n              <DropdownIcon className=\"little-spacer-left\" />\n            </Button>\n          </Toggler>\n        </div>\n      );\n    } else {\n      return this.renderAssignee();\n    }\n  }\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2018 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\n// @flow\nimport { parseIssueFromResponse } from '../../helpers/issues';\n/*:: import type { Issue } from './types'; */\n\nexport const updateIssue = (\n  onChange /*: Issue => void */,\n  onFail /*: Error => void */,\n  resultPromise /*: Promise<*> */,\n  oldIssue /*: ?Issue */,\n  newIssue /*: ?Issue */\n) => {\n  const optimisticUpdate = oldIssue != null && newIssue != null;\n  if (optimisticUpdate) {\n    // $FlowFixMe `newIssue` is not null, because `optimisticUpdate` is true\n    onChange(newIssue);\n  }\n\n  resultPromise.then(\n    response => {\n      if (!optimisticUpdate) {\n        const issue = parseIssueFromResponse(\n          response.issue,\n          response.components,\n          response.users,\n          response.rules\n        );\n        onChange(issue);\n      }\n    },\n    error => {\n      onFail(error);\n      if (optimisticUpdate) {\n        // $FlowFixMe `oldIssue` is not null, because `optimisticUpdate` is true\n        onChange(oldIssue);\n      }\n    }\n  );\n};\n","/*\n * SonarQube\n * Copyright (C) 2009-2018 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\n// @flow\nimport React from 'react';\nimport MarkdownTips from '../../../components/common/MarkdownTips';\nimport { Button, ResetButtonLink } from '../../../components/ui/buttons';\nimport { translate } from '../../../helpers/l10n';\nimport { DropdownOverlay } from '../../controls/Dropdown';\n/*:: import type { IssueComment } from '../types'; */\n\n/*::\ntype Props = {\n  comment?: IssueComment,\n  onComment: string => void,\n  toggleComment: boolean => void,\n  placeholder: string,\n  popupPosition?: {}\n};\n*/\n\n/*::\ntype State = {\n  textComment: string\n};\n*/\n\nexport default class CommentPopup extends React.PureComponent {\n  /*:: props: Props; */\n  /*:: state: State; */\n\n  constructor(props /*: Props */) {\n    super(props);\n    this.state = {\n      textComment: props.comment ? props.comment.markdown : ''\n    };\n  }\n\n  handleCommentChange = (evt /*: SyntheticInputEvent */) => {\n    this.setState({ textComment: evt.target.value });\n  };\n\n  handleCommentClick = () => {\n    if (this.state.textComment.trim().length > 0) {\n      this.props.onComment(this.state.textComment);\n    }\n  };\n\n  handleCancelClick = () => {\n    this.props.toggleComment(false);\n  };\n\n  handleKeyboard = (evt /*: KeyboardEvent */) => {\n    if (evt.keyCode === 13 && (evt.metaKey || evt.ctrlKey)) {\n      // Ctrl + Enter\n      this.handleCommentClick();\n    } else if ([37, 38, 39, 40].includes(evt.keyCode)) {\n      // Arrow keys\n      evt.stopPropagation();\n    }\n  };\n\n  render() {\n    const { comment } = this.props;\n    return (\n      <DropdownOverlay>\n        <div className=\"issue-comment-bubble-popup\">\n          <div className=\"issue-comment-form-text\">\n            <textarea\n              autoFocus={true}\n              onChange={this.handleCommentChange}\n              onKeyDown={this.handleKeyboard}\n              placeholder={this.props.placeholder}\n              rows=\"2\"\n              value={this.state.textComment}\n            />\n          </div>\n          <div className=\"issue-comment-form-footer\">\n            <div className=\"issue-comment-form-actions\">\n              <Button\n                className=\"js-issue-comment-submit little-spacer-right\"\n                disabled={this.state.textComment.trim().length < 1}\n                onClick={this.handleCommentClick}>\n                {comment && translate('save')}\n                {!comment && translate('issue.comment.submit')}\n              </Button>\n              <ResetButtonLink className=\"js-issue-comment-cancel\" onClick={this.handleCancelClick}>\n                {translate('cancel')}\n              </ResetButtonLink>\n            </div>\n            <div className=\"issue-comment-form-tips\">\n              <MarkdownTips />\n            </div>\n          </div>\n        </div>\n      </DropdownOverlay>\n    );\n  }\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2018 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\n// @flow\nimport React from 'react';\nimport { updateIssue } from '../actions';\nimport Toggler from '../../../components/controls/Toggler';\nimport { Button } from '../../../components/ui/buttons';\nimport CommentPopup from '../popups/CommentPopup';\nimport { addIssueComment } from '../../../api/issues';\nimport { translate } from '../../../helpers/l10n';\n/*:: import type { Issue } from '../types'; */\n\n/*::\ntype Props = {|\n  commentPlaceholder: string,\n  currentPopup: ?string,\n  issueKey: string,\n  onChange: Issue => void,\n  onFail: Error => void,\n  toggleComment: (open?: boolean, placeholder?: string) => void\n|};\n*/\n\nexport default class IssueCommentAction extends React.PureComponent {\n  /*:: props: Props; */\n\n  addComment = (text /*: string */) => {\n    updateIssue(\n      this.props.onChange,\n      this.props.onFail,\n      addIssueComment({ issue: this.props.issueKey, text })\n    );\n    this.props.toggleComment(false);\n  };\n\n  handleCommentClick = () => {\n    this.props.toggleComment();\n  };\n\n  handleClose = () => {\n    this.props.toggleComment(false);\n  };\n\n  render() {\n    return (\n      <li className=\"issue-meta dropdown\">\n        <Toggler\n          onRequestClose={this.handleClose}\n          open={this.props.currentPopup === 'comment'}\n          overlay={\n            <CommentPopup\n              onComment={this.addComment}\n              placeholder={this.props.commentPlaceholder}\n              toggleComment={this.props.toggleComment}\n            />\n          }>\n          <Button\n            className=\"button-link issue-action js-issue-comment\"\n            onClick={this.handleCommentClick}>\n            <span className=\"issue-meta-label\">{translate('issue.comment.formlink')}</span>\n          </Button>\n        </Toggler>\n      </li>\n    );\n  }\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2018 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\n// @flow\nimport React from 'react';\nimport { translate } from '../../../helpers/l10n';\nimport SelectList from '../../../components/common/SelectList';\nimport SelectListItem from '../../../components/common/SelectListItem';\nimport SeverityIcon from '../../../components/icons-components/SeverityIcon';\nimport { DropdownOverlay } from '../../controls/Dropdown';\n/*:: import type { Issue } from '../types'; */\n\n/*::\ntype Props = {\n  issue: Issue,\n  onSelect: string => void,\n};\n*/\n\nconst SEVERITY = ['BLOCKER', 'CRITICAL', 'MAJOR', 'MINOR', 'INFO'];\n\nexport default class SetSeverityPopup extends React.PureComponent {\n  /*:: props: Props; */\n\n  render() {\n    return (\n      <DropdownOverlay>\n        <SelectList\n          currentItem={this.props.issue.severity}\n          items={SEVERITY}\n          onSelect={this.props.onSelect}>\n          {SEVERITY.map(severity => (\n            <SelectListItem item={severity} key={severity}>\n              <SeverityIcon className=\"little-spacer-right\" severity={severity} />\n              {translate('severity', severity)}\n            </SelectListItem>\n          ))}\n        </SelectList>\n      </DropdownOverlay>\n    );\n  }\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2018 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\n// @flow\nimport React from 'react';\nimport SetSeverityPopup from '../popups/SetSeverityPopup';\nimport { setIssueSeverity } from '../../../api/issues';\nimport Toggler from '../../../components/controls/Toggler';\nimport DropdownIcon from '../../../components/icons-components/DropdownIcon';\nimport SeverityHelper from '../../../components/shared/SeverityHelper';\nimport { Button } from '../../../components/ui/buttons';\n/*:: import type { Issue } from '../types'; */\n\n/*::\ntype Props = {\n  canSetSeverity: boolean,\n  isOpen: boolean,\n  issue: Issue,\n  setIssueProperty: (string, string, apiCall: (Object) => Promise<*>, string) => void,\n  togglePopup: (string, boolean | void) => void\n};\n*/\n\nexport default class IssueSeverity extends React.PureComponent {\n  /*:: props: Props; */\n\n  toggleSetSeverity = (open /*: boolean | void */) => {\n    this.props.togglePopup('set-severity', open);\n  };\n\n  setSeverity = (severity /*: string */) => {\n    this.props.setIssueProperty('severity', 'set-severity', setIssueSeverity, severity);\n  };\n\n  handleClose = () => {\n    this.toggleSetSeverity(false);\n  };\n\n  render() {\n    const { issue } = this.props;\n    if (this.props.canSetSeverity) {\n      return (\n        <div className=\"dropdown\">\n          <Toggler\n            onRequestClose={this.handleClose}\n            open={this.props.isOpen && this.props.canSetSeverity}\n            overlay={<SetSeverityPopup issue={issue} onSelect={this.setSeverity} />}>\n            <Button\n              className=\"button-link issue-action issue-action-with-options js-issue-set-severity\"\n              onClick={this.toggleSetSeverity}>\n              <SeverityHelper className=\"issue-meta-label\" severity={issue.severity} />\n              <DropdownIcon className=\"little-spacer-left\" />\n            </Button>\n          </Toggler>\n        </div>\n      );\n    } else {\n      return <SeverityHelper className=\"issue-meta-label\" severity={issue.severity} />;\n    }\n  }\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2018 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport { difference, without } from 'lodash';\nimport TagsSelector from '../../../components/tags/TagsSelector';\nimport { searchIssueTags } from '../../../api/issues';\nimport { DropdownOverlay } from '../../controls/Dropdown';\nimport { PopupPlacement } from '../../ui/popups';\n\ninterface Props {\n  organization: string;\n  selectedTags: string[];\n  setTags: (tags: string[]) => void;\n}\n\ninterface State {\n  searchResult: string[];\n}\n\nconst LIST_SIZE = 10;\n\nexport default class SetIssueTagsPopup extends React.PureComponent<Props, State> {\n  mounted = false;\n  state: State = { searchResult: [] };\n\n  componentDidMount() {\n    this.mounted = true;\n  }\n\n  componentWillUnmount() {\n    this.mounted = false;\n  }\n\n  onSearch = (query: string) => {\n    return searchIssueTags({\n      q: query,\n      ps: Math.min(this.props.selectedTags.length - 1 + LIST_SIZE, 100),\n      organization: this.props.organization\n    }).then(\n      (tags: string[]) => {\n        if (this.mounted) {\n          this.setState({ searchResult: tags });\n        }\n      },\n      () => {}\n    );\n  };\n\n  onSelect = (tag: string) => {\n    this.props.setTags([...this.props.selectedTags, tag]);\n  };\n\n  onUnselect = (tag: string) => {\n    this.props.setTags(without(this.props.selectedTags, tag));\n  };\n\n  render() {\n    const availableTags = difference(this.state.searchResult, this.props.selectedTags);\n    return (\n      <DropdownOverlay placement={PopupPlacement.BottomRight}>\n        <TagsSelector\n          listSize={LIST_SIZE}\n          onSearch={this.onSearch}\n          onSelect={this.onSelect}\n          onUnselect={this.onUnselect}\n          selectedTags={this.props.selectedTags}\n          tags={availableTags}\n        />\n      </DropdownOverlay>\n    );\n  }\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2018 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\n// @flow\nimport React from 'react';\nimport { updateIssue } from '../actions';\nimport SetIssueTagsPopup from '../popups/SetIssueTagsPopup';\nimport { setIssueTags } from '../../../api/issues';\nimport Toggler from '../../../components/controls/Toggler';\nimport TagsList from '../../../components/tags/TagsList';\nimport { Button } from '../../../components/ui/buttons';\nimport { translate } from '../../../helpers/l10n';\n/*:: import type { Issue } from '../types'; */\n\n/*::\ntype Props = {|\n  canSetTags: boolean,\n  isOpen: boolean,\n  issue: Issue,\n  onChange: Issue => void,\n  onFail: Error => void,\n  togglePopup: (string, boolean | void) => void\n|};\n*/\n\nexport default class IssueTags extends React.PureComponent {\n  /*:: props: Props; */\n\n  toggleSetTags = (open /*: boolean | void */) => {\n    this.props.togglePopup('edit-tags', open);\n  };\n\n  setTags = (tags /*: Array<string> */) => {\n    const { issue } = this.props;\n    const newIssue = { ...issue, tags };\n    updateIssue(\n      this.props.onChange,\n      this.props.onFail,\n      setIssueTags({ issue: issue.key, tags: tags.join(',') }),\n      issue,\n      newIssue\n    );\n  };\n\n  handleClose = () => {\n    this.toggleSetTags(false);\n  };\n\n  render() {\n    const { issue } = this.props;\n    const { tags = [] } = issue;\n\n    if (this.props.canSetTags) {\n      return (\n        <div className=\"dropdown\">\n          <Toggler\n            onRequestClose={this.handleClose}\n            open={this.props.isOpen}\n            overlay={\n              <SetIssueTagsPopup\n                organization={issue.projectOrganization}\n                selectedTags={tags}\n                setTags={this.setTags}\n              />\n            }>\n            <Button\n              className={'js-issue-edit-tags button-link issue-action issue-action-with-options'}\n              onClick={this.toggleSetTags}>\n              <TagsList\n                allowUpdate={this.props.canSetTags}\n                tags={\n                  issue.tags && issue.tags.length > 0 ? issue.tags : [translate('issue.no_tag')]\n                }\n              />\n            </Button>\n          </Toggler>\n        </div>\n      );\n    } else {\n      return (\n        <TagsList\n          allowUpdate={this.props.canSetTags}\n          className=\"note\"\n          tags={issue.tags && issue.tags.length > 0 ? issue.tags : [translate('issue.no_tag')]}\n        />\n      );\n    }\n  }\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2018 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\n// @flow\nimport React from 'react';\nimport SelectList from '../../../components/common/SelectList';\nimport SelectListItem from '../../../components/common/SelectListItem';\nimport { translate } from '../../../helpers/l10n';\nimport { DropdownOverlay } from '../../controls/Dropdown';\n\n/*::\ntype Props = {\n  transitions: Array<string>,\n  onSelect: string => void,\n};\n*/\n\nexport default class SetTransitionPopup extends React.PureComponent {\n  /*:: props: Props; */\n\n  render() {\n    const { transitions } = this.props;\n    return (\n      <DropdownOverlay>\n        <SelectList currentItem={transitions[0]} items={transitions} onSelect={this.props.onSelect}>\n          {transitions.map(transition => {\n            return (\n              <SelectListItem\n                item={transition}\n                key={transition}\n                title={translate('issue.transition', transition, 'description')}>\n                {translate('issue.transition', transition)}\n              </SelectListItem>\n            );\n          })}\n        </SelectList>\n      </DropdownOverlay>\n    );\n  }\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2018 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\n// @flow\nimport React from 'react';\nimport { updateIssue } from '../actions';\nimport SetTransitionPopup from '../popups/SetTransitionPopup';\nimport { setIssueTransition } from '../../../api/issues';\nimport Toggler from '../../../components/controls/Toggler';\nimport DropdownIcon from '../../../components/icons-components/DropdownIcon';\nimport StatusHelper from '../../../components/shared/StatusHelper';\nimport { Button } from '../../../components/ui/buttons';\n/*:: import type { Issue } from '../types'; */\n\n/*::\ntype Props = {\n  hasTransitions: boolean,\n  isOpen: boolean,\n  issue: Issue,\n  onChange: Issue => void,\n  onFail: Error => void,\n  togglePopup: (string, boolean | void) => void\n};\n*/\n\nexport default class IssueTransition extends React.PureComponent {\n  /*:: props: Props; */\n\n  setTransition = (transition /*: string */) => {\n    updateIssue(\n      this.props.onChange,\n      this.props.onFail,\n      setIssueTransition({ issue: this.props.issue.key, transition })\n    );\n    this.toggleSetTransition();\n  };\n\n  toggleSetTransition = (open /*: boolean | void */) => {\n    this.props.togglePopup('transition', open);\n  };\n\n  handleClose = () => {\n    this.toggleSetTransition(false);\n  };\n\n  render() {\n    const { issue } = this.props;\n\n    if (this.props.hasTransitions) {\n      return (\n        <div className=\"dropdown\">\n          <Toggler\n            onRequestClose={this.handleClose}\n            open={this.props.isOpen && this.props.hasTransitions}\n            overlay={\n              <SetTransitionPopup onSelect={this.setTransition} transitions={issue.transitions} />\n            }>\n            <Button\n              className=\"button-link issue-action issue-action-with-options js-issue-transition\"\n              onClick={this.toggleSetTransition}>\n              <StatusHelper\n                className=\"issue-meta-label\"\n                resolution={issue.resolution}\n                status={issue.status}\n              />\n              <DropdownIcon className=\"little-spacer-left\" />\n            </Button>\n          </Toggler>\n        </div>\n      );\n    } else {\n      return (\n        <StatusHelper\n          className=\"issue-meta-label\"\n          resolution={issue.resolution}\n          status={issue.status}\n        />\n      );\n    }\n  }\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2018 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\n// @flow\nimport React from 'react';\nimport { translate } from '../../../helpers/l10n';\nimport IssueTypeIcon from '../../../components/ui/IssueTypeIcon';\nimport SelectList from '../../../components/common/SelectList';\nimport SelectListItem from '../../../components/common/SelectListItem';\nimport { DropdownOverlay } from '../../controls/Dropdown';\n/*:: import type { Issue } from '../types'; */\n\n/*::\ntype Props = {\n  issue: Issue,\n  onSelect: string => void,\n};\n*/\n\nconst TYPES = ['BUG', 'VULNERABILITY', 'CODE_SMELL'];\n\nexport default class SetTypePopup extends React.PureComponent {\n  /*:: props: Props; */\n\n  render() {\n    return (\n      <DropdownOverlay>\n        <SelectList\n          currentItem={this.props.issue.type}\n          items={TYPES}\n          onSelect={this.props.onSelect}>\n          {TYPES.map(type => (\n            <SelectListItem item={type} key={type}>\n              <IssueTypeIcon className=\"little-spacer-right\" query={type} />\n              {translate('issue.type', type)}\n            </SelectListItem>\n          ))}\n        </SelectList>\n      </DropdownOverlay>\n    );\n  }\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2018 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\n// @flow\nimport React from 'react';\nimport SetTypePopup from '../popups/SetTypePopup';\nimport { setIssueType } from '../../../api/issues';\nimport Toggler from '../../../components/controls/Toggler';\nimport DropdownIcon from '../../../components/icons-components/DropdownIcon';\nimport { Button } from '../../../components/ui/buttons';\nimport IssueTypeIcon from '../../../components/ui/IssueTypeIcon';\nimport { translate } from '../../../helpers/l10n';\n/*:: import type { Issue } from '../types'; */\n\n/*::\ntype Props = {\n  canSetSeverity: boolean,\n  isOpen: boolean,\n  issue: Issue,\n  setIssueProperty: (string, string, apiCall: (Object) => Promise<*>, string) => void,\n  togglePopup: (string, boolean | void) => void\n};\n*/\n\nexport default class IssueType extends React.PureComponent {\n  /*:: props: Props; */\n\n  toggleSetType = (open /*: boolean | void */) => {\n    this.props.togglePopup('set-type', open);\n  };\n\n  setType = (type /*: string */) => {\n    this.props.setIssueProperty('type', 'set-type', setIssueType, type);\n  };\n\n  handleClose = () => {\n    this.toggleSetType(false);\n  };\n\n  render() {\n    const { issue } = this.props;\n    if (this.props.canSetSeverity) {\n      return (\n        <div className=\"dropdown\">\n          <Toggler\n            onRequestClose={this.handleClose}\n            open={this.props.isOpen && this.props.canSetSeverity}\n            overlay={<SetTypePopup issue={issue} onSelect={this.setType} />}>\n            <Button\n              className=\"button-link issue-action issue-action-with-options js-issue-set-type\"\n              onClick={this.toggleSetType}>\n              <IssueTypeIcon className=\"little-spacer-right\" query={issue.type} />\n              {translate('issue.type', issue.type)}\n              <DropdownIcon className=\"little-spacer-left\" />\n            </Button>\n          </Toggler>\n        </div>\n      );\n    } else {\n      return (\n        <span>\n          <IssueTypeIcon className=\"little-spacer-right\" query={issue.type} />\n          {translate('issue.type', issue.type)}\n        </span>\n      );\n    }\n  }\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2018 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\n// @flow\nimport React from 'react';\nimport IssueAssign from './IssueAssign';\nimport IssueCommentAction from './IssueCommentAction';\nimport IssueSeverity from './IssueSeverity';\nimport IssueTags from './IssueTags';\nimport IssueTransition from './IssueTransition';\nimport IssueType from './IssueType';\nimport { updateIssue } from '../actions';\nimport { translate, translateWithParameters } from '../../../helpers/l10n';\n/*:: import type { Issue } from '../types'; */\n\n/*::\ntype Props = {\n  issue: Issue,\n  currentPopup: ?string,\n  onAssign: string => void,\n  onChange: Issue => void,\n  onFail: Error => void,\n  togglePopup: (string, boolean | void) => void\n};\n*/\n\n/*::\ntype State = {\n  commentPlaceholder: string\n};\n*/\n\nexport default class IssueActionsBar extends React.PureComponent {\n  /*:: props: Props; */\n  state /*: State */ = {\n    commentPlaceholder: ''\n  };\n\n  setIssueProperty = (\n    property /*: string */,\n    popup /*: string */,\n    apiCall /*: Object => Promise<*> */,\n    value /*: string */\n  ) => {\n    const { issue } = this.props;\n    if (issue[property] !== value) {\n      const newIssue = { ...issue, [property]: value };\n      updateIssue(\n        this.props.onChange,\n        this.props.onFail,\n        apiCall({ issue: issue.key, [property]: value }),\n        issue,\n        newIssue\n      );\n    }\n    this.props.togglePopup(popup, false);\n  };\n\n  toggleComment = (open /*: boolean | void */, placeholder /*: string | void */) => {\n    this.setState({ commentPlaceholder: placeholder || '' });\n    this.props.togglePopup('comment', open);\n  };\n\n  handleTransition = (issue /*: Issue */) => {\n    this.props.onChange(issue);\n    if (['FALSE-POSITIVE', 'WONTFIX'].includes(issue.resolution)) {\n      this.toggleComment(true, translate('issue.comment.tell_why'));\n    }\n  };\n\n  render() {\n    const { issue } = this.props;\n    const canAssign = issue.actions.includes('assign');\n    const canComment = issue.actions.includes('comment');\n    const canSetSeverity = issue.actions.includes('set_severity');\n    const canSetTags = issue.actions.includes('set_tags');\n    const hasTransitions = issue.transitions && issue.transitions.length > 0;\n\n    return (\n      <table className=\"issue-table\">\n        <tbody>\n          <tr>\n            <td>\n              <ul className=\"issue-meta-list\">\n                <li className=\"issue-meta\">\n                  <IssueType\n                    isOpen={this.props.currentPopup === 'set-type' && canSetSeverity}\n                    issue={issue}\n                    canSetSeverity={canSetSeverity}\n                    togglePopup={this.props.togglePopup}\n                    setIssueProperty={this.setIssueProperty}\n                  />\n                </li>\n                <li className=\"issue-meta\">\n                  <IssueSeverity\n                    isOpen={this.props.currentPopup === 'set-severity' && canSetSeverity}\n                    issue={issue}\n                    canSetSeverity={canSetSeverity}\n                    togglePopup={this.props.togglePopup}\n                    setIssueProperty={this.setIssueProperty}\n                  />\n                </li>\n                <li className=\"issue-meta\">\n                  <IssueTransition\n                    isOpen={this.props.currentPopup === 'transition' && hasTransitions}\n                    issue={issue}\n                    hasTransitions={hasTransitions}\n                    onChange={this.handleTransition}\n                    onFail={this.props.onFail}\n                    togglePopup={this.props.togglePopup}\n                  />\n                </li>\n                <li className=\"issue-meta\">\n                  <IssueAssign\n                    isOpen={this.props.currentPopup === 'assign' && canAssign}\n                    issue={issue}\n                    canAssign={canAssign}\n                    onAssign={this.props.onAssign}\n                    onFail={this.props.onFail}\n                    togglePopup={this.props.togglePopup}\n                  />\n                </li>\n                {issue.effort && (\n                  <li className=\"issue-meta\">\n                    <span className=\"issue-meta-label\">\n                      {translateWithParameters('issue.x_effort', issue.effort)}\n                    </span>\n                  </li>\n                )}\n                {canComment && (\n                  <IssueCommentAction\n                    commentPlaceholder={this.state.commentPlaceholder}\n                    currentPopup={this.props.currentPopup}\n                    issueKey={issue.key}\n                    onChange={this.props.onChange}\n                    onFail={this.props.onFail}\n                    toggleComment={this.toggleComment}\n                  />\n                )}\n              </ul>\n            </td>\n            <td className=\"issue-table-meta-cell\">\n              <ul className=\"list-inline\">\n                <li className=\"issue-meta js-issue-tags\">\n                  <IssueTags\n                    isOpen={this.props.currentPopup === 'edit-tags' && canSetTags}\n                    canSetTags={canSetTags}\n                    issue={issue}\n                    onChange={this.props.onChange}\n                    onFail={this.props.onFail}\n                    togglePopup={this.props.togglePopup}\n                  />\n                </li>\n              </ul>\n            </td>\n          </tr>\n        </tbody>\n      </table>\n    );\n  }\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2018 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\n// @flow\nimport React from 'react';\nimport { Button } from '../../../components/ui/buttons';\nimport { translate } from '../../../helpers/l10n';\nimport { DropdownOverlay } from '../../controls/Dropdown';\n\n/*::\ntype Props = {\n  onDelete: () => void,\n  popupPosition?: {}\n};\n*/\n\nexport default function CommentDeletePopup(props /*: Props */) {\n  return (\n    <DropdownOverlay>\n      <div className=\"menu is-container\">\n        <div className=\"spacer-bottom\">{translate('issue.comment.delete_confirm_message')}</div>\n        <Button className=\"button-red\" onClick={props.onDelete}>\n          {translate('delete')}\n        </Button>\n      </div>\n    </DropdownOverlay>\n  );\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2018 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\n// @flow\nimport React from 'react';\nimport Avatar from '../../../components/ui/Avatar';\nimport Toggler from '../../../components/controls/Toggler';\nimport EditIcon from '../../../components/icons-components/EditIcon';\nimport { EditButton, DeleteButton } from '../../../components/ui/buttons';\nimport CommentDeletePopup from '../popups/CommentDeletePopup';\nimport CommentPopup from '../popups/CommentPopup';\nimport DateFromNow from '../../../components/intl/DateFromNow';\n/*:: import type { IssueComment } from '../types'; */\n\n/*::\ntype Props = {\n  comment: IssueComment,\n  onDelete: string => void,\n  onEdit: (string, string) => void\n};\n*/\n\n/*::\ntype State = {\n  openPopup: string\n};\n*/\n\nexport default class IssueCommentLine extends React.PureComponent {\n  /*:: props: Props; */\n  state /*: State */ = {\n    openPopup: ''\n  };\n\n  handleEdit = (text /*: string */) => {\n    this.props.onEdit(this.props.comment.key, text);\n    this.toggleEditPopup(false);\n  };\n\n  handleDelete = () => {\n    this.props.onDelete(this.props.comment.key);\n    this.toggleDeletePopup(false);\n  };\n\n  togglePopup = (popupName /*: string */, force /*: ?boolean */) => {\n    this.setState((prevState /*: State */) => {\n      if (prevState.openPopup !== popupName && force !== false) {\n        return { openPopup: popupName };\n      } else if (prevState.openPopup === popupName && force !== true) {\n        return { openPopup: '' };\n      }\n      return prevState;\n    });\n  };\n\n  toggleDeletePopup = (force /*: ?boolean */) => {\n    this.togglePopup('delete', force);\n  };\n\n  toggleEditPopup = (force /*: ?boolean */) => {\n    this.togglePopup('edit', force);\n  };\n\n  closePopups = () => {\n    this.setState({ openPopup: '' });\n  };\n\n  render() {\n    const { comment } = this.props;\n    return (\n      <div className=\"issue-comment\">\n        <div className=\"issue-comment-author\" title={comment.authorName}>\n          <Avatar\n            className=\"little-spacer-right\"\n            hash={comment.authorAvatar}\n            name={comment.authorName || comment.author}\n            size={16}\n          />\n          {comment.authorName || comment.author}\n        </div>\n        <div\n          className=\"issue-comment-text markdown\"\n          dangerouslySetInnerHTML={{ __html: comment.htmlText }}\n        />\n        <div className=\"issue-comment-age\">\n          <DateFromNow date={comment.createdAt} />\n        </div>\n        <div className=\"issue-comment-actions\">\n          {comment.updatable && (\n            <div className=\"dropdown\">\n              <Toggler\n                className=\"display-inline-block\"\n                onRequestClose={this.closePopups}\n                open={this.state.openPopup === 'edit'}\n                overlay={\n                  <CommentPopup\n                    comment={comment}\n                    onComment={this.handleEdit}\n                    placeholder=\"\"\n                    toggleComment={this.toggleEditPopup}\n                  />\n                }>\n                <EditButton\n                  className=\"js-issue-comment-edit button-small\"\n                  onClick={this.toggleEditPopup}\n                />\n              </Toggler>\n            </div>\n          )}\n          {comment.updatable && (\n            <div className=\"dropdown\">\n              <Toggler\n                className=\"display-inline-block\"\n                onRequestClose={this.closePopups}\n                open={this.state.openPopup === 'delete'}\n                overlay={<CommentDeletePopup onDelete={this.handleDelete} />}>\n                <DeleteButton\n                  className=\"js-issue-comment-delete button-small\"\n                  onClick={this.toggleDeletePopup}\n                />\n              </Toggler>\n            </div>\n          )}\n        </div>\n      </div>\n    );\n  }\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2018 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\n// @flow\nimport React from 'react';\nimport classNames from 'classnames';\nimport IssueTitleBar from './components/IssueTitleBar';\nimport IssueActionsBar from './components/IssueActionsBar';\nimport IssueCommentLine from './components/IssueCommentLine';\nimport { updateIssue } from './actions';\nimport { deleteIssueComment, editIssueComment } from '../../api/issues';\n/*:: import type { Issue } from './types'; */\n\n/*::\ntype Props = {|\n  branchLike?: { id?: string; name: string },\n  checked?: boolean,\n  currentPopup: ?string,\n  displayLocationsCount?: boolean;\n  displayLocationsLink?: boolean;\n  issue: Issue,\n  onAssign: string => void,\n  onChange: Issue => void,\n  onCheck?: (issue: string, event: Event) => void,\n  onClick: string => void,\n  onFail: Error => void,\n  onFilter?: (property: string, issue: Issue) => void,\n  selected: boolean,\n  togglePopup: (string, boolean | void) => void\n|};\n*/\n\nexport default class IssueView extends React.PureComponent {\n  /*:: props: Props; */\n\n  handleCheck = (event /*: Event */) => {\n    event.preventDefault();\n    if (this.props.onCheck) {\n      this.props.onCheck(this.props.issue.key, event);\n    }\n  };\n\n  handleClick = (event /*: Event & { target: HTMLElement } */) => {\n    if (!isClickable(event.target) && this.props.onClick) {\n      event.preventDefault();\n      this.props.onClick(this.props.issue.key);\n    }\n  };\n\n  editComment = (comment /*: string */, text /*: string */) => {\n    updateIssue(this.props.onChange, this.props.onFail, editIssueComment({ comment, text }));\n  };\n\n  deleteComment = (comment /*: string */) => {\n    updateIssue(this.props.onChange, this.props.onFail, deleteIssueComment({ comment }));\n  };\n\n  render() {\n    const { issue } = this.props;\n\n    const hasCheckbox = this.props.onCheck != null;\n\n    const issueClass = classNames('issue', {\n      'issue-with-checkbox': hasCheckbox,\n      selected: this.props.selected\n    });\n\n    return (\n      <div\n        className={issueClass}\n        data-issue={issue.key}\n        onClick={this.handleClick}\n        role=\"listitem\"\n        tabIndex={0}>\n        <IssueTitleBar\n          branchLike={this.props.branchLike}\n          currentPopup={this.props.currentPopup}\n          displayLocationsCount={this.props.displayLocationsCount}\n          displayLocationsLink={this.props.displayLocationsLink}\n          issue={issue}\n          onFail={this.props.onFail}\n          onFilter={this.props.onFilter}\n          togglePopup={this.props.togglePopup}\n        />\n        <IssueActionsBar\n          currentPopup={this.props.currentPopup}\n          issue={issue}\n          onAssign={this.props.onAssign}\n          onChange={this.props.onChange}\n          onFail={this.props.onFail}\n          togglePopup={this.props.togglePopup}\n        />\n        {issue.comments &&\n          issue.comments.length > 0 && (\n            <div className=\"issue-comments\">\n              {issue.comments.map(comment => (\n                <IssueCommentLine\n                  comment={comment}\n                  key={comment.key}\n                  onDelete={this.deleteComment}\n                  onEdit={this.editComment}\n                />\n              ))}\n            </div>\n          )}\n        {hasCheckbox && (\n          <a className=\"js-toggle issue-checkbox-container\" href=\"#\" onClick={this.handleCheck}>\n            <i\n              className={classNames('issue-checkbox', 'icon-checkbox', {\n                'icon-checkbox-checked': this.props.checked\n              })}\n            />\n          </a>\n        )}\n      </div>\n    );\n  }\n}\n\nfunction isClickable(node /*: any */) {\n  if (!node) {\n    return false;\n  }\n  const clickableTags = ['A', 'BUTTON', 'INPUT', 'TEXTAREA'];\n  const tagName = (node.tagName || '').toUpperCase();\n  return clickableTags.includes(tagName) || isClickable(node.parentNode);\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2018 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\n// @flow\nimport React from 'react';\nimport key from 'keymaster';\nimport PropTypes from 'prop-types';\nimport IssueView from './IssueView';\nimport { updateIssue } from './actions';\nimport { onFail } from '../../store/rootActions';\nimport { setIssueAssignee } from '../../api/issues';\n/*:: import type { Issue as IssueType } from './types'; */\nimport './Issue.css';\n\n/*::\ntype Props = {|\n  branchLike?: { id?: string; name: string },\n  checked?: boolean,\n  displayLocationsCount?: boolean;\n  displayLocationsLink?: boolean;\n  issue: IssueType,\n  onChange: IssueType => void,\n  onCheck?: (issue: string, event: Event) => void,\n  onClick: string => void,\n  onFilter?: (property: string, issue: IssueType) => void,\n  onPopupToggle: (issue: string, popupName: string, open: ?boolean) => void,\n  openPopup: ?string,\n  selected: boolean\n|};\n*/\n\nexport default class Issue extends React.PureComponent {\n  /*:: props: Props; */\n\n  static contextTypes = {\n    store: PropTypes.object\n  };\n\n  static defaultProps = {\n    displayLocationsCount: true,\n    displayLocationsLink: true,\n    selected: false\n  };\n\n  componentDidMount() {\n    if (this.props.selected) {\n      this.bindShortcuts();\n    }\n  }\n\n  componentWillUpdate(nextProps /*: Props */) {\n    if (!nextProps.selected && this.props.selected) {\n      this.unbindShortcuts();\n    }\n  }\n\n  componentDidUpdate(prevProps /*: Props */) {\n    if (!prevProps.selected && this.props.selected) {\n      this.bindShortcuts();\n    }\n  }\n\n  componentWillUnmount() {\n    if (this.props.selected) {\n      this.unbindShortcuts();\n    }\n  }\n\n  bindShortcuts() {\n    key('f', 'issues', () => {\n      this.togglePopup('transition');\n      return false;\n    });\n    key('a', 'issues', () => {\n      this.togglePopup('assign');\n      return false;\n    });\n    key('m', 'issues', () => {\n      if (this.props.issue.actions.includes('assign')) {\n        this.handleAssignement('_me');\n      }\n      return false;\n    });\n    key('i', 'issues', () => {\n      this.togglePopup('set-severity');\n      return false;\n    });\n    key('c', 'issues', () => {\n      this.togglePopup('comment');\n      return false;\n    });\n    key('t', 'issues', () => {\n      this.togglePopup('edit-tags');\n      return false;\n    });\n    key('space', 'issues', (event /*: Event*/) => {\n      if (this.props.onCheck) {\n        this.props.onCheck(this.props.issue.key, event);\n        return false;\n      }\n      return undefined;\n    });\n  }\n\n  unbindShortcuts() {\n    key.unbind('f', 'issues');\n    key.unbind('a', 'issues');\n    key.unbind('m', 'issues');\n    key.unbind('i', 'issues');\n    key.unbind('c', 'issues');\n    key.unbind('space', 'issues');\n    key.unbind('t', 'issues');\n  }\n\n  togglePopup = (popupName /*: string */, open /*: ?boolean */) => {\n    this.props.onPopupToggle(this.props.issue.key, popupName, open);\n  };\n\n  handleAssignement = (login /*: string */) => {\n    const { issue } = this.props;\n    if (issue.assignee !== login) {\n      updateIssue(\n        this.props.onChange,\n        this.handleFail,\n        setIssueAssignee({ issue: issue.key, assignee: login })\n      );\n    }\n    this.togglePopup('assign', false);\n  };\n\n  handleFail = (error /*: Error */) => {\n    onFail(this.context.store.dispatch)(error);\n  };\n\n  render() {\n    return (\n      <IssueView\n        branchLike={this.props.branchLike}\n        checked={this.props.checked}\n        currentPopup={this.props.openPopup}\n        displayLocationsCount={this.props.displayLocationsCount}\n        displayLocationsLink={this.props.displayLocationsLink}\n        issue={this.props.issue}\n        onAssign={this.handleAssignement}\n        onCheck={this.props.onCheck}\n        onClick={this.props.onClick}\n        onFail={this.handleFail}\n        onFilter={this.props.onFilter}\n        onChange={this.props.onChange}\n        selected={this.props.selected}\n        togglePopup={this.togglePopup}\n      />\n    );\n  }\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2018 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport * as classNames from 'classnames';\nimport './LocationMessage.css';\n\ninterface Props {\n  children?: React.ReactNode;\n  selected: boolean;\n}\n\nexport default function LocationMessage(props: Props) {\n  return (\n    <div className={classNames('location-message', { selected: props.selected })}>\n      {props.children}\n    </div>\n  );\n}\n","exports = module.exports = require(\"../../../../../node_modules/css-loader/lib/css-base.js\")(false);\n// imports\n\n\n// module\nexports.push([module.id, \".source-viewer{width:100%;min-height:200px;border:1px solid #cdcdcd;box-sizing:border-box;background-color:#fff;overflow-x:auto;overflow-y:hidden}.source-table{width:100%;border:none;border-collapse:collapse}.source-line:hover .source-line-coverage,.source-line:hover .source-line-duplications,.source-line:hover .source-line-duplications-extra,.source-line:hover .source-line-issues,.source-line:hover .source-line-number,.source-line:hover .source-line-scm{border-color:#e9e9e9;background-color:#e9e9e9}.source-line:hover .source-line-code{background-color:#f5f5f5}.source-line-highlighted .source-line-coverage,.source-line-highlighted .source-line-duplications,.source-line-highlighted .source-line-duplications-extra,.source-line-highlighted .source-line-issues,.source-line-highlighted .source-line-number,.source-line-highlighted .source-line-scm,.source-line-highlighted:hover .source-line-coverage,.source-line-highlighted:hover .source-line-duplications,.source-line-highlighted:hover .source-line-duplications-extra,.source-line-highlighted:hover .source-line-issues,.source-line-highlighted:hover .source-line-number,.source-line-highlighted:hover .source-line-scm{border-color:#c4dfec!important;background-color:#c4dfec}.source-line-highlighted .source-line-code,.source-line-highlighted:hover .source-line-code{background-color:#d9edf7}.source-line-filtered .source-line-code{background-color:#fbf3d5!important}.source-line-filtered:hover .source-line-code{background-color:#f1e8cb!important}.source-line-filtered.source-line-filtered-dark .source-line-code{background-color:#f9ebb7!important}.source-line-filtered.source-line-filtered-dark:hover .source-line-code{background-color:#eaddb2!important}.source-line-last .source-line-code{padding-bottom:160px}.source-viewer pre{height:18px;padding:0}.source-line-number,.source-line-scm,.source-viewer pre{line-height:18px;font-family:Consolas,Liberation Mono,Menlo,Courier,monospace;font-size:12px}.source-line-code{position:relative;padding:0 10px}.source-line-code pre{float:left}.source-line-code .issue-list{margin-left:-10px;margin-right:-10px}.source-line-code-inner:after,.source-line-code-inner:before{display:table;content:\\\"\\\";line-height:0}.source-line-code-inner:after{clear:both}.source-line-code-issue{display:inline-block;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAcAAAAGCAYAAAAPDoR2AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyRpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMy1jMDExIDY2LjE0NTY2MSwgMjAxMi8wMi8wNi0xNDo1NjoyNyAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNiAoTWFjaW50b3NoKSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDo1M0M2Rjk4M0M3QUYxMUUzODkzRUREMUM5OTNDMjY4QSIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDo1M0M2Rjk4NEM3QUYxMUUzODkzRUREMUM5OTNDMjY4QSI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOjUzQzZGOTgxQzdBRjExRTM4OTNFREQxQzk5M0MyNjhBIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjUzQzZGOTgyQzdBRjExRTM4OTNFREQxQzk5M0MyNjhBIi8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+bcqJtQAAAEhJREFUeNpi+G+swwDGDAwgbAWlwZiJAQFCgfgwEIfDRaC67ID4NRDnQ2kQnwFZwgFqnANMAQOUYY9sF0wBiCGH5CBkrAgQYACuWi4sSGW8yAAAAABJRU5ErkJggg==);background-repeat:repeat-x;background-size:4px;background-position:bottom}.source-meta{position:relative;vertical-align:top;width:1px;background-clip:padding-box;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.source-meta:focus{outline:none}.source-meta[role=button]{cursor:pointer}.source-meta+.source-meta{border-left:1px solid #f3f3f3}.source-line-number{min-width:18px;padding:0 10px;background-color:#f3f3f3;color:#777;text-align:right}.source-line-number:before{content:attr(data-line-number)}.source-line-issues{position:relative;padding:0 2px;background-color:#f3f3f3}.source-line-issues-counter{position:absolute;top:-1px;right:-1px;line-height:8px;font-size:8px}.source-line-coverage,.source-line-duplications,.source-line-duplications-extra{background-color:#f3f3f3}.source-duplications-expanded .source-line-duplications,.source-line-duplications-extra{display:none}.source-duplications-expanded .source-line-duplications-extra{display:table-cell}.source-line-scm{padding:0 5px;background-color:#f3f3f3}.source-line-scm-inner{max-width:40px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.source-line-scm-inner:before{content:attr(data-author)}.source-line-bar{width:5px;height:18px}.source-line-covered{background-color:#0a0!important}.source-line-uncovered{background-color:#d4333f!important}.source-line-partially-covered{background-color:#ed7d20!important;background-image:repeating-linear-gradient(45deg,hsla(0,0%,100%,.5) 4px,transparent 0,transparent 8px,hsla(0,0%,100%,.5) 0,hsla(0,0%,100%,.5) 12px,transparent 0,transparent 16px,hsla(0,0%,100%,.5) 0,hsla(0,0%,100%,.5) 20px)!important}.source-line-duplicated{background-color:#797979!important}.source-viewer-header{position:relative;padding:2px 10px 4px;border-bottom:1px solid #e6e6e6;background-color:#f3f3f3}.source-viewer-header:after,.source-viewer-header:before{display:table;content:\\\"\\\";line-height:0}.source-viewer-header:after{clear:both}.source-viewer-header-bar+.source-viewer-header-bar{border-top:1px solid #e6e6e6}.source-viewer-header-component{float:left;padding-top:4px}.source-viewer-header-component-project{color:#777;font-size:12px}.source-viewer-header-component-name{font-weight:600}.source-viewer-header-favorite{position:relative;top:-2px;margin-left:4px;border-bottom:none}.source-viewer-header-measures{float:right}.source-viewer-header-measures-scope{position:relative;float:left}.source-viewer-header-measure{display:inline-block;vertical-align:middle;padding:3px 0;font-size:13px}.source-viewer-header-measure .rating{font-size:18px}.source-viewer-header-measure+.source-viewer-header-measure{margin-left:25px}.source-viewer-header-measure-label{display:block;margin-top:4px;line-height:12px;color:#777;font-size:12px}.source-viewer-header-measure-value{display:block;line-height:18px;color:#444;font-size:16px}.source-viewer-header-actions{float:right;display:block;margin-left:25px;padding:8px 5px}.source-viewer-header-actions svg{margin-top:2px}.source-viewer-header-more-actions{position:absolute;z-index:7500;right:0;top:100%;padding:10px;border:1px solid #e6e6e6;border-right:none;background-color:#fff;line-height:1.8}.source-viewer-measures-overlay{padding:20px 10px;background-color:#f3f3f3}.source-viewer-measures-overlay,.source-viewer-measures-overlay .modal-foot{width:1100px;left:50%;right:auto;margin-left:-550px}.source-viewer-measures-component{float:none;margin:0 10px 30px}.source-viewer-measures,.source-viewer-measures-modal{background-color:#f3f3f3}.source-viewer-measures{margin:0 -10px}.source-viewer-measures:after,.source-viewer-measures:before{display:table;content:\\\"\\\";line-height:0}.source-viewer-measures:after{clear:both}.source-viewer-measures+.source-viewer-measures{margin-top:40px}.source-viewer-measures-secondary .source-viewer-measures-card{background-color:hsla(0,0%,100%,.6)}.source-viewer-measures-section{float:left;width:25%;margin:-20px 0}.source-viewer-measures-section-big{width:50%}.source-viewer-measures-section-full{width:100%}.source-viewer-measures-section+.source-viewer-measures-section-full{margin-top:20px}.source-viewer-measures-card{margin:20px 10px;padding:10px;border:1px solid #e6e6e6;background-color:#fff}.source-viewer-measures-card-overflow{overflow:auto}.source-viewer-measures-card-fixed-height{max-height:36vh;overflow-y:scroll}.source-viewer-tests-list{width:100%;font-size:13px}.source-viewer-test-covered-lines,.source-viewer-test-duration,.source-viewer-test-status{width:1px}.source-viewer-test-covered-lines,.source-viewer-test-covered-name,.source-viewer-test-duration,.source-viewer-test-status{vertical-align:middle;padding:3px}.source-viewer-test-name{padding-left:10px;word-break:break-all}.source-viewer-test-covered-lines{text-align:right}.source-viewer-issue-location{max-width:200px;margin-right:10px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.source-viewer-flow-location+.source-viewer-flow-location{z-index:504}.source-line-issue-locations{float:right;margin-right:-10px}.source-line-issue-locations:empty{display:none}.source-viewer-more-code{padding:40px 0;border-bottom:1px solid #e6e6e6;background-color:#f3f3f3;text-align:center}.source-viewer-more-code .spinner{top:-1px}.source-table+.source-viewer-more-code{border-bottom:none;border-top:1px solid #e6e6e6}.source-viewer-bubble-popup{font-family:Helvetica Neue,Segoe UI,Helvetica,Arial,sans-serif;font-size:13px;text-align:left}.issue-location{display:inline-block;vertical-align:top;line-height:18px;height:18px;box-sizing:border-box;background-color:#ffeaea;transition:background-color .3s ease}.issue-location.highlighted{border-color:#e1e1f2;background-color:#e1e1f2}.issue-location.selected{border-color:#f4b1b0;background-color:#f4b1b0}.measures+.measures{margin-top:15px;padding-top:15px;border-top:1px solid #e6e6e6}.measures-chart{display:inline-block;vertical-align:middle;width:70px;margin-right:20px;text-align:center}.measures-chart .rating{font-size:32px}.measure{line-height:1.3333333333333}.measure-name{display:block;font-size:13px}.measure-value{color:#236a97;font-size:16px;font-weight:400}.measure-big{display:inline-block;vertical-align:middle}.measure-big .measure-name{margin-top:2px;font-size:15px;font-weight:400}.measure-big .measure-value,.measure-big .rating{font-size:22px}.measure-big+.measure-big{margin-left:20px}.measure-one-line:after,.measure-one-line:before{display:table;content:\\\"\\\";line-height:0}.measure-one-line:after{clear:both}.measure-one-line .measure-name{float:left}.measure-one-line .measure-value{float:right}\", \"\"]);\n\n// exports\n","\nvar content = require(\"!!../../../../../node_modules/css-loader/index.js??ref--6-1!../../../../../node_modules/postcss-loader/lib/index.js??postcss!./styles.css\");\n\nif(typeof content === 'string') content = [[module.id, content, '']];\n\nvar transform;\nvar insertInto;\n\n\n\nvar options = {\"hmr\":true}\n\noptions.transform = transform\noptions.insertInto = undefined;\n\nvar update = require(\"!../../../../../node_modules/style-loader/lib/addStyles.js\")(content, options);\n\nif(content.locals) module.exports = content.locals;\n\nif(module.hot) {\n\tmodule.hot.accept(\"!!../../../../../node_modules/css-loader/index.js??ref--6-1!../../../../../node_modules/postcss-loader/lib/index.js??postcss!./styles.css\", function() {\n\t\tvar newContent = require(\"!!../../../../../node_modules/css-loader/index.js??ref--6-1!../../../../../node_modules/postcss-loader/lib/index.js??postcss!./styles.css\");\n\n\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\n\t\tvar locals = (function(a, b) {\n\t\t\tvar key, idx = 0;\n\n\t\t\tfor(key in a) {\n\t\t\t\tif(!b || a[key] !== b[key]) return false;\n\t\t\t\tidx++;\n\t\t\t}\n\n\t\t\tfor(key in b) idx--;\n\n\t\t\treturn idx === 0;\n\t\t}(content.locals, newContent.locals));\n\n\t\tif(!locals) throw new Error('Aborting CSS HMR due to changed css-modules locals.');\n\n\t\tupdate(newContent);\n\t});\n\n\tmodule.hot.dispose(function() { update(); });\n}","exports = module.exports = require(\"../../../../../node_modules/css-loader/lib/css-base.js\")(false);\n// imports\n\n\n// module\nexports.push([module.id, \".location-message{display:inline-block;vertical-align:top;line-height:16px;padding:0 6px;border-radius:2px;background-color:#9e9e9e;color:#fff;font-family:Helvetica Neue,Segoe UI,Helvetica,Arial,sans-serif;font-size:12px;text-overflow:ellipsis;overflow:hidden;transition:background-color .3s ease}.location-message.selected{background-color:#475760}.location-index+.location-message{margin-left:4px}.location-index>.location-message{position:absolute;bottom:calc(100% + 4px);left:0}.location-index>.location-message:after{position:absolute;bottom:-5px;left:4px;width:0;height:0;border-top:5px solid #475760;border-left:5px solid transparent;border-right:5px solid transparent;content:\\\"\\\"}.source-line-code .location-message{padding-top:2px;padding-bottom:2px}\", \"\"]);\n\n// exports\n","\nvar content = require(\"!!../../../../../node_modules/css-loader/index.js??ref--6-1!../../../../../node_modules/postcss-loader/lib/index.js??postcss!./LocationMessage.css\");\n\nif(typeof content === 'string') content = [[module.id, content, '']];\n\nvar transform;\nvar insertInto;\n\n\n\nvar options = {\"hmr\":true}\n\noptions.transform = transform\noptions.insertInto = undefined;\n\nvar update = require(\"!../../../../../node_modules/style-loader/lib/addStyles.js\")(content, options);\n\nif(content.locals) module.exports = content.locals;\n\nif(module.hot) {\n\tmodule.hot.accept(\"!!../../../../../node_modules/css-loader/index.js??ref--6-1!../../../../../node_modules/postcss-loader/lib/index.js??postcss!./LocationMessage.css\", function() {\n\t\tvar newContent = require(\"!!../../../../../node_modules/css-loader/index.js??ref--6-1!../../../../../node_modules/postcss-loader/lib/index.js??postcss!./LocationMessage.css\");\n\n\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\n\t\tvar locals = (function(a, b) {\n\t\t\tvar key, idx = 0;\n\n\t\t\tfor(key in a) {\n\t\t\t\tif(!b || a[key] !== b[key]) return false;\n\t\t\t\tidx++;\n\t\t\t}\n\n\t\t\tfor(key in b) idx--;\n\n\t\t\treturn idx === 0;\n\t\t}(content.locals, newContent.locals));\n\n\t\tif(!locals) throw new Error('Aborting CSS HMR due to changed css-modules locals.');\n\n\t\tupdate(newContent);\n\t});\n\n\tmodule.hot.dispose(function() { update(); });\n}","exports = module.exports = require(\"../../../../../node_modules/css-loader/lib/css-base.js\")(false);\n// imports\n\n\n// module\nexports.push([module.id, \".issue{position:relative;padding-top:8px;padding-bottom:8px;background-color:#ffeaea;box-shadow:inset 0 0 0 1px #ffeaea;transition:all .3s ease,border 0 ease}.issue.selected{box-shadow:none;border:1px solid #dd4040!important}.issue+.issue,.issue-container+.issue-container{margin-top:5px}.issue.selected+.issue{border-top-color:transparent}.issue-table{width:100%}.issue-table td{vertical-align:top}.issue-row{display:flex;margin-bottom:5px}.issue-row-meta{flex-grow:0;padding-right:5px;white-space:nowrap}.issue-table-meta-cell{width:1px;padding-right:5px;white-space:nowrap}.issue-message{flex-grow:1;padding-left:10px;padding-right:10px;line-height:1.5;font-size:13px;font-weight:600;text-overflow:ellipsis;overflow:hidden}.issue-message .button-link{height:16px}.issue-rule{vertical-align:top;margin-top:2px;padding:0 3px;opacity:.5}.issue-rule,.issue-rule:hover{background:rgba(75,159,213,.3)}.issue-meta-list{display:flex;align-items:center;padding-left:10px}.issue-meta{line-height:16px;font-size:12px}.issue-meta+.issue-meta{margin-left:8px}.issue-meta-label{display:inline-block;vertical-align:top;max-width:180px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.issue-changelog{width:450px;max-height:320px;overflow:auto;white-space:normal}.issue-comments{margin-top:5px;padding-left:10px;padding-right:10px;font-size:12px}.issue-comment{display:table;width:100%}.issue-comment+.issue-comment{margin-top:4px}.issue-comment-author{max-width:130px;font-weight:600;overflow:hidden;text-overflow:ellipsis}.issue-comment-age,.issue-comment-author{display:table-cell;vertical-align:top;width:1px;line-height:18px;color:#777;white-space:nowrap}.issue-comment-text{padding-right:5px;line-height:18px;line-height:1.5;outline:none;word-break:break-all}.issue-comment-actions,.issue-comment-text{display:table-cell;vertical-align:top;padding-left:5px}.issue-comment-actions{width:1px;line-height:18px;white-space:nowrap}.issue-comment-bubble-popup{width:440px;font-size:12px}.issue-comment-form-text textarea{width:100%;max-width:100%}.issue-comment-form-footer{margin-top:5px;line-height:22px}.issue-comment-form-footer:after,.issue-comment-form-footer:before{display:table;content:\\\"\\\";line-height:0}.issue-comment-form-footer:after{clear:both}.issue-comment-form-actions{float:right}.issue-comment-form-tips{float:left}.issue-with-checkbox{padding-left:24px}.issue-with-checkbox .issue-checkbox-container{display:block}.issue-checkbox-container{display:none;position:absolute;width:29px;top:0;bottom:0;left:0;border:none}.issue-checkbox-container:hover{background-color:rgba(0,0,0,.05)}.issue-checkbox{position:absolute;top:50%;left:50%;margin:-8px 0 0 -8px}.issue:not(.selected) .location-index{background-color:#ccc}.issue .menu:not(.issues-similar-issues-menu):not(.issue-changelog){max-height:120px;overflow:auto}\", \"\"]);\n\n// exports\n","\nvar content = require(\"!!../../../../../node_modules/css-loader/index.js??ref--6-1!../../../../../node_modules/postcss-loader/lib/index.js??postcss!./Issue.css\");\n\nif(typeof content === 'string') content = [[module.id, content, '']];\n\nvar transform;\nvar insertInto;\n\n\n\nvar options = {\"hmr\":true}\n\noptions.transform = transform\noptions.insertInto = undefined;\n\nvar update = require(\"!../../../../../node_modules/style-loader/lib/addStyles.js\")(content, options);\n\nif(content.locals) module.exports = content.locals;\n\nif(module.hot) {\n\tmodule.hot.accept(\"!!../../../../../node_modules/css-loader/index.js??ref--6-1!../../../../../node_modules/postcss-loader/lib/index.js??postcss!./Issue.css\", function() {\n\t\tvar newContent = require(\"!!../../../../../node_modules/css-loader/index.js??ref--6-1!../../../../../node_modules/postcss-loader/lib/index.js??postcss!./Issue.css\");\n\n\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\n\t\tvar locals = (function(a, b) {\n\t\t\tvar key, idx = 0;\n\n\t\t\tfor(key in a) {\n\t\t\t\tif(!b || a[key] !== b[key]) return false;\n\t\t\t\tidx++;\n\t\t\t}\n\n\t\t\tfor(key in b) idx--;\n\n\t\t\treturn idx === 0;\n\t\t}(content.locals, newContent.locals));\n\n\t\tif(!locals) throw new Error('Aborting CSS HMR due to changed css-modules locals.');\n\n\t\tupdate(newContent);\n\t});\n\n\tmodule.hot.dispose(function() { update(); });\n}","exports = module.exports = require(\"../../../../../node_modules/css-loader/lib/css-base.js\")(false);\n// imports\n\n\n// module\nexports.push([module.id, \".location-index{position:relative;display:inline-block;vertical-align:top;line-height:16px;padding-left:6px;padding-right:6px;border-radius:2px;background-color:#d18582;color:#fff;font-family:Helvetica Neue,Segoe UI,Helvetica,Arial,sans-serif;font-size:12px;transition:background-color .3s ease;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.location-index.selected{background-color:#bc5e5e}.location-index.muted{background-color:#ccc}.location-index.is-leading{position:absolute;margin:1px 0 0 -4px!important;transform:translateX(-100%)}.location-index[tabindex]{cursor:pointer}.location-index[tabindex]:hover,a:hover>.location-index{background-color:#bc5e5e}.location-index[tabindex]:focus{outline:none}.source-line-code-inner .location-index{line-height:16px;margin:1px;margin-left:4px;margin-right:4px}.source-line-code-inner .location-index+.location-index{margin-left:0}\", \"\"]);\n\n// exports\n","\nvar content = require(\"!!../../../../../node_modules/css-loader/index.js??ref--6-1!../../../../../node_modules/postcss-loader/lib/index.js??postcss!./LocationIndex.css\");\n\nif(typeof content === 'string') content = [[module.id, content, '']];\n\nvar transform;\nvar insertInto;\n\n\n\nvar options = {\"hmr\":true}\n\noptions.transform = transform\noptions.insertInto = undefined;\n\nvar update = require(\"!../../../../../node_modules/style-loader/lib/addStyles.js\")(content, options);\n\nif(content.locals) module.exports = content.locals;\n\nif(module.hot) {\n\tmodule.hot.accept(\"!!../../../../../node_modules/css-loader/index.js??ref--6-1!../../../../../node_modules/postcss-loader/lib/index.js??postcss!./LocationIndex.css\", function() {\n\t\tvar newContent = require(\"!!../../../../../node_modules/css-loader/index.js??ref--6-1!../../../../../node_modules/postcss-loader/lib/index.js??postcss!./LocationIndex.css\");\n\n\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\n\t\tvar locals = (function(a, b) {\n\t\t\tvar key, idx = 0;\n\n\t\t\tfor(key in a) {\n\t\t\t\tif(!b || a[key] !== b[key]) return false;\n\t\t\t\tidx++;\n\t\t\t}\n\n\t\t\tfor(key in b) idx--;\n\n\t\t\treturn idx === 0;\n\t\t}(content.locals, newContent.locals));\n\n\t\tif(!locals) throw new Error('Aborting CSS HMR due to changed css-modules locals.');\n\n\t\tupdate(newContent);\n\t});\n\n\tmodule.hot.dispose(function() { update(); });\n}","/*\n * SonarQube\n * Copyright (C) 2009-2018 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport { getRatingTooltip } from './utils';\nimport Rating from '../ui/Rating';\nimport Level from '../ui/Level';\nimport Tooltip from '../controls/Tooltip';\nimport { formatMeasure } from '../../helpers/measures';\n\ninterface Props {\n  className?: string;\n  decimals?: number | null;\n  metricKey: string;\n  metricType: string;\n  small?: boolean;\n  value: string | undefined;\n}\n\nexport default function Measure({\n  className,\n  decimals,\n  metricKey,\n  metricType,\n  small,\n  value\n}: Props) {\n  if (value === undefined) {\n    return <span>{'–'}</span>;\n  }\n\n  if (metricType === 'LEVEL') {\n    return <Level className={className} level={value} small={small} />;\n  }\n\n  if (metricType !== 'RATING') {\n    const formattedValue = formatMeasure(value, metricType, { decimals });\n    return <span className={className}>{formattedValue != null ? formattedValue : '–'}</span>;\n  }\n\n  const tooltip = getRatingTooltip(metricKey, Number(value));\n  const rating = <Rating small={small} value={value} />;\n  if (tooltip) {\n    return (\n      <Tooltip overlay={tooltip}>\n        <span className={className}>{rating}</span>\n      </Tooltip>\n    );\n  }\n  return rating;\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2018 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport {\n  getRatingTooltip as nextGetRatingTooltip,\n  isDiffMetric,\n  Measure,\n  MeasureEnhanced\n} from '../../helpers/measures';\nimport { Metric } from '../../app/types';\n\nconst KNOWN_RATINGS = ['sqale_rating', 'reliability_rating', 'security_rating'];\n\nexport function enhanceMeasure(\n  measure: Measure,\n  metrics: { [key: string]: Metric }\n): MeasureEnhanced {\n  return {\n    ...measure,\n    metric: metrics[measure.metric],\n    leak: getLeakValue(measure)\n  };\n}\n\nexport function getLeakValue(measure: Measure | undefined): string | undefined {\n  if (!measure || !measure.periods) {\n    return undefined;\n  }\n  const period = measure.periods.find(period => period.index === 1);\n  return period && period.value;\n}\n\nexport function getRatingTooltip(metricKey: string, value: number): string | undefined {\n  const finalMetricKey = isDiffMetric(metricKey) ? metricKey.substr(4) : metricKey;\n  if (KNOWN_RATINGS.includes(finalMetricKey)) {\n    return nextGetRatingTooltip(finalMetricKey, value);\n  }\n  return undefined;\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2018 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport { Metric } from '../../../app/types';\nimport Measure from '../../measure/Measure';\nimport IssueTypeIcon from '../../ui/IssueTypeIcon';\nimport { getLocalizedMetricName } from '../../../helpers/l10n';\n\nexport interface MeasureWithMetric {\n  metric: Metric;\n  value?: string;\n}\n\ninterface Props {\n  measure: MeasureWithMetric;\n}\n\nexport default function MeasuresOverlayMeasure({ measure }: Props) {\n  return (\n    <div\n      className=\"measure measure-one-line\"\n      data-metric={measure.metric.key}\n      key={measure.metric.key}>\n      <span className=\"measure-name\">\n        {['bugs', 'vulnerabilities', 'code_smells'].includes(measure.metric.key) && (\n          <IssueTypeIcon className=\"little-spacer-right\" query={measure.metric.key} />\n        )}\n        {getLocalizedMetricName(measure.metric)}\n      </span>\n      <span className=\"measure-value\">\n        <Measure\n          metricKey={measure.metric.key}\n          metricType={measure.metric.type}\n          small={true}\n          value={measure.value}\n        />\n      </span>\n    </div>\n  );\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2018 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport { Link } from 'react-router';\nimport { getCoveredFiles } from '../../../api/tests';\nimport { TestCase, CoveredFile } from '../../../app/types';\nimport { translate, translateWithParameters } from '../../../helpers/l10n';\nimport { getProjectUrl } from '../../../helpers/urls';\nimport DeferredSpinner from '../../common/DeferredSpinner';\n\ninterface Props {\n  testCase: TestCase;\n}\n\ninterface State {\n  coveredFiles?: CoveredFile[];\n  loading: boolean;\n}\n\nexport default class MeasuresOverlayCoveredFiles extends React.PureComponent<Props, State> {\n  mounted = false;\n  state: State = { loading: true };\n\n  componentDidMount() {\n    this.mounted = true;\n    this.fetchCoveredFiles();\n  }\n\n  componentDidUpdate(prevProps: Props) {\n    if (this.props.testCase.id !== prevProps.testCase.id) {\n      this.fetchCoveredFiles();\n    }\n  }\n\n  componentWillUnmount() {\n    this.mounted = false;\n  }\n\n  fetchCoveredFiles = () => {\n    this.setState({ loading: true });\n    getCoveredFiles({ testId: this.props.testCase.id }).then(\n      coveredFiles => {\n        if (this.mounted) {\n          this.setState({ coveredFiles, loading: false });\n        }\n      },\n      () => {\n        if (this.mounted) {\n          this.setState({ loading: false });\n        }\n      }\n    );\n  };\n\n  render() {\n    const { testCase } = this.props;\n    const { loading, coveredFiles } = this.state;\n\n    return (\n      <div className=\"source-viewer-measures-section source-viewer-measures-section-big js-selected-test\">\n        <DeferredSpinner loading={loading}>\n          <div className=\"source-viewer-measures-card source-viewer-measures-card-fixed-height\">\n            {testCase.status !== 'ERROR' &&\n              testCase.status !== 'FAILURE' &&\n              coveredFiles !== undefined && (\n                <>\n                  <h6 className=\"spacer-bottom\">\n                    {translate('component_viewer.transition.covers')}\n                  </h6>\n                  {coveredFiles.length > 0\n                    ? coveredFiles.map(coveredFile => (\n                        <div className=\"spacer-top\" key={coveredFile.key}>\n                          <Link to={getProjectUrl(coveredFile.key)}>{coveredFile.longName}</Link>\n                          <span className=\"note spacer-left\">\n                            {translateWithParameters(\n                              'component_viewer.x_lines_are_covered',\n                              coveredFile.coveredLines\n                            )}\n                          </span>\n                        </div>\n                      ))\n                    : translate('none')}\n                </>\n              )}\n\n            {testCase.status !== 'OK' && (\n              <>\n                <h6 className=\"spacer-bottom\">{translate('component_viewer.details')}</h6>\n                {testCase.message && <pre>{testCase.message}</pre>}\n                <pre>{testCase.stacktrace}</pre>\n              </>\n            )}\n          </div>\n        </DeferredSpinner>\n      </div>\n    );\n  }\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2018 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport throwGlobalError from '../app/utils/throwGlobalError';\nimport { Paging, TestCase, CoveredFile, BranchParameters } from '../app/types';\nimport { getJSON } from '../helpers/request';\n\nexport function getTests(\n  parameters: {\n    p?: number;\n    ps?: number;\n    sourceFileKey?: string;\n    sourceFileLineNumber?: number;\n    testFileKey: string;\n    testId?: string;\n  } & BranchParameters\n): Promise<{ paging: Paging; tests: TestCase[] }> {\n  return getJSON('/api/tests/list', parameters).catch(throwGlobalError);\n}\n\nexport function getCoveredFiles(data: { testId: string }): Promise<CoveredFile[]> {\n  return getJSON('/api/tests/covered_files', data).then(r => r.files, throwGlobalError);\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2018 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport Icon, { IconProps } from './Icon';\nimport * as theme from '../../app/theme';\n\ninterface Props {\n  className?: string;\n  status: string;\n}\n\nconst statusIcons: { [x: string]: (props: IconProps) => React.ReactElement<any> } = {\n  ok: OkTestStatusIcon,\n  failure: FailureTestStatusIcon,\n  error: ErrorTestStatusIcon,\n  skipped: SkippedTestStatusIcon\n};\n\nexport default function TestStatusIcon(props: Props) {\n  const status = props.status.toLowerCase();\n  const Icon = statusIcons[status];\n  return Icon ? <Icon className={props.className} /> : null;\n}\n\nfunction OkTestStatusIcon({ className, size }: IconProps) {\n  return (\n    <Icon className={className} size={size}>\n      <path\n        d=\"M12.03 6.734a.49.49 0 0 0-.14-.36l-.71-.702a.48.48 0 0 0-.352-.15.474.474 0 0 0-.35.15l-3.19 3.18-1.765-1.766a.479.479 0 0 0-.35-.15.479.479 0 0 0-.353.15l-.71.703a.482.482 0 0 0-.14.358c0 .14.046.258.14.352l2.828 2.828c.098.1.216.15.35.15.142 0 .26-.05.36-.15l4.243-4.242a.475.475 0 0 0 .14-.352l-.001.001zM14 8c0 1.09-.268 2.092-.805 3.012a5.96 5.96 0 0 1-2.183 2.183A5.863 5.863 0 0 1 8 14a5.863 5.863 0 0 1-3.012-.805 5.96 5.96 0 0 1-2.183-2.183A5.863 5.863 0 0 1 2 8c0-1.09.268-2.092.805-3.012a5.96 5.96 0 0 1 2.183-2.183A5.863 5.863 0 0 1 8 2c1.09 0 2.092.268 3.012.805a5.96 5.96 0 0 1 2.183 2.183C13.732 5.908 14 6.91 14 8z\"\n        style={{ fill: theme.green }}\n      />\n    </Icon>\n  );\n}\n\nfunction FailureTestStatusIcon({ className, size }: IconProps) {\n  return (\n    <Icon className={className} size={size}>\n      <path\n        d=\"M8 14c-3.311 0-6-2.689-6-6s2.689-6 6-6 6 2.689 6 6-2.689 6-6 6zM7 9h2V4H7v5zm0 3h2v-2H7v2z\"\n        style={{ fill: theme.orange, fillRule: 'nonzero' }}\n      />\n    </Icon>\n  );\n}\n\nfunction ErrorTestStatusIcon({ className, size }: IconProps) {\n  return (\n    <Icon className={className} size={size}>\n      <path\n        d=\"M10.977 9.766a.497.497 0 0 0-.149-.352L9.414 8l1.414-1.414a.497.497 0 0 0 0-.711l-.703-.703a.497.497 0 0 0-.71 0L8 6.586 6.586 5.172a.497.497 0 0 0-.711 0l-.703.703a.497.497 0 0 0 0 .71L6.586 8 5.172 9.414a.497.497 0 0 0 0 .711l.703.703a.497.497 0 0 0 .71 0L8 9.414l1.414 1.414a.497.497 0 0 0 .711 0l.703-.703a.515.515 0 0 0 .149-.36zM14 8c0 3.313-2.688 6-6 6-3.313 0-6-2.688-6-6 0-3.313 2.688-6 6-6 3.313 0 6 2.688 6 6z\"\n        style={{ fill: theme.red, fillRule: 'nonzero' }}\n      />\n    </Icon>\n  );\n}\n\nfunction SkippedTestStatusIcon({ className, size }: IconProps) {\n  return (\n    <Icon className={className} size={size}>\n      <path\n        d=\"M11.5 8.5v-1c0-.273-.227-.5-.5-.5H5c-.273 0-.5.227-.5.5v1c0 .273.227.5.5.5h6c.273 0 .5-.227.5-.5zM14 8c0 3.313-2.688 6-6 6-3.313 0-6-2.688-6-6 0-3.313 2.688-6 6-6 3.313 0 6 2.688 6 6z\"\n        style={{ fill: theme.gray71, fillRule: 'nonzero' }}\n      />\n    </Icon>\n  );\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2018 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport { TestCase } from '../../../app/types';\nimport TestStatusIcon from '../../icons-components/TestStatusIcon';\n\ninterface Props {\n  onClick: (testId: string) => void;\n  testCase: TestCase;\n}\n\nexport default class MeasuresOverlayTestCase extends React.PureComponent<Props> {\n  handleTestCaseClick = (event: React.SyntheticEvent<HTMLAnchorElement>) => {\n    event.preventDefault();\n    event.currentTarget.blur();\n    this.props.onClick(this.props.testCase.id);\n  };\n\n  render() {\n    const { testCase } = this.props;\n    const { status } = testCase;\n    const hasAdditionalData = status !== 'OK' || (status === 'OK' && testCase.coveredLines);\n\n    return (\n      <tr>\n        <td className=\"source-viewer-test-status\">\n          <TestStatusIcon status={status} />\n        </td>\n        <td className=\"source-viewer-test-duration note\">\n          {status !== 'SKIPPED' && `${testCase.durationInMs}ms`}\n        </td>\n        <td className=\"source-viewer-test-name\">\n          {hasAdditionalData ? (\n            <a className=\"js-show-test\" href=\"#\" onClick={this.handleTestCaseClick}>\n              {testCase.name}\n            </a>\n          ) : (\n            testCase.name\n          )}\n        </td>\n        <td className=\"source-viewer-test-covered-lines note\">{testCase.coveredLines}</td>\n      </tr>\n    );\n  }\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2018 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport * as classNames from 'classnames';\nimport { orderBy } from 'lodash';\nimport MeasuresOverlayCoveredFiles from './MeasuresOverlayCoveredFiles';\nimport MeasuresOverlayTestCase from './MeasuresOverlayTestCase';\nimport { getTests } from '../../../api/tests';\nimport { TestCase, BranchLike } from '../../../app/types';\nimport { translate } from '../../../helpers/l10n';\nimport { getBranchLikeQuery } from '../../../helpers/branches';\n\ninterface Props {\n  branchLike: BranchLike | undefined;\n  componentKey: string;\n}\n\ninterface State {\n  loading: boolean;\n  selectedTestId?: string;\n  sort?: string;\n  sortAsc?: boolean;\n  testCases?: TestCase[];\n}\n\nexport default class MeasuresOverlayTestCases extends React.PureComponent<Props, State> {\n  mounted = false;\n  state: State = { loading: true };\n\n  componentDidMount() {\n    this.mounted = true;\n    this.fetchTests();\n  }\n\n  componentDidUpdate(prevProps: Props) {\n    if (\n      prevProps.branchLike !== this.props.branchLike ||\n      prevProps.componentKey !== this.props.componentKey\n    ) {\n      this.fetchTests();\n    }\n  }\n\n  componentWillUnmount() {\n    this.mounted = false;\n  }\n\n  fetchTests = () => {\n    // TODO implement pagination one day...\n    this.setState({ loading: true });\n    getTests({\n      ps: 500,\n      testFileKey: this.props.componentKey,\n      ...getBranchLikeQuery(this.props.branchLike)\n    }).then(\n      ({ tests: testCases }) => {\n        if (this.mounted) {\n          this.setState({ loading: false, testCases });\n        }\n      },\n      () => {\n        if (this.mounted) {\n          this.setState({ loading: false });\n        }\n      }\n    );\n  };\n\n  handleTestCasesSortClick = (event: React.SyntheticEvent<HTMLAnchorElement>) => {\n    event.preventDefault();\n    event.currentTarget.blur();\n    const { sort } = event.currentTarget.dataset;\n    if (sort) {\n      this.setState((state: State) => ({\n        sort,\n        sortAsc: sort === state.sort ? !state.sortAsc : true\n      }));\n    }\n  };\n\n  handleTestCaseClick = (selectedTestId: string) => {\n    this.setState({ selectedTestId });\n  };\n\n  render() {\n    const { selectedTestId, sort = 'name', sortAsc = true, testCases } = this.state;\n\n    if (!testCases) {\n      return null;\n    }\n\n    const selectedTest = testCases.find(test => test.id === selectedTestId);\n\n    return (\n      <div className=\"source-viewer-measures\">\n        <div className=\"source-viewer-measures-section source-viewer-measures-section-big\">\n          <div className=\"source-viewer-measures-card source-viewer-measures-card-fixed-height js-test-list\">\n            <div className=\"measures\">\n              <table className=\"source-viewer-tests-list\">\n                <tbody>\n                  <tr>\n                    <td className=\"source-viewer-test-status note\" colSpan={3}>\n                      {translate('component_viewer.measure_section.unit_tests')}\n                      <br />\n                      <span className=\"spacer-right\">\n                        {translate('component_viewer.tests.ordered_by')}\n                      </span>\n                      <a\n                        className={classNames('js-sort-tests-by-duration', {\n                          'active-link': sort === 'duration'\n                        })}\n                        data-sort=\"duration\"\n                        href=\"#\"\n                        onClick={this.handleTestCasesSortClick}>\n                        {translate('component_viewer.tests.duration')}\n                      </a>\n                      <span className=\"slash-separator\" />\n                      <a\n                        className={classNames('js-sort-tests-by-name', {\n                          'active-link': sort === 'name'\n                        })}\n                        data-sort=\"name\"\n                        href=\"#\"\n                        onClick={this.handleTestCasesSortClick}>\n                        {translate('component_viewer.tests.test_name')}\n                      </a>\n                      <span className=\"slash-separator\" />\n                      <a\n                        className={classNames('js-sort-tests-by-status', {\n                          'active-link': sort === 'status'\n                        })}\n                        data-sort=\"status\"\n                        href=\"#\"\n                        onClick={this.handleTestCasesSortClick}>\n                        {translate('component_viewer.tests.status')}\n                      </a>\n                    </td>\n                    <td className=\"source-viewer-test-covered-lines note\">\n                      {translate('component_viewer.covered_lines')}\n                    </td>\n                  </tr>\n                  {sortTestCases(testCases, sort, sortAsc).map(testCase => (\n                    <MeasuresOverlayTestCase\n                      key={testCase.id}\n                      onClick={this.handleTestCaseClick}\n                      testCase={testCase}\n                    />\n                  ))}\n                </tbody>\n              </table>\n            </div>\n          </div>\n        </div>\n        {selectedTest && <MeasuresOverlayCoveredFiles testCase={selectedTest} />}\n      </div>\n    );\n  }\n}\n\nfunction sortTestCases(testCases: TestCase[], sort: string, sortAsc: boolean) {\n  const mainOrder = sortAsc ? 'asc' : 'desc';\n  if (sort === 'duration') {\n    return orderBy(testCases, ['durationInMs', 'name'], [mainOrder, 'asc']);\n  } else if (sort === 'status') {\n    return orderBy(testCases, ['status', 'name'], [mainOrder, 'asc']);\n  } else {\n    return orderBy(testCases, ['name'], [mainOrder]);\n  }\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2018 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport { Link } from 'react-router';\nimport { keyBy, sortBy, groupBy } from 'lodash';\nimport MeasuresOverlayMeasure from './MeasuresOverlayMeasure';\nimport MeasuresOverlayTestCases from './MeasuresOverlayTestCases';\nimport { Button } from '../../../components/ui/buttons';\nimport { getFacets } from '../../../api/issues';\nimport { getMeasures } from '../../../api/measures';\nimport { getAllMetrics } from '../../../api/metrics';\nimport { FacetValue, SourceViewerFile, BranchLike } from '../../../app/types';\nimport Modal from '../../controls/Modal';\nimport Measure from '../../measure/Measure';\nimport QualifierIcon from '../../icons-components/QualifierIcon';\nimport SeverityHelper from '../../shared/SeverityHelper';\nimport CoverageRating from '../../ui/CoverageRating';\nimport DuplicationsRating from '../../ui/DuplicationsRating';\nimport IssueTypeIcon from '../../ui/IssueTypeIcon';\nimport { SEVERITIES, TYPES } from '../../../helpers/constants';\nimport { translate, getLocalizedMetricName } from '../../../helpers/l10n';\nimport {\n  formatMeasure,\n  MeasureEnhanced,\n  getDisplayMetrics,\n  enhanceMeasuresWithMetrics\n} from '../../../helpers/measures';\nimport { getBranchLikeUrl } from '../../../helpers/urls';\nimport { getBranchLikeQuery } from '../../../helpers/branches';\nimport TagsIcon from '../../icons-components/TagsIcon';\n\ninterface Props {\n  branchLike: BranchLike | undefined;\n  onClose: () => void;\n  sourceViewerFile: SourceViewerFile;\n}\n\ninterface Measures {\n  [metricKey: string]: MeasureEnhanced;\n}\n\ninterface State {\n  loading: boolean;\n  measures: Measures;\n  severitiesFacet?: FacetValue[];\n  showAllMeasures: boolean;\n  tagsFacet?: FacetValue[];\n  typesFacet?: FacetValue[];\n}\n\nexport default class MeasuresOverlay extends React.PureComponent<Props, State> {\n  mounted = false;\n  state: State = { loading: true, measures: {}, showAllMeasures: false };\n\n  componentDidMount() {\n    this.mounted = true;\n    this.fetchData();\n  }\n\n  componentWillUnmount() {\n    this.mounted = false;\n  }\n\n  fetchData = () => {\n    Promise.all([this.fetchMeasures(), this.fetchIssues()]).then(\n      ([measures, facets]) => {\n        if (this.mounted) {\n          this.setState({ loading: false, measures, ...facets });\n        }\n      },\n      () => {\n        if (this.mounted) {\n          this.setState({ loading: false });\n        }\n      }\n    );\n  };\n\n  fetchMeasures = () => {\n    return getAllMetrics().then(metrics => {\n      const metricKeys = getDisplayMetrics(metrics).map(metric => metric.key);\n\n      // eslint-disable-next-line promise/no-nesting\n      return getMeasures({\n        componentKey: this.props.sourceViewerFile.key,\n        metricKeys: metricKeys.join(),\n        ...getBranchLikeQuery(this.props.branchLike)\n      }).then(measures => {\n        const withMetrics = enhanceMeasuresWithMetrics(measures, metrics).filter(\n          measure => measure.metric\n        );\n        return keyBy(withMetrics, measure => measure.metric.key);\n      });\n    });\n  };\n\n  fetchIssues = () => {\n    return getFacets(\n      {\n        componentKeys: this.props.sourceViewerFile.key,\n        resolved: 'false',\n        ...getBranchLikeQuery(this.props.branchLike)\n      },\n      ['types', 'severities', 'tags']\n    ).then(({ facets }) => {\n      const severitiesFacet = facets.find(f => f.property === 'severities');\n      const tagsFacet = facets.find(f => f.property === 'tags');\n      const typesFacet = facets.find(f => f.property === 'types');\n      return {\n        severitiesFacet: severitiesFacet && severitiesFacet.values,\n        tagsFacet: tagsFacet && tagsFacet.values,\n        typesFacet: typesFacet && typesFacet.values\n      };\n    });\n  };\n\n  handleAllMeasuresClick = (event: React.SyntheticEvent<HTMLAnchorElement>) => {\n    event.preventDefault();\n    event.currentTarget.blur();\n    this.setState({ showAllMeasures: true });\n  };\n\n  renderMeasure = (measure: MeasureEnhanced | undefined) => {\n    return measure ? <MeasuresOverlayMeasure key={measure.metric.key} measure={measure} /> : null;\n  };\n\n  renderLines = () => {\n    const { measures } = this.state;\n\n    return (\n      <div className=\"source-viewer-measures-section\">\n        <div className=\"source-viewer-measures-card\">\n          <div className=\"measures\">\n            <div className=\"measures-list\">\n              {this.renderMeasure(measures.lines)}\n              {this.renderMeasure(measures.ncloc)}\n              {this.renderMeasure(measures.comment_lines)}\n              {this.renderMeasure(measures.comment_lines_density)}\n            </div>\n          </div>\n\n          <div className=\"measures\">\n            <div className=\"measures-list\">\n              {this.renderMeasure(measures.cognitive_complexity)}\n              {this.renderMeasure(measures.complexity)}\n              {this.renderMeasure(measures.function_complexity)}\n            </div>\n          </div>\n        </div>\n      </div>\n    );\n  };\n\n  renderBigMeasure = (measure: MeasureEnhanced | undefined) => {\n    return measure ? (\n      <div className=\"measure measure-big\" data-metric={measure.metric.key}>\n        <span className=\"measure-value\">\n          <Measure\n            metricKey={measure.metric.key}\n            metricType={measure.metric.type}\n            value={measure.value}\n          />\n        </span>\n        <span className=\"measure-name\">{getLocalizedMetricName(measure.metric, true)}</span>\n      </div>\n    ) : null;\n  };\n\n  renderIssues = () => {\n    const { measures, severitiesFacet, tagsFacet, typesFacet } = this.state;\n    return (\n      <div className=\"source-viewer-measures-section\">\n        <div className=\"source-viewer-measures-card\">\n          <div className=\"measures\">\n            {this.renderBigMeasure(measures.violations)}\n            {this.renderBigMeasure(measures.sqale_index)}\n          </div>\n          {measures.violations &&\n            !!measures.violations.value && (\n              <>\n                {typesFacet && (\n                  <div className=\"measures\">\n                    <div className=\"measures-list\">\n                      {sortBy(typesFacet, f => TYPES.indexOf(f.val)).map(f => (\n                        <div className=\"measure measure-one-line\" key={f.val}>\n                          <span className=\"measure-name\">\n                            <IssueTypeIcon className=\"little-spacer-right\" query={f.val} />\n                            {translate('issue.type', f.val)}\n                          </span>\n                          <span className=\"measure-value\">\n                            {formatMeasure(f.count, 'SHORT_INT')}\n                          </span>\n                        </div>\n                      ))}\n                    </div>\n                  </div>\n                )}\n                {severitiesFacet && (\n                  <div className=\"measures\">\n                    <div className=\"measures-list\">\n                      {sortBy(severitiesFacet, f => SEVERITIES.indexOf(f.val)).map(f => (\n                        <div className=\"measure measure-one-line\" key={f.val}>\n                          <span className=\"measure-name\">\n                            <SeverityHelper severity={f.val} />\n                          </span>\n                          <span className=\"measure-value\">\n                            {formatMeasure(f.count, 'SHORT_INT')}\n                          </span>\n                        </div>\n                      ))}\n                    </div>\n                  </div>\n                )}\n                {tagsFacet && (\n                  <div className=\"measures\">\n                    <div className=\"measures-list\">\n                      {tagsFacet.map(f => (\n                        <div className=\"measure measure-one-line\" key={f.val}>\n                          <span className=\"measure-name\">\n                            <TagsIcon className=\"little-spacer-right\" />\n                            {f.val}\n                          </span>\n                          <span className=\"measure-value\">\n                            {formatMeasure(f.count, 'SHORT_INT')}\n                          </span>\n                        </div>\n                      ))}\n                    </div>\n                  </div>\n                )}\n              </>\n            )}\n        </div>\n      </div>\n    );\n  };\n\n  renderCoverage = () => {\n    const { coverage } = this.state.measures;\n    if (!coverage) {\n      return null;\n    }\n    return (\n      <div className=\"source-viewer-measures-section\">\n        <div className=\"source-viewer-measures-card\">\n          <div className=\"measures\">\n            <div className=\"measures-chart\">\n              <CoverageRating size=\"big\" value={coverage.value} />\n            </div>\n            <div className=\"measure measure-big\" data-metric={coverage.metric.key}>\n              <span className=\"measure-value\">\n                <Measure\n                  metricKey={coverage.metric.key}\n                  metricType={coverage.metric.type}\n                  value={coverage.value}\n                />\n              </span>\n              <span className=\"measure-name\">{getLocalizedMetricName(coverage.metric)}</span>\n            </div>\n          </div>\n\n          <div className=\"measures\">\n            <div className=\"measures-list\">\n              {this.renderMeasure(this.state.measures.uncovered_lines)}\n              {this.renderMeasure(this.state.measures.lines_to_cover)}\n              {this.renderMeasure(this.state.measures.uncovered_conditions)}\n              {this.renderMeasure(this.state.measures.conditions_to_cover)}\n            </div>\n          </div>\n        </div>\n      </div>\n    );\n  };\n\n  renderDuplications = () => {\n    const { duplicated_lines_density: duplications } = this.state.measures;\n    if (!duplications) {\n      return null;\n    }\n    return (\n      <div className=\"source-viewer-measures-section\">\n        <div className=\"source-viewer-measures-card\">\n          <div className=\"measures\">\n            <div className=\"measures-chart\">\n              <DuplicationsRating\n                muted={duplications.value === undefined}\n                size=\"big\"\n                value={Number(duplications.value || 0)}\n              />\n            </div>\n            <div className=\"measure measure-big\" data-metric={duplications.metric.key}>\n              <span className=\"measure-value\">\n                <Measure\n                  metricKey={duplications.metric.key}\n                  metricType={duplications.metric.type}\n                  value={duplications.value}\n                />\n              </span>\n              <span className=\"measure-name\">\n                {getLocalizedMetricName(duplications.metric, true)}\n              </span>\n            </div>\n          </div>\n\n          <div className=\"measures\">\n            <div className=\"measures-list\">\n              {this.renderMeasure(this.state.measures.duplicated_blocks)}\n              {this.renderMeasure(this.state.measures.duplicated_lines)}\n            </div>\n          </div>\n        </div>\n      </div>\n    );\n  };\n\n  renderTests = () => {\n    const { measures } = this.state;\n    return (\n      <div className=\"source-viewer-measures\">\n        <div className=\"source-viewer-measures-section\">\n          <div className=\"source-viewer-measures-card\">\n            <div className=\"measures\">\n              <div className=\"measures-list\">\n                {this.renderMeasure(measures.tests)}\n                {this.renderMeasure(measures.test_success_density)}\n                {this.renderMeasure(measures.test_failures)}\n                {this.renderMeasure(measures.test_errors)}\n                {this.renderMeasure(measures.skipped_tests)}\n                {this.renderMeasure(measures.test_execution_time)}\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n    );\n  };\n\n  renderDomain = (domain: string, measures: MeasureEnhanced[]) => {\n    return (\n      <div className=\"source-viewer-measures-card\" key={domain}>\n        <div className=\"measures\">\n          <div className=\"measures-list\">\n            <div className=\"measure measure-one-line measure-big\">\n              <span className=\"measure-name\">{domain}</span>\n            </div>\n            {sortBy(measures.filter(measure => measure.value !== undefined), measure =>\n              getLocalizedMetricName(measure.metric)\n            ).map(measure => this.renderMeasure(measure))}\n          </div>\n        </div>\n      </div>\n    );\n  };\n\n  renderAllMeasures = () => {\n    const domains = groupBy(Object.values(this.state.measures), measure => measure.metric.domain);\n    const domainKeys = Object.keys(domains);\n    const odd = domainKeys.filter((_, index) => index % 2 === 1);\n    const even = domainKeys.filter((_, index) => index % 2 === 0);\n    return (\n      <div className=\"source-viewer-measures source-viewer-measures-secondary js-all-measures\">\n        <div className=\"source-viewer-measures-section source-viewer-measures-section-big\">\n          {odd.map(domain => this.renderDomain(domain, domains[domain]))}\n        </div>\n        <div className=\"source-viewer-measures-section source-viewer-measures-section-big\">\n          {even.map(domain => this.renderDomain(domain, domains[domain]))}\n        </div>\n      </div>\n    );\n  };\n\n  render() {\n    const { branchLike, sourceViewerFile } = this.props;\n    const { loading } = this.state;\n\n    return (\n      <Modal contentLabel=\"\" large={true} onRequestClose={this.props.onClose}>\n        <div className=\"modal-container source-viewer-measures-modal\">\n          <div className=\"source-viewer-header-component source-viewer-measures-component\">\n            <div className=\"source-viewer-header-component-project\">\n              <QualifierIcon className=\"little-spacer-right\" qualifier=\"TRK\" />\n              <Link to={getBranchLikeUrl(sourceViewerFile.project, branchLike)}>\n                {sourceViewerFile.projectName}\n              </Link>\n\n              {sourceViewerFile.subProject && (\n                <>\n                  <QualifierIcon className=\"big-spacer-left little-spacer-right\" qualifier=\"BRC\" />\n                  <Link to={getBranchLikeUrl(sourceViewerFile.subProject, branchLike)}>\n                    {sourceViewerFile.subProjectName}\n                  </Link>\n                </>\n              )}\n            </div>\n\n            <div className=\"source-viewer-header-component-name\">\n              <QualifierIcon className=\"little-spacer-right\" qualifier={sourceViewerFile.q} />\n              {sourceViewerFile.path}\n            </div>\n          </div>\n\n          {loading ? (\n            <i className=\"spinner\" />\n          ) : (\n            <>\n              {sourceViewerFile.q === 'UTS' ? (\n                <>\n                  {this.renderTests()}\n                  <MeasuresOverlayTestCases\n                    branchLike={branchLike}\n                    componentKey={sourceViewerFile.key}\n                  />\n                </>\n              ) : (\n                <div className=\"source-viewer-measures\">\n                  {this.renderLines()}\n                  {this.renderIssues()}\n                  {this.renderCoverage()}\n                  {this.renderDuplications()}\n                </div>\n              )}\n            </>\n          )}\n\n          <div className=\"spacer-top\">\n            {this.state.showAllMeasures ? (\n              this.renderAllMeasures()\n            ) : (\n              <a className=\"js-show-all-measures\" href=\"#\" onClick={this.handleAllMeasuresClick}>\n                {translate('component_viewer.show_all_measures')}\n              </a>\n            )}\n          </div>\n        </div>\n\n        <footer className=\"modal-foot\">\n          <Button className=\"button-link\" onClick={this.props.onClose}>\n            {translate('close')}\n          </Button>\n        </footer>\n      </Modal>\n    );\n  }\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2018 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport { stringify } from 'querystring';\nimport * as React from 'react';\nimport { Link } from 'react-router';\nimport * as PropTypes from 'prop-types';\nimport MeasuresOverlay from './components/MeasuresOverlay';\nimport { SourceViewerFile, BranchLike } from '../../app/types';\nimport QualifierIcon from '../icons-components/QualifierIcon';\nimport Dropdown from '../controls/Dropdown';\nimport FavoriteContainer from '../controls/FavoriteContainer';\nimport ListIcon from '../icons-components/ListIcon';\nimport { ButtonIcon } from '../ui/buttons';\nimport { PopupPlacement } from '../ui/popups';\nimport { WorkspaceContext } from '../workspace/context';\nimport {\n  getPathUrlAsString,\n  getBranchLikeUrl,\n  getComponentIssuesUrl,\n  getBaseUrl\n} from '../../helpers/urls';\nimport { collapsedDirFromPath, fileFromPath } from '../../helpers/path';\nimport { translate } from '../../helpers/l10n';\nimport { getBranchLikeQuery, isMainBranch } from '../../helpers/branches';\nimport { formatMeasure } from '../../helpers/measures';\nimport { omitNil } from '../../helpers/request';\n\ninterface Props {\n  branchLike: BranchLike | undefined;\n  sourceViewerFile: SourceViewerFile;\n}\n\ninterface State {\n  measuresOverlay: boolean;\n}\n\nexport default class SourceViewerHeader extends React.PureComponent<Props, State> {\n  context!: { workspace: WorkspaceContext };\n\n  static contextTypes = {\n    workspace: PropTypes.object.isRequired\n  };\n\n  state: State = { measuresOverlay: false };\n\n  handleShowMeasuresClick = (event: React.SyntheticEvent<HTMLAnchorElement>) => {\n    event.preventDefault();\n    this.setState({ measuresOverlay: true });\n  };\n\n  handleMeasuresOverlayClose = () => {\n    this.setState({ measuresOverlay: false });\n  };\n\n  openInWorkspace = (event: React.SyntheticEvent<HTMLAnchorElement>) => {\n    event.preventDefault();\n    const { key } = this.props.sourceViewerFile;\n    this.context.workspace.openComponent({ branchLike: this.props.branchLike, key });\n  };\n\n  render() {\n    const {\n      key,\n      measures,\n      path,\n      project,\n      projectName,\n      q,\n      subProject,\n      subProjectName,\n      uuid\n    } = this.props.sourceViewerFile;\n    const isUnitTest = q === 'UTS';\n    const workspace = false;\n    const rawSourcesLink =\n      getBaseUrl() +\n      '/api/sources/raw?' +\n      stringify(omitNil({ key, ...getBranchLikeQuery(this.props.branchLike) }));\n\n    // TODO favorite\n    return (\n      <div className=\"source-viewer-header\">\n        <div className=\"source-viewer-header-component\">\n          <div className=\"component-name\">\n            <div className=\"component-name-parent\">\n              <a\n                className=\"link-with-icon\"\n                href={getPathUrlAsString(getBranchLikeUrl(project, this.props.branchLike))}>\n                <QualifierIcon qualifier=\"TRK\" /> <span>{projectName}</span>\n              </a>\n            </div>\n\n            {subProject != null && (\n              <div className=\"component-name-parent\">\n                <a\n                  className=\"link-with-icon\"\n                  href={getPathUrlAsString(getBranchLikeUrl(subProject, this.props.branchLike))}>\n                  <QualifierIcon qualifier=\"BRC\" /> <span>{subProjectName}</span>\n                </a>\n              </div>\n            )}\n\n            <div className=\"component-name-path\">\n              <QualifierIcon qualifier={q} /> <span>{collapsedDirFromPath(path)}</span>\n              <span className=\"component-name-file\">{fileFromPath(path)}</span>\n              {this.props.sourceViewerFile.canMarkAsFavorite &&\n                (!this.props.branchLike || isMainBranch(this.props.branchLike)) && (\n                  <FavoriteContainer className=\"component-name-favorite\" componentKey={key} />\n                )}\n            </div>\n          </div>\n        </div>\n\n        <Dropdown\n          className=\"source-viewer-header-actions\"\n          overlay={\n            <ul className=\"menu\">\n              <li>\n                <a className=\"js-measures\" href=\"#\" onClick={this.handleShowMeasuresClick}>\n                  {translate('component_viewer.show_details')}\n                </a>\n              </li>\n              <li>\n                <a\n                  className=\"js-new-window\"\n                  href={getPathUrlAsString({\n                    pathname: '/component',\n                    query: { id: key, ...getBranchLikeQuery(this.props.branchLike) }\n                  })}\n                  target=\"_blank\">\n                  {translate('component_viewer.new_window')}\n                </a>\n              </li>\n              {!workspace && (\n                <li>\n                  <a className=\"js-workspace\" href=\"#\" onClick={this.openInWorkspace}>\n                    {translate('component_viewer.open_in_workspace')}\n                  </a>\n                </li>\n              )}\n              <li>\n                <a className=\"js-raw-source\" href={rawSourcesLink} target=\"_blank\">\n                  {translate('component_viewer.show_raw_source')}\n                </a>\n              </li>\n            </ul>\n          }\n          overlayPlacement={PopupPlacement.BottomRight}>\n          <ButtonIcon className=\"js-actions\">\n            <ListIcon />\n          </ButtonIcon>\n        </Dropdown>\n\n        {this.state.measuresOverlay && (\n          <MeasuresOverlay\n            branchLike={this.props.branchLike}\n            onClose={this.handleMeasuresOverlayClose}\n            sourceViewerFile={this.props.sourceViewerFile}\n          />\n        )}\n\n        <div className=\"source-viewer-header-measures\">\n          {isUnitTest && (\n            <div className=\"source-viewer-header-measure\">\n              <span className=\"source-viewer-header-measure-value\">\n                {formatMeasure(measures.tests, 'SHORT_INT')}\n              </span>\n              <span className=\"source-viewer-header-measure-label\">\n                {translate('metric.tests.name')}\n              </span>\n            </div>\n          )}\n\n          {!isUnitTest && (\n            <div className=\"source-viewer-header-measure\">\n              <span className=\"source-viewer-header-measure-value\">\n                {formatMeasure(measures.lines, 'SHORT_INT')}\n              </span>\n              <span className=\"source-viewer-header-measure-label\">\n                {translate('metric.lines.name')}\n              </span>\n            </div>\n          )}\n\n          <div className=\"source-viewer-header-measure\">\n            <span className=\"source-viewer-header-measure-value\">\n              <Link\n                to={getComponentIssuesUrl(project, {\n                  resolved: 'false',\n                  fileUuids: uuid,\n                  ...getBranchLikeQuery(this.props.branchLike)\n                })}>\n                {measures.issues != null ? formatMeasure(measures.issues, 'SHORT_INT') : 0}\n              </Link>\n            </span>\n            <span className=\"source-viewer-header-measure-label\">\n              {translate('metric.violations.name')}\n            </span>\n          </div>\n\n          {measures.coverage != null && (\n            <div className=\"source-viewer-header-measure\">\n              <span className=\"source-viewer-header-measure-value\">\n                {formatMeasure(measures.coverage, 'PERCENT')}\n              </span>\n              <span className=\"source-viewer-header-measure-label\">\n                {translate('metric.coverage.name')}\n              </span>\n            </div>\n          )}\n\n          {measures.duplicationDensity != null && (\n            <div className=\"source-viewer-header-measure\">\n              <span className=\"source-viewer-header-measure-value\">\n                {formatMeasure(measures.duplicationDensity, 'PERCENT')}\n              </span>\n              <span className=\"source-viewer-header-measure-label\">\n                {translate('duplications')}\n              </span>\n            </div>\n          )}\n        </div>\n      </div>\n    );\n  }\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2018 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport { Link } from 'react-router';\nimport { BranchLike, SourceLine } from '../../../app/types';\nimport { DropdownOverlay } from '../../controls/Dropdown';\nimport { PopupPlacement } from '../../ui/popups';\nimport { translate } from '../../../helpers/l10n';\nimport { getBranchLikeQuery } from '../../../helpers/branches';\n\ninterface Props {\n  branchLike: BranchLike | undefined;\n  componentKey: string;\n  line: SourceLine;\n}\n\nexport default function LineOptionsPopup({ branchLike, componentKey, line }: Props) {\n  const permalink = {\n    pathname: '/component',\n    query: { id: componentKey, line: line.line, ...getBranchLikeQuery(branchLike) }\n  };\n  return (\n    <DropdownOverlay placement={PopupPlacement.RightTop}>\n      <div className=\"source-viewer-bubble-popup nowrap\">\n        <Link className=\"js-get-permalink\" to={permalink}>\n          {translate('component_viewer.get_permalink')}\n        </Link>\n      </div>\n    </DropdownOverlay>\n  );\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2018 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport LineOptionsPopup from './LineOptionsPopup';\nimport { BranchLike, SourceLine } from '../../../app/types';\nimport Toggler from '../../controls/Toggler';\n\ninterface Props {\n  branchLike: BranchLike | undefined;\n  componentKey: string;\n  line: SourceLine;\n  onPopupToggle: (x: { index?: number; line: number; name: string; open?: boolean }) => void;\n  popupOpen: boolean;\n}\n\nexport default class LineNumber extends React.PureComponent<Props> {\n  handleClick = (event: React.MouseEvent<HTMLElement>) => {\n    event.preventDefault();\n    event.stopPropagation();\n    event.currentTarget.blur();\n    this.props.onPopupToggle({ line: this.props.line.line, name: 'line-number' });\n  };\n\n  handleTogglePopup = (open: boolean) => {\n    this.props.onPopupToggle({ line: this.props.line.line, name: 'line-number', open });\n  };\n\n  closePopup = () => {\n    this.handleTogglePopup(false);\n  };\n\n  render() {\n    const { branchLike, componentKey, line, popupOpen } = this.props;\n    const { line: lineNumber } = line;\n    const hasLineNumber = !!lineNumber;\n    return hasLineNumber ? (\n      <td\n        className=\"source-meta source-line-number\"\n        data-line-number={lineNumber}\n        onClick={this.handleClick}\n        // eslint-disable-next-line jsx-a11y/no-noninteractive-element-to-interactive-role\n        role=\"button\"\n        tabIndex={0}>\n        <Toggler\n          onRequestClose={this.closePopup}\n          open={popupOpen}\n          overlay={\n            <LineOptionsPopup branchLike={branchLike} componentKey={componentKey} line={line} />\n          }\n        />\n      </td>\n    ) : (\n      <td className=\"source-meta source-line-number\" />\n    );\n  }\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2018 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport { SourceLine } from '../../../app/types';\nimport { DropdownOverlay } from '../../controls/Dropdown';\nimport DateFormatter from '../../intl/DateFormatter';\nimport { PopupPlacement } from '../../ui/popups';\n\ninterface Props {\n  line: SourceLine;\n}\n\nexport default function SCMPopup({ line }: Props) {\n  return (\n    <DropdownOverlay placement={PopupPlacement.RightTop}>\n      <div className=\"source-viewer-bubble-popup abs-width-400\">\n        <div>{line.scmAuthor}</div>\n        {line.scmDate && (\n          <div className=\"spacer-top\">\n            <DateFormatter date={line.scmDate} />\n          </div>\n        )}\n        {line.scmRevision && <div className=\"spacer-top\">{line.scmRevision}</div>}\n      </div>\n    </DropdownOverlay>\n  );\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2018 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport SCMPopup from './SCMPopup';\nimport { SourceLine } from '../../../app/types';\nimport Toggler from '../../controls/Toggler';\n\ninterface Props {\n  line: SourceLine;\n  onPopupToggle: (x: { index?: number; line: number; name: string; open?: boolean }) => void;\n  popupOpen: boolean;\n  previousLine: SourceLine | undefined;\n}\n\nexport default class LineSCM extends React.PureComponent<Props> {\n  handleClick = (event: React.MouseEvent<HTMLElement>) => {\n    event.preventDefault();\n    event.stopPropagation();\n    event.currentTarget.blur();\n    this.props.onPopupToggle({ line: this.props.line.line, name: 'scm' });\n  };\n\n  handleTogglePopup = (open: boolean) => {\n    this.props.onPopupToggle({ line: this.props.line.line, name: 'scm', open });\n  };\n\n  closePopup = () => {\n    this.handleTogglePopup(false);\n  };\n\n  render() {\n    const { line, popupOpen, previousLine } = this.props;\n    const hasPopup = !!line.line;\n    const cell = isSCMChanged(line, previousLine) && (\n      <div className=\"source-line-scm-inner\" data-author={line.scmAuthor} />\n    );\n    return hasPopup ? (\n      <td\n        className=\"source-meta source-line-scm\"\n        data-line-number={line.line}\n        onClick={this.handleClick}\n        // eslint-disable-next-line jsx-a11y/no-noninteractive-element-to-interactive-role\n        role=\"button\"\n        tabIndex={0}>\n        <Toggler\n          onRequestClose={this.closePopup}\n          open={popupOpen}\n          overlay={<SCMPopup line={line} />}>\n          {cell}\n        </Toggler>\n      </td>\n    ) : (\n      <td className=\"source-meta source-line-scm\" data-line-number={line.line}>\n        {cell}\n      </td>\n    );\n  }\n}\n\nfunction isSCMChanged(s: SourceLine, p: SourceLine | undefined) {\n  let changed = true;\n  if (p != null && s.scmAuthor != null && p.scmAuthor != null) {\n    changed = s.scmAuthor !== p.scmAuthor || s.scmDate !== p.scmDate;\n  }\n  return changed;\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2018 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport { groupBy } from 'lodash';\nimport * as PropTypes from 'prop-types';\nimport { getTests } from '../../../api/components';\nimport { BranchLike, SourceLine, TestCase } from '../../../app/types';\nimport { DropdownOverlay } from '../../controls/Dropdown';\nimport TestStatusIcon from '../../icons-components/TestStatusIcon';\nimport { PopupPlacement } from '../../ui/popups';\nimport { WorkspaceContext } from '../../workspace/context';\nimport { isSameBranchLike, getBranchLikeQuery } from '../../../helpers/branches';\nimport { translate } from '../../../helpers/l10n';\nimport { collapsePath } from '../../../helpers/path';\n\ninterface Props {\n  branchLike: BranchLike | undefined;\n  componentKey: string;\n  line: SourceLine;\n  onClose: () => void;\n}\n\ninterface State {\n  loading: boolean;\n  testCases: TestCase[];\n}\n\nexport default class CoveragePopup extends React.PureComponent<Props, State> {\n  context!: { workspace: WorkspaceContext };\n  mounted = false;\n\n  static contextTypes = {\n    workspace: PropTypes.object.isRequired\n  };\n\n  state: State = { loading: true, testCases: [] };\n\n  componentDidMount() {\n    this.mounted = true;\n    this.fetchTests();\n  }\n\n  componentDidUpdate(prevProps: Props) {\n    if (\n      !isSameBranchLike(prevProps.branchLike, this.props.branchLike) ||\n      prevProps.componentKey !== this.props.componentKey ||\n      prevProps.line.line !== this.props.line.line\n    ) {\n      this.fetchTests();\n    }\n  }\n\n  componentWillUnmount() {\n    this.mounted = false;\n  }\n\n  fetchTests = () => {\n    this.setState({ loading: true });\n    getTests({\n      sourceFileKey: this.props.componentKey,\n      sourceFileLineNumber: this.props.line.line,\n      ...getBranchLikeQuery(this.props.branchLike)\n    }).then(\n      testCases => {\n        if (this.mounted) {\n          this.setState({ loading: false, testCases });\n        }\n      },\n      () => {\n        if (this.mounted) {\n          this.setState({ loading: false });\n        }\n      }\n    );\n  };\n\n  handleTestClick = (event: React.MouseEvent<HTMLAnchorElement>) => {\n    event.preventDefault();\n    event.currentTarget.blur();\n    const { key } = event.currentTarget.dataset;\n    if (key) {\n      this.context.workspace.openComponent({ branchLike: this.props.branchLike, key });\n    }\n    this.props.onClose();\n  };\n\n  render() {\n    const { line } = this.props;\n    const testCasesByFile = groupBy(this.state.testCases || [], 'fileKey');\n    const testFiles = Object.keys(testCasesByFile).map(fileKey => {\n      const testSet = testCasesByFile[fileKey];\n      const test = testSet[0];\n      return {\n        file: { key: test.fileKey, longName: test.fileName },\n        tests: testSet\n      };\n    });\n\n    return (\n      <DropdownOverlay placement={PopupPlacement.RightTop}>\n        <div className=\"abs-width-400\">\n          <h6 className=\"spacer-bottom\">\n            {translate('source_viewer.covered')}\n            {!!line.conditions && (\n              <div>\n                {'('}\n                {line.coveredConditions || '0'}\n                {' of '}\n                {line.conditions} {translate('source_viewer.conditions')}\n                {')'}\n              </div>\n            )}\n          </h6>\n          {this.state.loading ? (\n            <i className=\"spinner\" />\n          ) : (\n            <>\n              {testFiles.length === 0 &&\n                translate('source_viewer.tooltip.no_information_about_tests')}\n              {testFiles.map(testFile => (\n                <div className=\"spacer-top text-ellipsis\" key={testFile.file.key}>\n                  <a\n                    data-key={testFile.file.key}\n                    href=\"#\"\n                    onClick={this.handleTestClick}\n                    title={testFile.file.longName}>\n                    <span>{collapsePath(testFile.file.longName)}</span>\n                  </a>\n                  <ul>\n                    {testFile.tests.map(testCase => (\n                      <li\n                        className=\"display-flex-center little-spacer-top\"\n                        key={testCase.id}\n                        title={testCase.name}>\n                        <TestStatusIcon className=\"spacer-right\" status={testCase.status} />\n                        <div className=\"display-inline-block text-ellipsis\">{testCase.name}</div>\n                        {testCase.status !== 'SKIPPED' && (\n                          <span className=\"spacer-left note\">{testCase.durationInMs}ms</span>\n                        )}\n                      </li>\n                    ))}\n                  </ul>\n                </div>\n              ))}\n            </>\n          )}\n        </div>\n      </DropdownOverlay>\n    );\n  }\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2018 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport CoveragePopup from './CoveragePopup';\nimport { BranchLike, SourceLine } from '../../../app/types';\nimport Tooltip from '../../controls/Tooltip';\nimport Toggler from '../../controls/Toggler';\nimport { translate } from '../../../helpers/l10n';\n\ninterface Props {\n  branchLike: BranchLike | undefined;\n  componentKey: string;\n  line: SourceLine;\n  onPopupToggle: (x: { index?: number; line: number; name: string; open?: boolean }) => void;\n  popupOpen: boolean;\n}\n\nexport default class LineCoverage extends React.PureComponent<Props> {\n  handleClick = (event: React.MouseEvent<HTMLElement>) => {\n    event.preventDefault();\n    event.stopPropagation();\n    event.currentTarget.blur();\n    this.props.onPopupToggle({ line: this.props.line.line, name: 'coverage' });\n  };\n\n  handleTogglePopup = (open: boolean) => {\n    this.props.onPopupToggle({ line: this.props.line.line, name: 'coverage', open });\n  };\n\n  closePopup = () => {\n    this.props.onPopupToggle({ line: this.props.line.line, name: 'coverage', open: false });\n  };\n\n  render() {\n    const { branchLike, componentKey, line, popupOpen } = this.props;\n\n    const className =\n      'source-meta source-line-coverage' +\n      (line.coverageStatus != null ? ` source-line-${line.coverageStatus}` : '');\n\n    const hasPopup =\n      line.coverageStatus === 'covered' || line.coverageStatus === 'partially-covered';\n\n    const cell = line.coverageStatus ? (\n      <Tooltip\n        overlay={popupOpen ? undefined : translate('source_viewer.tooltip', line.coverageStatus)}\n        placement=\"right\">\n        <div className=\"source-line-bar\" />\n      </Tooltip>\n    ) : (\n      <div className=\"source-line-bar\" />\n    );\n\n    if (hasPopup) {\n      return (\n        <td\n          className={className}\n          data-line-number={line.line}\n          onClick={this.handleClick}\n          // eslint-disable-next-line jsx-a11y/no-noninteractive-element-to-interactive-role\n          role=\"button\"\n          tabIndex={0}>\n          <Toggler\n            onRequestClose={this.closePopup}\n            open={popupOpen}\n            overlay={\n              <CoveragePopup\n                branchLike={branchLike}\n                componentKey={componentKey}\n                line={line}\n                onClose={this.closePopup}\n              />\n            }>\n            {cell}\n          </Toggler>\n        </td>\n      );\n    }\n\n    return (\n      <td className={className} data-line-number={line.line}>\n        {cell}\n      </td>\n    );\n  }\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2018 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport * as classNames from 'classnames';\nimport { SourceLine } from '../../../app/types';\nimport Tooltip from '../../controls/Tooltip';\nimport { translate } from '../../../helpers/l10n';\n\ninterface Props {\n  line: SourceLine;\n  onClick: (line: SourceLine) => void;\n}\n\nexport default class LineDuplications extends React.PureComponent<Props> {\n  handleClick = (event: React.MouseEvent<HTMLElement>) => {\n    event.preventDefault();\n    this.props.onClick(this.props.line);\n  };\n\n  render() {\n    const { line } = this.props;\n    const className = classNames('source-meta', 'source-line-duplications', {\n      'source-line-duplicated': line.duplicated\n    });\n\n    const cell = (\n      <td\n        className={className}\n        onClick={line.duplicated ? this.handleClick : undefined}\n        role={line.duplicated ? 'button' : undefined}\n        tabIndex={line.duplicated ? 0 : undefined}>\n        <div className=\"source-line-bar\" />\n      </td>\n    );\n\n    return line.duplicated ? (\n      <Tooltip overlay={translate('source_viewer.tooltip.duplicated_line')} placement=\"right\">\n        {cell}\n      </Tooltip>\n    ) : (\n      cell\n    );\n  }\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2018 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport * as classNames from 'classnames';\nimport { SourceLine } from '../../../app/types';\nimport Tooltip from '../../controls/Tooltip';\nimport Toggler from '../../controls/Toggler';\nimport { translate } from '../../../helpers/l10n';\n\ninterface Props {\n  duplicated: boolean;\n  index: number;\n  line: SourceLine;\n  onPopupToggle: (x: { index?: number; line: number; name: string; open?: boolean }) => void;\n  popupOpen: boolean;\n  renderDuplicationPopup: (index: number, line: number) => JSX.Element;\n}\n\nexport default class LineDuplicationBlock extends React.PureComponent<Props> {\n  handleClick = (event: React.MouseEvent<HTMLElement>) => {\n    event.preventDefault();\n    event.stopPropagation();\n    event.currentTarget.blur();\n    this.props.onPopupToggle({\n      index: this.props.index,\n      line: this.props.line.line,\n      name: 'duplications'\n    });\n  };\n\n  handleTogglePopup = (open: boolean) => {\n    this.props.onPopupToggle({\n      index: this.props.index,\n      line: this.props.line.line,\n      name: 'duplications',\n      open\n    });\n  };\n\n  closePopup = () => {\n    this.handleTogglePopup(false);\n  };\n\n  render() {\n    const { duplicated, index, line, popupOpen } = this.props;\n    const className = classNames('source-meta', 'source-line-duplications-extra', {\n      'source-line-duplicated': duplicated\n    });\n\n    const cell = <div className=\"source-line-bar\" />;\n\n    return duplicated ? (\n      <td\n        className={className}\n        data-index={index}\n        data-line-number={line.line}\n        onClick={this.handleClick}\n        // eslint-disable-next-line jsx-a11y/no-noninteractive-element-to-interactive-role\n        role=\"button\"\n        tabIndex={0}>\n        <Toggler\n          onRequestClose={this.closePopup}\n          open={popupOpen}\n          overlay={this.props.renderDuplicationPopup(index, line.line)}>\n          <Tooltip overlay={translate('source_viewer.tooltip.duplicated_block')} placement=\"right\">\n            {cell}\n          </Tooltip>\n        </Toggler>\n      </td>\n    ) : (\n      <td className={className} data-index={index} data-line-number={line.line}>\n        {cell}\n      </td>\n    );\n  }\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2018 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport * as classNames from 'classnames';\nimport SeverityIcon from '../../icons-components/SeverityIcon';\nimport { sortBySeverity } from '../../../helpers/issues';\nimport { Issue, SourceLine } from '../../../app/types';\n\ninterface Props {\n  issues: Issue[];\n  line: SourceLine;\n  onClick: () => void;\n}\n\nexport default class LineIssuesIndicator extends React.PureComponent<Props> {\n  handleClick = (event: React.MouseEvent<HTMLElement>) => {\n    event.preventDefault();\n    this.props.onClick();\n  };\n\n  render() {\n    const { issues, line } = this.props;\n    const hasIssues = issues.length > 0;\n    const className = classNames('source-meta', 'source-line-issues', {\n      'source-line-with-issues': hasIssues\n    });\n    const mostImportantIssue = hasIssues ? sortBySeverity(issues)[0] : null;\n\n    return (\n      <td\n        className={className}\n        data-line-number={line.line}\n        onClick={hasIssues ? this.handleClick : undefined}\n        role={hasIssues ? 'button' : undefined}\n        tabIndex={hasIssues ? 0 : undefined}>\n        {mostImportantIssue != null && <SeverityIcon severity={mostImportantIssue.severity} />}\n        {issues.length > 1 && <span className=\"source-line-issues-counter\">{issues.length}</span>}\n      </td>\n    );\n  }\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2018 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport { BranchLike, Issue as IssueType } from '../../../app/types';\nimport Issue from '../../issue/Issue';\n\ninterface Props {\n  branchLike: BranchLike | undefined;\n  displayIssueLocationsCount?: boolean;\n  displayIssueLocationsLink?: boolean;\n  issuePopup: { issue: string; name: string } | undefined;\n  issues: IssueType[];\n  onIssueChange: (issue: IssueType) => void;\n  onIssueClick: (issueKey: string) => void;\n  onIssuePopupToggle: (issue: string, popupName: string, open?: boolean) => void;\n  selectedIssue: string | undefined;\n}\n\nexport default function LineIssuesList(props: Props) {\n  const { issuePopup } = props;\n\n  return (\n    <div className=\"issue-list\">\n      {props.issues.map(issue => (\n        <Issue\n          branchLike={props.branchLike}\n          displayLocationsCount={props.displayIssueLocationsCount}\n          displayLocationsLink={props.displayIssueLocationsLink}\n          issue={issue}\n          key={issue.key}\n          onChange={props.onIssueChange}\n          onClick={props.onIssueClick}\n          onPopupToggle={props.onIssuePopupToggle}\n          openPopup={issuePopup && issuePopup.issue === issue.key ? issuePopup.name : undefined}\n          selected={props.selectedIssue === issue.key}\n        />\n      ))}\n    </div>\n  );\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2018 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport { uniq } from 'lodash';\nimport { LinearIssueLocation } from '../../../app/types';\n\nexport interface Token {\n  className: string;\n  markers: number[];\n  text: string;\n}\n\nconst ISSUE_LOCATION_CLASS = 'source-line-code-issue';\n\nexport function splitByTokens(code: string, rootClassName = ''): Token[] {\n  const container = document.createElement('div');\n  let tokens: Token[] = [];\n  container.innerHTML = code;\n  [].forEach.call(container.childNodes, (node: Element) => {\n    if (node.nodeType === 1) {\n      // ELEMENT NODE\n      const fullClassName = rootClassName ? rootClassName + ' ' + node.className : node.className;\n      const innerTokens = splitByTokens(node.innerHTML, fullClassName);\n      tokens = tokens.concat(innerTokens);\n    }\n    if (node.nodeType === 3 && node.nodeValue) {\n      // TEXT NODE\n      tokens.push({ className: rootClassName, markers: [], text: node.nodeValue });\n    }\n  });\n  return tokens;\n}\n\nexport function highlightSymbol(tokens: Token[], symbol: string): Token[] {\n  const symbolRegExp = new RegExp(`\\\\b${symbol}\\\\b`);\n  return tokens.map(\n    token =>\n      symbolRegExp.test(token.className)\n        ? { ...token, className: `${token.className} highlighted` }\n        : token\n  );\n}\n\n/**\n * Intersect two ranges\n * @param s1 Start position of the first range\n * @param e1 End position of the first range\n * @param s2 Start position of the second range\n * @param e2 End position of the second range\n */\nfunction intersect(s1: number, e1: number, s2: number, e2: number) {\n  return { from: Math.max(s1, s2), to: Math.min(e1, e2) };\n}\n\n/**\n * Get the substring of a string\n * @param str A string\n * @param from \"From\" offset\n * @param to \"To\" offset\n * @param acc Global offset to eliminate\n */\nfunction part(str: string, from: number, to: number, acc: number): string {\n  // we do not want negative number as the first argument of `substr`\n  return from >= acc ? str.substr(from - acc, to - from) : str.substr(0, to - from);\n}\n\n/**\n * Highlight issue locations in the list of tokens\n */\nexport function highlightIssueLocations(\n  tokens: Token[],\n  issueLocations: LinearIssueLocation[],\n  rootClassName: string = ISSUE_LOCATION_CLASS\n): Token[] {\n  issueLocations.forEach(location => {\n    const nextTokens: Token[] = [];\n    let acc = 0;\n    let markerAdded = location.line !== location.startLine;\n    tokens.forEach(token => {\n      const x = intersect(acc, acc + token.text.length, location.from, location.to);\n      const p1 = part(token.text, acc, x.from, acc);\n      const p2 = part(token.text, x.from, x.to, acc);\n      const p3 = part(token.text, x.to, acc + token.text.length, acc);\n      if (p1.length) {\n        nextTokens.push({ ...token, text: p1 });\n      }\n      if (p2.length) {\n        const newClassName =\n          token.className.indexOf(rootClassName) === -1\n            ? `${token.className} ${rootClassName}`\n            : token.className;\n        nextTokens.push({\n          className: newClassName,\n          markers:\n            !markerAdded && location.index != null\n              ? uniq([...token.markers, location.index])\n              : token.markers,\n          text: p2\n        });\n        markerAdded = true;\n      }\n      if (p3.length) {\n        nextTokens.push({ ...token, text: p3 });\n      }\n      acc += token.text.length;\n    });\n    tokens = nextTokens.slice();\n  });\n  return tokens;\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2018 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport * as classNames from 'classnames';\nimport LineIssuesList from './LineIssuesList';\nimport { BranchLike, Issue, LinearIssueLocation, SourceLine } from '../../../app/types';\nimport LocationIndex from '../../common/LocationIndex';\nimport LocationMessage from '../../common/LocationMessage';\nimport {\n  highlightIssueLocations,\n  highlightSymbol,\n  splitByTokens,\n  Token\n} from '../helpers/highlight';\n\ninterface Props {\n  branchLike: BranchLike | undefined;\n  displayIssueLocationsCount?: boolean;\n  displayIssueLocationsLink?: boolean;\n  displayLocationMarkers?: boolean;\n  highlightedLocationMessage: { index: number; text: string | undefined } | undefined;\n  highlightedSymbols: string[] | undefined;\n  issueLocations: LinearIssueLocation[];\n  issuePopup: { issue: string; name: string } | undefined;\n  issues: Issue[];\n  line: SourceLine;\n  onIssueChange: (issue: Issue) => void;\n  onIssuePopupToggle: (issue: string, popupName: string, open?: boolean) => void;\n  onIssueSelect: (issueKey: string) => void;\n  onLocationSelect: ((index: number) => void) | undefined;\n  onSymbolClick: (symbols: Array<string>) => void;\n  scroll?: (element: HTMLElement) => void;\n  secondaryIssueLocations: Array<{\n    from: number;\n    to: number;\n    line: number;\n    index: number;\n    startLine: number;\n  }>;\n  selectedIssue: string | undefined;\n  showIssues?: boolean;\n}\n\ninterface State {\n  tokens: Token[];\n}\n\nexport default class LineCode extends React.PureComponent<Props, State> {\n  activeMarkerNode?: HTMLElement | null;\n  codeNode?: HTMLElement | null;\n  symbols?: NodeListOf<HTMLElement>;\n\n  constructor(props: Props) {\n    super(props);\n    this.state = {\n      tokens: splitByTokens(props.line.code || '')\n    };\n  }\n\n  componentDidMount() {\n    this.attachEvents();\n    if (this.props.highlightedLocationMessage && this.activeMarkerNode && this.props.scroll) {\n      this.props.scroll(this.activeMarkerNode);\n    }\n  }\n\n  componentWillReceiveProps(nextProps: Props) {\n    if (nextProps.line.code !== this.props.line.code) {\n      this.setState({\n        tokens: splitByTokens(nextProps.line.code || '')\n      });\n    }\n  }\n\n  componentWillUpdate() {\n    this.detachEvents();\n  }\n\n  componentDidUpdate(prevProps: Props) {\n    this.attachEvents();\n    if (\n      this.props.highlightedLocationMessage &&\n      prevProps.highlightedLocationMessage !== this.props.highlightedLocationMessage &&\n      this.activeMarkerNode &&\n      this.props.scroll\n    ) {\n      this.props.scroll(this.activeMarkerNode);\n    }\n  }\n\n  componentWillUnmount() {\n    this.detachEvents();\n  }\n\n  attachEvents() {\n    if (this.codeNode) {\n      this.symbols = this.codeNode.querySelectorAll('.sym');\n      if (this.symbols) {\n        for (let i = 0; i < this.symbols.length; i++) {\n          const symbol = this.symbols[i];\n          symbol.addEventListener('click', this.handleSymbolClick);\n        }\n      }\n    }\n  }\n\n  detachEvents() {\n    if (this.symbols) {\n      for (let i = 0; i < this.symbols.length; i++) {\n        const symbol = this.symbols[i];\n        symbol.addEventListener('click', this.handleSymbolClick);\n      }\n    }\n  }\n\n  handleSymbolClick = (event: MouseEvent) => {\n    event.preventDefault();\n    const keys = (event.currentTarget as HTMLElement).className.match(/sym-\\d+/g);\n    if (keys && keys.length > 0) {\n      this.props.onSymbolClick(keys);\n    }\n  };\n\n  renderMarker(index: number, message: string | undefined, selected: boolean, leading: boolean) {\n    const { onLocationSelect } = this.props;\n    const onClick = onLocationSelect ? () => onLocationSelect(index) : undefined;\n    const ref = selected ? (node: HTMLElement | null) => (this.activeMarkerNode = node) : undefined;\n    return (\n      <LocationIndex\n        key={`marker-${index}`}\n        leading={leading}\n        onClick={onClick}\n        selected={selected}>\n        <span ref={ref}>{index + 1}</span>\n        {message && <LocationMessage selected={true}>{message}</LocationMessage>}\n      </LocationIndex>\n    );\n  }\n\n  render() {\n    const {\n      highlightedLocationMessage,\n      highlightedSymbols,\n      issues,\n      issueLocations,\n      line,\n      onIssueSelect,\n      secondaryIssueLocations,\n      selectedIssue,\n      showIssues\n    } = this.props;\n\n    let tokens = [...this.state.tokens];\n\n    if (highlightedSymbols) {\n      highlightedSymbols.forEach(symbol => {\n        tokens = highlightSymbol(tokens, symbol);\n      });\n    }\n\n    if (issueLocations.length > 0) {\n      tokens = highlightIssueLocations(tokens, issueLocations);\n    }\n\n    if (secondaryIssueLocations) {\n      tokens = highlightIssueLocations(tokens, secondaryIssueLocations, 'issue-location');\n\n      if (highlightedLocationMessage) {\n        const location = secondaryIssueLocations.find(\n          location => location.index === highlightedLocationMessage.index\n        );\n        if (location) {\n          tokens = highlightIssueLocations(tokens, [location], 'selected');\n        }\n      }\n    }\n\n    const className = classNames('source-line-code', 'code', {\n      'has-issues': issues.length > 0\n    });\n\n    const renderedTokens: React.ReactNode[] = [];\n\n    // track if the first marker is displayed before the source code\n    // set `false` for the first token in a row\n    let leadingMarker = false;\n\n    tokens.forEach((token, index) => {\n      if (this.props.displayLocationMarkers && token.markers.length > 0) {\n        token.markers.forEach(marker => {\n          const selected =\n            highlightedLocationMessage !== undefined && highlightedLocationMessage.index === marker;\n          const message = selected ? highlightedLocationMessage!.text : undefined;\n          renderedTokens.push(this.renderMarker(marker, message, selected, leadingMarker));\n        });\n      }\n      renderedTokens.push(\n        <span className={token.className} key={index}>\n          {token.text}\n        </span>\n      );\n\n      // keep leadingMarker truthy if previous token has only whitespaces\n      leadingMarker = (index === 0 ? true : leadingMarker) && !token.text.trim().length;\n    });\n\n    return (\n      <td className={className} data-line-number={line.line}>\n        <div className=\"source-line-code-inner\">\n          <pre ref={node => (this.codeNode = node)}>{renderedTokens}</pre>\n        </div>\n        {showIssues &&\n          issues.length > 0 && (\n            <LineIssuesList\n              branchLike={this.props.branchLike}\n              displayIssueLocationsCount={this.props.displayIssueLocationsCount}\n              displayIssueLocationsLink={this.props.displayIssueLocationsLink}\n              issuePopup={this.props.issuePopup}\n              issues={issues}\n              onIssueChange={this.props.onIssueChange}\n              onIssueClick={onIssueSelect}\n              onIssuePopupToggle={this.props.onIssuePopupToggle}\n              selectedIssue={selectedIssue}\n            />\n          )}\n      </td>\n    );\n  }\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2018 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport * as classNames from 'classnames';\nimport { times } from 'lodash';\nimport LineNumber from './LineNumber';\nimport LineSCM from './LineSCM';\nimport LineCoverage from './LineCoverage';\nimport LineDuplications from './LineDuplications';\nimport LineDuplicationBlock from './LineDuplicationBlock';\nimport LineIssuesIndicator from './LineIssuesIndicator';\nimport LineCode from './LineCode';\nimport { BranchLike, Issue, LinearIssueLocation, SourceLine } from '../../../app/types';\n\ninterface Props {\n  branchLike: BranchLike | undefined;\n  componentKey: string;\n  displayAllIssues?: boolean;\n  displayCoverage: boolean;\n  displayDuplications: boolean;\n  displayIssueLocationsCount?: boolean;\n  displayIssueLocationsLink?: boolean;\n  displayIssues: boolean;\n  displayLocationMarkers?: boolean;\n  duplications: number[];\n  duplicationsCount: number;\n  filtered: boolean | undefined;\n  highlighted: boolean;\n  highlightedLocationMessage: { index: number; text: string | undefined } | undefined;\n  highlightedSymbols: string[] | undefined;\n  issueLocations: LinearIssueLocation[];\n  issuePopup: { issue: string; name: string } | undefined;\n  issues: Issue[];\n  last: boolean;\n  line: SourceLine;\n  linePopup: { index?: number; line: number; name: string } | undefined;\n  loadDuplications: (line: SourceLine) => void;\n  onLinePopupToggle: (x: { index?: number; line: number; name: string; open?: boolean }) => void;\n  onIssueChange: (issue: Issue) => void;\n  onIssuePopupToggle: (issueKey: string, popupName: string, open?: boolean) => void;\n  onIssuesClose: (line: SourceLine) => void;\n  onIssueSelect: (issueKey: string) => void;\n  onIssuesOpen: (line: SourceLine) => void;\n  onIssueUnselect: () => void;\n  onLocationSelect: ((x: number) => void) | undefined;\n  onSymbolClick: (symbols: string[]) => void;\n  openIssues: boolean;\n  previousLine: SourceLine | undefined;\n  renderDuplicationPopup: (index: number, line: number) => JSX.Element;\n  scroll?: (element: HTMLElement) => void;\n  secondaryIssueLocations: Array<{\n    from: number;\n    to: number;\n    line: number;\n    index: number;\n    startLine: number;\n  }>;\n  selectedIssue: string | undefined;\n}\n\nexport default class Line extends React.PureComponent<Props> {\n  isPopupOpen = (name: string, index?: number) => {\n    const { line, linePopup } = this.props;\n    return (\n      linePopup !== undefined &&\n      linePopup.index === index &&\n      linePopup.line === line.line &&\n      linePopup.name === name\n    );\n  };\n\n  handleIssuesIndicatorClick = () => {\n    if (this.props.openIssues) {\n      this.props.onIssuesClose(this.props.line);\n      this.props.onIssueUnselect();\n    } else {\n      this.props.onIssuesOpen(this.props.line);\n\n      const { issues } = this.props;\n      if (issues.length > 0) {\n        this.props.onIssueSelect(issues[0].key);\n      }\n    }\n  };\n\n  render() {\n    const {\n      displayCoverage,\n      duplications,\n      duplicationsCount,\n      filtered,\n      issuePopup,\n      line\n    } = this.props;\n    const className = classNames('source-line', {\n      'source-line-highlighted': this.props.highlighted,\n      'source-line-filtered': filtered === true,\n      'source-line-filtered-dark':\n        displayCoverage &&\n        (line.coverageStatus === 'uncovered' || line.coverageStatus === 'partially-covered'),\n      'source-line-last': this.props.last\n    });\n\n    return (\n      <tr className={className} data-line-number={line.line}>\n        <LineNumber\n          branchLike={this.props.branchLike}\n          componentKey={this.props.componentKey}\n          line={line}\n          onPopupToggle={this.props.onLinePopupToggle}\n          popupOpen={this.isPopupOpen('line-number')}\n        />\n\n        <LineSCM\n          line={line}\n          onPopupToggle={this.props.onLinePopupToggle}\n          popupOpen={this.isPopupOpen('scm')}\n          previousLine={this.props.previousLine}\n        />\n\n        {this.props.displayCoverage && (\n          <LineCoverage\n            branchLike={this.props.branchLike}\n            componentKey={this.props.componentKey}\n            line={line}\n            onPopupToggle={this.props.onLinePopupToggle}\n            popupOpen={this.isPopupOpen('coverage')}\n          />\n        )}\n\n        {this.props.displayDuplications && (\n          <LineDuplications line={line} onClick={this.props.loadDuplications} />\n        )}\n\n        {times(duplicationsCount, index => (\n          <LineDuplicationBlock\n            duplicated={duplications.includes(index)}\n            index={index}\n            key={index}\n            line={this.props.line}\n            onPopupToggle={this.props.onLinePopupToggle}\n            popupOpen={this.isPopupOpen('duplications', index)}\n            renderDuplicationPopup={this.props.renderDuplicationPopup}\n          />\n        ))}\n\n        {this.props.displayIssues &&\n          !this.props.displayAllIssues && (\n            <LineIssuesIndicator\n              issues={this.props.issues}\n              line={line}\n              onClick={this.handleIssuesIndicatorClick}\n            />\n          )}\n\n        <LineCode\n          branchLike={this.props.branchLike}\n          displayIssueLocationsCount={this.props.displayIssueLocationsCount}\n          displayIssueLocationsLink={this.props.displayIssueLocationsLink}\n          displayLocationMarkers={this.props.displayLocationMarkers}\n          highlightedLocationMessage={this.props.highlightedLocationMessage}\n          highlightedSymbols={this.props.highlightedSymbols}\n          issueLocations={this.props.issueLocations}\n          issuePopup={issuePopup}\n          issues={this.props.issues}\n          line={line}\n          onIssueChange={this.props.onIssueChange}\n          onIssuePopupToggle={this.props.onIssuePopupToggle}\n          onIssueSelect={this.props.onIssueSelect}\n          onLocationSelect={this.props.onLocationSelect}\n          onSymbolClick={this.props.onSymbolClick}\n          scroll={this.props.scroll}\n          secondaryIssueLocations={this.props.secondaryIssueLocations}\n          selectedIssue={this.props.selectedIssue}\n          showIssues={this.props.openIssues || this.props.displayAllIssues}\n        />\n      </tr>\n    );\n  }\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2018 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport { LinearIssueLocation, TextRange } from '../../../app/types';\n\nexport function getLinearLocations(textRange: TextRange | undefined): LinearIssueLocation[] {\n  if (!textRange) {\n    return [];\n  }\n  const locations = [];\n\n  // go through all lines of the `textRange`\n  for (let line = textRange.startLine; line <= textRange.endLine; line++) {\n    // TODO fix 999999\n    const from = line === textRange.startLine ? textRange.startOffset : 0;\n    const to = line === textRange.endLine ? textRange.endOffset : 999999;\n    locations.push({ line, from, to });\n  }\n  return locations;\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2018 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport { intersection } from 'lodash';\nimport Line from './components/Line';\nimport { getLinearLocations } from './helpers/issueLocations';\nimport {\n  BranchLike,\n  Duplication,\n  FlowLocation,\n  Issue,\n  LinearIssueLocation,\n  SourceLine\n} from '../../app/types';\nimport { translate } from '../../helpers/l10n';\nimport { Button } from '../ui/buttons';\n\nconst EMPTY_ARRAY: any[] = [];\n\nconst ZERO_LINE = {\n  code: '',\n  duplicated: false,\n  line: 0\n};\n\ninterface Props {\n  branchLike: BranchLike | undefined;\n  componentKey: string;\n  displayAllIssues?: boolean;\n  displayIssueLocationsCount?: boolean;\n  displayIssueLocationsLink?: boolean;\n  displayLocationMarkers?: boolean;\n  duplications: Duplication[] | undefined;\n  duplicationsByLine: { [line: number]: number[] };\n  filterLine?: (line: SourceLine) => boolean;\n  hasSourcesAfter: boolean;\n  hasSourcesBefore: boolean;\n  highlightedLine: number | undefined;\n  highlightedLocationMessage: { index: number; text: string | undefined } | undefined;\n  // `undefined` elements mean they are located in a different file,\n  // but kept to maintain the location indexes\n  highlightedLocations: (FlowLocation | undefined)[] | undefined;\n  highlightedSymbols: string[];\n  issueLocationsByLine: { [line: number]: LinearIssueLocation[] };\n  issuePopup: { issue: string; name: string } | undefined;\n  issues: Issue[] | undefined;\n  issuesByLine: { [line: number]: Issue[] };\n  linePopup: { index?: number; line: number; name: string } | undefined;\n  loadDuplications: (line: SourceLine) => void;\n  loadingSourcesAfter: boolean;\n  loadingSourcesBefore: boolean;\n  loadSourcesAfter: () => void;\n  loadSourcesBefore: () => void;\n  onIssueChange: (issue: Issue) => void;\n  onIssuePopupToggle: (issue: string, popupName: string, open?: boolean) => void;\n  onIssuesClose: (line: SourceLine) => void;\n  onIssueSelect: (issueKey: string) => void;\n  onIssuesOpen: (line: SourceLine) => void;\n  onIssueUnselect: () => void;\n  onLinePopupToggle: (x: { index?: number; line: number; name: string; open?: boolean }) => void;\n  onLocationSelect: ((index: number) => void) | undefined;\n  onSymbolClick: (symbols: string[]) => void;\n  openIssuesByLine: { [line: number]: boolean };\n  renderDuplicationPopup: (index: number, line: number) => JSX.Element;\n  scroll?: (element: HTMLElement) => void;\n  selectedIssue: string | undefined;\n  sources: SourceLine[];\n  symbolsByLine: { [line: number]: string[] };\n}\n\nexport default class SourceViewerCode extends React.PureComponent<Props> {\n  getDuplicationsForLine = (line: SourceLine): number[] => {\n    return this.props.duplicationsByLine[line.line] || EMPTY_ARRAY;\n  };\n\n  getIssuesForLine = (line: SourceLine): Issue[] => {\n    return this.props.issuesByLine[line.line] || EMPTY_ARRAY;\n  };\n\n  getIssueLocationsForLine = (line: SourceLine): LinearIssueLocation[] => {\n    return this.props.issueLocationsByLine[line.line] || EMPTY_ARRAY;\n  };\n\n  getSecondaryIssueLocationsForLine = (line: SourceLine): LinearIssueLocation[] => {\n    const { highlightedLocations } = this.props;\n    if (!highlightedLocations) {\n      return EMPTY_ARRAY;\n    }\n    return highlightedLocations.reduce((locations, location, index) => {\n      const linearLocations: LinearIssueLocation[] = location\n        ? getLinearLocations(location.textRange)\n            .filter(l => l.line === line.line)\n            .map(l => ({ ...l, startLine: location.textRange.startLine, index }))\n        : [];\n      return [...locations, ...linearLocations];\n    }, []);\n  };\n\n  renderLine = ({\n    line,\n    index,\n    displayCoverage,\n    displayDuplications,\n    displayIssues\n  }: {\n    line: SourceLine;\n    index: number;\n    displayCoverage: boolean;\n    displayDuplications: boolean;\n    displayIssues: boolean;\n  }) => {\n    const { filterLine, highlightedLocationMessage, selectedIssue, sources } = this.props;\n    const filtered = filterLine && filterLine(line);\n\n    const secondaryIssueLocations = this.getSecondaryIssueLocationsForLine(line);\n\n    const duplicationsCount = this.props.duplications ? this.props.duplications.length : 0;\n\n    const issuesForLine = this.getIssuesForLine(line);\n\n    // for the following properties pass null if the line for sure is not impacted\n    const symbolsForLine = this.props.symbolsByLine[line.line] || [];\n    const { highlightedSymbols } = this.props;\n    let optimizedHighlightedSymbols: string[] | undefined = intersection(\n      symbolsForLine,\n      highlightedSymbols\n    );\n    if (!optimizedHighlightedSymbols.length) {\n      optimizedHighlightedSymbols = undefined;\n    }\n\n    const optimizedSelectedIssue =\n      selectedIssue !== undefined && issuesForLine.find(issue => issue.key === selectedIssue)\n        ? selectedIssue\n        : undefined;\n\n    const optimizedSecondaryIssueLocations =\n      secondaryIssueLocations.length > 0 ? secondaryIssueLocations : EMPTY_ARRAY;\n\n    const optimizedLocationMessage =\n      highlightedLocationMessage != null &&\n      optimizedSecondaryIssueLocations.some(\n        location => location.index === highlightedLocationMessage.index\n      )\n        ? highlightedLocationMessage\n        : undefined;\n\n    return (\n      <Line\n        branchLike={this.props.branchLike}\n        componentKey={this.props.componentKey}\n        displayAllIssues={this.props.displayAllIssues}\n        displayCoverage={displayCoverage}\n        displayDuplications={displayDuplications}\n        displayIssueLocationsCount={this.props.displayIssueLocationsCount}\n        displayIssueLocationsLink={this.props.displayIssueLocationsLink}\n        displayIssues={displayIssues}\n        displayLocationMarkers={this.props.displayLocationMarkers}\n        duplications={this.getDuplicationsForLine(line)}\n        duplicationsCount={duplicationsCount}\n        filtered={filtered}\n        highlighted={line.line === this.props.highlightedLine}\n        highlightedLocationMessage={optimizedLocationMessage}\n        highlightedSymbols={optimizedHighlightedSymbols}\n        issueLocations={this.getIssueLocationsForLine(line)}\n        issuePopup={this.props.issuePopup}\n        issues={issuesForLine}\n        key={line.line}\n        last={index === this.props.sources.length - 1 && !this.props.hasSourcesAfter}\n        line={line}\n        linePopup={this.props.linePopup}\n        loadDuplications={this.props.loadDuplications}\n        onIssueChange={this.props.onIssueChange}\n        onIssuePopupToggle={this.props.onIssuePopupToggle}\n        onIssueSelect={this.props.onIssueSelect}\n        onIssueUnselect={this.props.onIssueUnselect}\n        onIssuesClose={this.props.onIssuesClose}\n        onIssuesOpen={this.props.onIssuesOpen}\n        onLinePopupToggle={this.props.onLinePopupToggle}\n        onLocationSelect={this.props.onLocationSelect}\n        onSymbolClick={this.props.onSymbolClick}\n        openIssues={this.props.openIssuesByLine[line.line] || false}\n        previousLine={index > 0 ? sources[index - 1] : undefined}\n        renderDuplicationPopup={this.props.renderDuplicationPopup}\n        scroll={this.props.scroll}\n        secondaryIssueLocations={optimizedSecondaryIssueLocations}\n        selectedIssue={optimizedSelectedIssue}\n      />\n    );\n  };\n\n  render() {\n    const { issues = [], sources } = this.props;\n\n    const displayCoverage = sources.some(s => s.coverageStatus != null);\n    const displayDuplications = sources.some(s => !!s.duplicated);\n    const displayIssues = issues.length > 0;\n\n    const hasFileIssues = displayIssues && issues.some(issue => !issue.textRange);\n\n    return (\n      <div>\n        {this.props.hasSourcesBefore && (\n          <div className=\"source-viewer-more-code\">\n            {this.props.loadingSourcesBefore ? (\n              <div className=\"js-component-viewer-loading-before\">\n                <i className=\"spinner\" />\n                <span className=\"note spacer-left\">\n                  {translate('source_viewer.loading_more_code')}\n                </span>\n              </div>\n            ) : (\n              <Button\n                className=\"js-component-viewer-source-before\"\n                onClick={this.props.loadSourcesBefore}>\n                {translate('source_viewer.load_more_code')}\n              </Button>\n            )}\n          </div>\n        )}\n\n        <table className=\"source-table\">\n          <tbody>\n            {hasFileIssues &&\n              this.renderLine({\n                line: ZERO_LINE,\n                index: -1,\n                displayCoverage,\n                displayDuplications,\n                displayIssues\n              })}\n            {sources.map((line, index) =>\n              this.renderLine({ line, index, displayCoverage, displayDuplications, displayIssues })\n            )}\n          </tbody>\n        </table>\n\n        {this.props.hasSourcesAfter && (\n          <div className=\"source-viewer-more-code\">\n            {this.props.loadingSourcesAfter ? (\n              <div className=\"js-component-viewer-loading-after\">\n                <i className=\"spinner\" />\n                <span className=\"note spacer-left\">\n                  {translate('source_viewer.loading_more_code')}\n                </span>\n              </div>\n            ) : (\n              <Button\n                className=\"js-component-viewer-source-after\"\n                onClick={this.props.loadSourcesAfter}>\n                {translate('source_viewer.load_more_code')}\n              </Button>\n            )}\n          </div>\n        )}\n      </div>\n    );\n  }\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2018 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport { Link } from 'react-router';\nimport * as PropTypes from 'prop-types';\nimport { groupBy, sortBy } from 'lodash';\nimport { BranchLike, DuplicatedFile, DuplicationBlock, SourceViewerFile } from '../../../app/types';\nimport { DropdownOverlay } from '../../controls/Dropdown';\nimport QualifierIcon from '../../icons-components/QualifierIcon';\nimport { PopupPlacement } from '../../ui/popups';\nimport { WorkspaceContext } from '../../workspace/context';\nimport { translate } from '../../../helpers/l10n';\nimport { collapsedDirFromPath, fileFromPath } from '../../../helpers/path';\nimport { getProjectUrl } from '../../../helpers/urls';\n\ninterface Props {\n  blocks: DuplicationBlock[];\n  branchLike: BranchLike | undefined;\n  duplicatedFiles?: { [ref: string]: DuplicatedFile };\n  inRemovedComponent: boolean;\n  onClose: () => void;\n  popupPosition?: any;\n  sourceViewerFile: SourceViewerFile;\n}\n\nexport default class DuplicationPopup extends React.PureComponent<Props> {\n  context!: { workspace: WorkspaceContext };\n\n  static contextTypes = {\n    workspace: PropTypes.object.isRequired\n  };\n\n  isDifferentComponent = (\n    a: { project: string; subProject?: string },\n    b: { project: string; subProject?: string }\n  ) => {\n    return Boolean(a && b && (a.project !== b.project || a.subProject !== b.subProject));\n  };\n\n  handleFileClick = (event: React.MouseEvent<HTMLAnchorElement>) => {\n    event.preventDefault();\n    event.currentTarget.blur();\n    const { key, line } = event.currentTarget.dataset;\n    if (key) {\n      this.context.workspace.openComponent({\n        branchLike: this.props.branchLike,\n        key,\n        line: line ? Number(line) : undefined\n      });\n    }\n    this.props.onClose();\n  };\n\n  render() {\n    const { duplicatedFiles = {}, sourceViewerFile } = this.props;\n\n    const groupedBlocks = groupBy(this.props.blocks, '_ref');\n    let duplications = Object.keys(groupedBlocks).map(fileRef => {\n      return {\n        blocks: groupedBlocks[fileRef],\n        file: duplicatedFiles[fileRef]\n      };\n    });\n\n    // first duplications in the same file\n    // then duplications in the same sub-project\n    // then duplications in the same project\n    // then duplications in other projects\n    duplications = sortBy(\n      duplications,\n      d => d.file.projectName !== sourceViewerFile.projectName,\n      d => d.file.subProjectName !== sourceViewerFile.subProjectName,\n      d => d.file.key !== sourceViewerFile.key\n    );\n\n    return (\n      <DropdownOverlay placement={PopupPlacement.RightTop}>\n        <div className=\"source-viewer-bubble-popup abs-width-400\">\n          {this.props.inRemovedComponent && (\n            <div className=\"alert alert-warning\">\n              {translate('duplications.dups_found_on_deleted_resource')}\n            </div>\n          )}\n          {duplications.length > 0 && (\n            <>\n              <h6 className=\"spacer-bottom\">\n                {translate('component_viewer.transition.duplication')}\n              </h6>\n              {duplications.map(duplication => (\n                <div className=\"spacer-top text-ellipsis\" key={duplication.file.key}>\n                  <div className=\"component-name\">\n                    {this.isDifferentComponent(duplication.file, this.props.sourceViewerFile) && (\n                      <>\n                        <div className=\"component-name-parent\">\n                          <QualifierIcon className=\"little-spacer-right\" qualifier=\"TRK\" />\n                          <Link to={getProjectUrl(duplication.file.project)}>\n                            {duplication.file.projectName}\n                          </Link>\n                        </div>\n                        {duplication.file.subProject &&\n                          duplication.file.subProjectName && (\n                            <div className=\"component-name-parent\">\n                              <QualifierIcon className=\"little-spacer-right\" qualifier=\"BRC\" />\n                              <Link to={getProjectUrl(duplication.file.subProject)}>\n                                {duplication.file.subProjectName}\n                              </Link>\n                            </div>\n                          )}\n                      </>\n                    )}\n\n                    {duplication.file.key !== this.props.sourceViewerFile.key && (\n                      <div className=\"component-name-path\">\n                        <a\n                          className=\"link-action\"\n                          data-key={duplication.file.key}\n                          href=\"#\"\n                          onClick={this.handleFileClick}\n                          title={duplication.file.name}>\n                          <span>{collapsedDirFromPath(duplication.file.name)}</span>\n                          <span className=\"component-name-file\">\n                            {fileFromPath(duplication.file.name)}\n                          </span>\n                        </a>\n                      </div>\n                    )}\n\n                    <div className=\"component-name-path\">\n                      {'Lines: '}\n                      {duplication.blocks.map((block, index) => (\n                        <React.Fragment key={index}>\n                          <a\n                            data-key={duplication.file.key}\n                            data-line={block.from}\n                            href=\"#\"\n                            onClick={this.handleFileClick}>\n                            {block.from}\n                            {' – '}\n                            {block.from + block.size - 1}\n                          </a>\n                          {index < duplication.blocks.length - 1 && ', '}\n                        </React.Fragment>\n                      ))}\n                    </div>\n                  </div>\n                </div>\n              ))}\n            </>\n          )}\n        </div>\n      </DropdownOverlay>\n    );\n  }\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2018 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport { searchIssues } from '../../../api/issues';\nimport { BranchLike, Issue } from '../../../app/types';\nimport { getBranchLikeQuery } from '../../../helpers/branches';\nimport { parseIssueFromResponse } from '../../../helpers/issues';\nimport { RawQuery } from '../../../helpers/query';\n\n// maximum possible value\nconst PAGE_SIZE = 500;\n\nfunction buildQuery(component: string, branchLike: BranchLike | undefined) {\n  return {\n    additionalFields: '_all',\n    resolved: 'false',\n    componentKeys: component,\n    s: 'FILE_LINE',\n    ...getBranchLikeQuery(branchLike)\n  };\n}\n\nexport function loadPage(query: RawQuery, page: number, pageSize = PAGE_SIZE): Promise<Issue[]> {\n  return searchIssues({\n    ...query,\n    p: page,\n    ps: pageSize\n  }).then(r =>\n    r.issues.map(issue => parseIssueFromResponse(issue, r.components, r.users, r.rules))\n  );\n}\n\nexport function loadPageAndNext(\n  query: RawQuery,\n  toLine: number,\n  page: number,\n  pageSize = PAGE_SIZE\n): Promise<Issue[]> {\n  return loadPage(query, page).then(issues => {\n    if (issues.length === 0) {\n      return [];\n    }\n\n    const lastIssue = issues[issues.length - 1];\n\n    if (\n      (lastIssue.textRange != null && lastIssue.textRange.endLine > toLine) ||\n      issues.length < pageSize\n    ) {\n      return issues;\n    }\n\n    return loadPageAndNext(query, toLine, page + 1, pageSize).then(nextIssues => {\n      return [...issues, ...nextIssues];\n    });\n  });\n}\n\nexport default function loadIssues(\n  component: string,\n  _fromLine: number,\n  toLine: number,\n  branchLike: BranchLike | undefined\n): Promise<Issue[]> {\n  const query = buildQuery(component, branchLike);\n  return new Promise(resolve => {\n    loadPageAndNext(query, toLine, 1).then(issues => {\n      resolve(issues);\n    });\n  });\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2018 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport { flatten } from 'lodash';\nimport { splitByTokens } from './highlight';\nimport { getLinearLocations } from './issueLocations';\nimport { Duplication, Issue, LinearIssueLocation, SourceLine } from '../../../app/types';\n\nexport function issuesByLine(issues: Issue[]) {\n  const index: { [line: number]: Issue[] } = {};\n  issues.forEach(issue => {\n    const line = issue.textRange ? issue.textRange.endLine : 0;\n    if (!(line in index)) {\n      index[line] = [];\n    }\n    index[line].push(issue);\n  });\n  return index;\n}\n\nexport function locationsByLine(issues: Issue[]) {\n  const index: { [line: number]: LinearIssueLocation[] } = {};\n  issues.forEach(issue => {\n    getLinearLocations(issue.textRange).forEach(location => {\n      if (!(location.line in index)) {\n        index[location.line] = [];\n      }\n      index[location.line].push(location);\n    });\n  });\n  return index;\n}\n\nexport function duplicationsByLine(duplications: Duplication[] | undefined) {\n  if (duplications == null) {\n    return {};\n  }\n\n  const duplicationsByLine: { [line: number]: number[] } = {};\n\n  duplications.forEach(({ blocks }, duplicationIndex) => {\n    blocks.forEach(block => {\n      // eslint-disable-next-line no-underscore-dangle\n      if (block._ref === '1') {\n        for (let line = block.from; line < block.from + block.size; line++) {\n          if (!(line in duplicationsByLine)) {\n            duplicationsByLine[line] = [];\n          }\n          duplicationsByLine[line].push(duplicationIndex);\n        }\n      }\n    });\n  });\n\n  return duplicationsByLine;\n}\n\nexport function symbolsByLine(sources: SourceLine[]) {\n  const index: { [line: number]: string[] } = {};\n  sources.forEach(line => {\n    const tokens = splitByTokens(line.code || '');\n    const symbols = flatten(\n      tokens.map(token => {\n        const keys = token.className.match(/sym-\\d+/g);\n        return keys != null ? keys : [];\n      })\n    );\n    index[line.line] = symbols.filter(key => key);\n  });\n  return index;\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2018 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport * as React from 'react';\nimport * as classNames from 'classnames';\nimport { intersection, uniqBy } from 'lodash';\nimport SourceViewerHeader from './SourceViewerHeader';\nimport SourceViewerCode from './SourceViewerCode';\nimport DuplicationPopup from './components/DuplicationPopup';\nimport defaultLoadIssues from './helpers/loadIssues';\nimport getCoverageStatus from './helpers/getCoverageStatus';\nimport {\n  duplicationsByLine,\n  issuesByLine,\n  locationsByLine,\n  symbolsByLine\n} from './helpers/indexing';\nimport {\n  getComponentData,\n  getComponentForSourceViewer,\n  getDuplications,\n  getSources\n} from '../../api/components';\nimport {\n  BranchLike,\n  DuplicatedFile,\n  Duplication,\n  FlowLocation,\n  Issue,\n  LinearIssueLocation,\n  SourceLine,\n  SourceViewerFile\n} from '../../app/types';\nimport { isSameBranchLike, getBranchLikeQuery } from '../../helpers/branches';\nimport { parseDate } from '../../helpers/dates';\nimport { translate } from '../../helpers/l10n';\nimport './styles.css';\n\n// TODO react-virtualized\n\ninterface Props {\n  aroundLine?: number;\n  branchLike: BranchLike | undefined;\n  component: string;\n  displayAllIssues?: boolean;\n  displayIssueLocationsCount?: boolean;\n  displayIssueLocationsLink?: boolean;\n  displayLocationMarkers?: boolean;\n  highlightedLine?: number;\n  // `undefined` elements mean they are located in a different file,\n  // but kept to maintaint the location indexes\n  highlightedLocations?: (FlowLocation | undefined)[];\n  highlightedLocationMessage?: { index: number; text: string | undefined };\n  loadComponent?: (\n    component: string,\n    branchLike: BranchLike | undefined\n  ) => Promise<SourceViewerFile>;\n  loadIssues?: (\n    component: string,\n    from: number,\n    to: number,\n    branchLike: BranchLike | undefined\n  ) => Promise<Issue[]>;\n  loadSources?: (\n    component: string,\n    from: number,\n    to: number,\n    branchLike: BranchLike | undefined\n  ) => Promise<SourceLine[]>;\n  onLoaded?: (component: SourceViewerFile, sources: SourceLine[], issues: Issue[]) => void;\n  onLocationSelect?: (index: number) => void;\n  onIssueChange?: (issue: Issue) => void;\n  onIssueSelect?: (issueKey: string) => void;\n  onIssueUnselect?: () => void;\n  onReceiveComponent: (component: SourceViewerFile) => void;\n  scroll?: (element: HTMLElement) => void;\n  selectedIssue?: string;\n}\n\ninterface State {\n  component?: SourceViewerFile;\n  displayDuplications: boolean;\n  duplicatedFiles?: { [ref: string]: DuplicatedFile };\n  duplications?: Duplication[];\n  duplicationsByLine: { [line: number]: number[] };\n  hasSourcesAfter: boolean;\n  highlightedSymbols: string[];\n  issueLocationsByLine: { [line: number]: LinearIssueLocation[] };\n  issuePopup?: { issue: string; name: string };\n  issues?: Issue[];\n  issuesByLine: { [line: number]: Issue[] };\n  linePopup?: { index?: number; line: number; name: string };\n  loading: boolean;\n  loadingSourcesAfter: boolean;\n  loadingSourcesBefore: boolean;\n  notAccessible: boolean;\n  notExist: boolean;\n  openIssuesByLine: { [line: number]: boolean };\n  selectedIssue?: string;\n  sourceRemoved: boolean;\n  sources?: SourceLine[];\n  symbolsByLine: { [line: number]: string[] };\n}\n\nconst LINES = 500;\n\nexport default class SourceViewerBase extends React.PureComponent<Props, State> {\n  node?: HTMLElement | null;\n  mounted = false;\n\n  static defaultProps = {\n    displayAllIssues: false,\n    displayIssueLocationsCount: true,\n    displayIssueLocationsLink: true,\n    displayLocationMarkers: true\n  };\n\n  constructor(props: Props) {\n    super(props);\n\n    this.state = {\n      displayDuplications: false,\n      duplicationsByLine: {},\n      hasSourcesAfter: false,\n      highlightedSymbols: [],\n      issuesByLine: {},\n      issueLocationsByLine: {},\n      loading: true,\n      loadingSourcesAfter: false,\n      loadingSourcesBefore: false,\n      notAccessible: false,\n      notExist: false,\n      openIssuesByLine: {},\n      selectedIssue: props.selectedIssue,\n      sourceRemoved: false,\n      symbolsByLine: {}\n    };\n  }\n\n  componentDidMount() {\n    this.mounted = true;\n    this.fetchComponent();\n  }\n\n  componentWillReceiveProps(nextProps: Props) {\n    // if a component or a branch has changed,\n    // set `loading: true` immediately to avoid unwanted scrolling in `LineCode`\n    if (\n      nextProps.component !== this.props.component ||\n      !isSameBranchLike(nextProps.branchLike, this.props.branchLike)\n    ) {\n      this.setState({ loading: true });\n    }\n    if (\n      nextProps.onIssueSelect !== undefined &&\n      nextProps.selectedIssue !== this.props.selectedIssue\n    ) {\n      this.setState({ selectedIssue: nextProps.selectedIssue });\n    }\n  }\n\n  componentDidUpdate(prevProps: Props) {\n    if (\n      prevProps.component !== this.props.component ||\n      !isSameBranchLike(prevProps.branchLike, this.props.branchLike)\n    ) {\n      this.fetchComponent();\n    } else if (\n      this.props.aroundLine !== undefined &&\n      prevProps.aroundLine !== this.props.aroundLine &&\n      this.isLineOutsideOfRange(this.props.aroundLine)\n    ) {\n      this.fetchSources();\n    } else {\n      const { selectedIssue } = this.props;\n      const { issues } = this.state;\n      if (\n        selectedIssue !== undefined &&\n        issues !== undefined &&\n        issues.find(issue => issue.key === selectedIssue) === undefined\n      ) {\n        this.reloadIssues();\n      }\n    }\n  }\n\n  componentWillUnmount() {\n    this.mounted = false;\n  }\n\n  // react typings do not take `defaultProps` into account,\n  // so use these getters to get type-safe methods\n\n  get safeLoadComponent() {\n    return this.props.loadComponent || defaultLoadComponent;\n  }\n\n  get safeLoadIssues() {\n    return this.props.loadIssues || defaultLoadIssues;\n  }\n\n  get safeLoadSources() {\n    return this.props.loadSources || defaultLoadSources;\n  }\n\n  computeCoverageStatus(lines: SourceLine[]) {\n    return lines.map(line => ({ ...line, coverageStatus: getCoverageStatus(line) }));\n  }\n\n  isLineOutsideOfRange(lineNumber: number) {\n    const { sources } = this.state;\n    if (sources && sources.length > 0) {\n      const firstLine = sources[0];\n      const lastList = sources[sources.length - 1];\n      return lineNumber < firstLine.line || lineNumber > lastList.line;\n    } else {\n      return true;\n    }\n  }\n\n  fetchComponent() {\n    this.setState({ loading: true });\n    const loadIssues = (component: SourceViewerFile, sources: SourceLine[]) => {\n      this.safeLoadIssues(this.props.component, 1, LINES, this.props.branchLike).then(\n        issues => {\n          if (this.mounted) {\n            const finalSources = sources.slice(0, LINES);\n\n            this.setState(\n              {\n                component,\n                displayDuplications: false,\n                duplicatedFiles: undefined,\n                duplications: undefined,\n                duplicationsByLine: {},\n                hasSourcesAfter: sources.length > LINES,\n                highlightedSymbols: [],\n                issueLocationsByLine: locationsByLine(issues),\n                issues,\n                issuesByLine: issuesByLine(issues),\n                linePopup: undefined,\n                loading: false,\n                notAccessible: false,\n                notExist: false,\n                openIssuesByLine: {},\n                issuePopup: undefined,\n                sourceRemoved: false,\n                sources: this.computeCoverageStatus(finalSources),\n                symbolsByLine: symbolsByLine(sources.slice(0, LINES))\n              },\n              () => {\n                if (this.props.onLoaded) {\n                  this.props.onLoaded(component, finalSources, issues);\n                }\n              }\n            );\n          }\n        },\n        () => {\n          // TODO\n        }\n      );\n    };\n\n    const onFailLoadComponent = ({ response }: { response: Response }) => {\n      // TODO handle other statuses\n      if (this.mounted) {\n        if (response.status === 403) {\n          this.setState({ loading: false, notAccessible: true });\n        } else if (response.status === 404) {\n          this.setState({ loading: false, notExist: true });\n        }\n      }\n    };\n\n    const onFailLoadSources = (response: Response, component: SourceViewerFile) => {\n      // TODO handle other statuses\n      if (this.mounted) {\n        if (response.status === 403) {\n          this.setState({ component, loading: false, notAccessible: true });\n        } else if (response.status === 404) {\n          this.setState({ component, loading: false, sourceRemoved: true });\n        }\n      }\n    };\n\n    const onResolve = (component: SourceViewerFile) => {\n      this.props.onReceiveComponent(component);\n      const sourcesRequest =\n        component.q === 'FIL' || component.q === 'UTS' ? this.loadSources() : Promise.resolve([]);\n      sourcesRequest.then(\n        sources => loadIssues(component, sources),\n        response => onFailLoadSources(response, component)\n      );\n    };\n\n    this.safeLoadComponent(this.props.component, this.props.branchLike).then(\n      onResolve,\n      onFailLoadComponent\n    );\n  }\n\n  fetchSources() {\n    this.loadSources().then(\n      sources => {\n        if (this.mounted) {\n          const finalSources = sources.slice(0, LINES);\n          this.setState(\n            {\n              sources: sources.slice(0, LINES),\n              hasSourcesAfter: sources.length > LINES\n            },\n            () => {\n              if (this.props.onLoaded && this.state.component && this.state.issues) {\n                this.props.onLoaded(this.state.component, finalSources, this.state.issues);\n              }\n            }\n          );\n        }\n      },\n      () => {\n        // TODO\n      }\n    );\n  }\n\n  reloadIssues() {\n    if (!this.state.sources) {\n      return;\n    }\n    const firstSourceLine = this.state.sources[0];\n    const lastSourceLine = this.state.sources[this.state.sources.length - 1];\n    this.safeLoadIssues(\n      this.props.component,\n      firstSourceLine && firstSourceLine.line,\n      lastSourceLine && lastSourceLine.line,\n      this.props.branchLike\n    ).then(\n      issues => {\n        if (this.mounted) {\n          this.setState({\n            issues,\n            issuesByLine: issuesByLine(issues),\n            issueLocationsByLine: locationsByLine(issues)\n          });\n        }\n      },\n      () => {\n        // TODO\n      }\n    );\n  }\n\n  loadSources = (): Promise<SourceLine[]> => {\n    return new Promise((resolve, reject) => {\n      const onFailLoadSources = ({ response }: { response: Response }) => {\n        // TODO handle other statuses\n        if (this.mounted) {\n          if ([403, 404].includes(response.status)) {\n            reject(response);\n          } else {\n            resolve([]);\n          }\n        }\n      };\n\n      const from = this.props.aroundLine ? Math.max(1, this.props.aroundLine - LINES / 2 + 1) : 1;\n\n      let to = this.props.aroundLine ? this.props.aroundLine + LINES / 2 + 1 : LINES + 1;\n      // make sure we try to download `LINES` lines\n      if (from === 1 && to < LINES) {\n        to = LINES;\n      }\n      // request one additional line to define `hasSourcesAfter`\n      to++;\n\n      return this.safeLoadSources(this.props.component, from, to, this.props.branchLike).then(\n        sources => resolve(sources),\n        onFailLoadSources\n      );\n    });\n  };\n\n  loadSourcesBefore = () => {\n    if (!this.state.sources) {\n      return;\n    }\n    const firstSourceLine = this.state.sources[0];\n    this.setState({ loadingSourcesBefore: true });\n    const from = Math.max(1, firstSourceLine.line - LINES);\n    this.safeLoadSources(\n      this.props.component,\n      from,\n      firstSourceLine.line - 1,\n      this.props.branchLike\n    ).then(\n      sources => {\n        this.safeLoadIssues(\n          this.props.component,\n          from,\n          firstSourceLine.line - 1,\n          this.props.branchLike\n        ).then(\n          issues => {\n            if (this.mounted) {\n              this.setState(prevState => {\n                const nextIssues = uniqBy(\n                  [...issues, ...(prevState.issues || [])],\n                  issue => issue.key\n                );\n                return {\n                  issues: nextIssues,\n                  issuesByLine: issuesByLine(nextIssues),\n                  issueLocationsByLine: locationsByLine(nextIssues),\n                  loadingSourcesBefore: false,\n                  sources: [...this.computeCoverageStatus(sources), ...(prevState.sources || [])],\n                  symbolsByLine: { ...prevState.symbolsByLine, ...symbolsByLine(sources) }\n                };\n              });\n            }\n          },\n          () => {\n            // TODO\n          }\n        );\n      },\n      () => {\n        // TODO\n      }\n    );\n  };\n\n  loadSourcesAfter = () => {\n    if (!this.state.sources) {\n      return;\n    }\n    const lastSourceLine = this.state.sources[this.state.sources.length - 1];\n    this.setState({ loadingSourcesAfter: true });\n    const fromLine = lastSourceLine.line + 1;\n    // request one additional line to define `hasSourcesAfter`\n    const toLine = lastSourceLine.line + LINES + 1;\n    this.safeLoadSources(this.props.component, fromLine, toLine, this.props.branchLike).then(\n      sources => {\n        this.safeLoadIssues(this.props.component, fromLine, toLine, this.props.branchLike).then(\n          issues => {\n            if (this.mounted) {\n              this.setState(prevState => {\n                const nextIssues = uniqBy(\n                  [...(prevState.issues || []), ...issues],\n                  issue => issue.key\n                );\n                return {\n                  issues: nextIssues,\n                  issuesByLine: issuesByLine(nextIssues),\n                  issueLocationsByLine: locationsByLine(nextIssues),\n                  hasSourcesAfter: sources.length > LINES,\n                  loadingSourcesAfter: false,\n                  sources: [\n                    ...(prevState.sources || []),\n                    ...this.computeCoverageStatus(sources.slice(0, LINES))\n                  ],\n                  symbolsByLine: {\n                    ...prevState.symbolsByLine,\n                    ...symbolsByLine(sources.slice(0, LINES))\n                  }\n                };\n              });\n            }\n          },\n          () => {\n            // TODO\n          }\n        );\n      },\n      () => {\n        // TODO\n      }\n    );\n  };\n\n  loadDuplications = (line: SourceLine) => {\n    getDuplications({\n      key: this.props.component,\n      ...getBranchLikeQuery(this.props.branchLike)\n    }).then(\n      r => {\n        if (this.mounted) {\n          this.setState(() => {\n            const changes: Partial<State> = {\n              displayDuplications: true,\n              duplications: r.duplications,\n              duplicationsByLine: duplicationsByLine(r.duplications),\n              duplicatedFiles: r.files\n            };\n            if (r.duplications.length === 1) {\n              changes.linePopup = { index: 0, line: line.line, name: 'duplications' };\n            }\n            return changes;\n          });\n        }\n      },\n      () => {\n        // TODO\n      }\n    );\n  };\n\n  handleLinePopupToggle = ({\n    index,\n    line,\n    name,\n    open\n  }: {\n    index?: number;\n    line: number;\n    name: string;\n    open?: boolean;\n  }) => {\n    this.setState((state: State) => {\n      const samePopup =\n        state.linePopup !== undefined &&\n        state.linePopup.name === name &&\n        state.linePopup.line === line &&\n        state.linePopup.index === index;\n      if (open !== false && !samePopup) {\n        return { linePopup: { index, line, name } };\n      } else if (open !== true && samePopup) {\n        return { linePopup: undefined };\n      }\n      return null;\n    });\n  };\n\n  closeLinePopup = () => {\n    this.setState({ linePopup: undefined });\n  };\n\n  handleIssuePopupToggle = (issue: string, popupName: string, open?: boolean) => {\n    this.setState((state: State) => {\n      const samePopup =\n        state.issuePopup && state.issuePopup.name === popupName && state.issuePopup.issue === issue;\n      if (open !== false && !samePopup) {\n        return { issuePopup: { issue, name: popupName } };\n      } else if (open !== true && samePopup) {\n        return { issuePopup: undefined };\n      }\n      return null;\n    });\n  };\n\n  handleSymbolClick = (symbols: string[]) => {\n    this.setState(state => {\n      const shouldDisable = intersection(state.highlightedSymbols, symbols).length > 0;\n      const highlightedSymbols = shouldDisable ? [] : symbols;\n      return { highlightedSymbols };\n    });\n  };\n\n  handleIssueSelect = (issue: string) => {\n    if (this.props.onIssueSelect) {\n      this.props.onIssueSelect(issue);\n    } else {\n      this.setState({ selectedIssue: issue });\n    }\n  };\n\n  handleIssueUnselect = () => {\n    if (this.props.onIssueUnselect) {\n      this.props.onIssueUnselect();\n    } else {\n      this.setState({ selectedIssue: undefined });\n    }\n  };\n\n  handleOpenIssues = (line: SourceLine) => {\n    this.setState(state => ({\n      openIssuesByLine: { ...state.openIssuesByLine, [line.line]: true }\n    }));\n  };\n\n  handleCloseIssues = (line: SourceLine) => {\n    this.setState(state => ({\n      openIssuesByLine: { ...state.openIssuesByLine, [line.line]: false }\n    }));\n  };\n\n  handleIssueChange = (issue: Issue) => {\n    this.setState(({ issues = [] }) => {\n      const newIssues = issues.map(candidate => (candidate.key === issue.key ? issue : candidate));\n      return { issues: newIssues, issuesByLine: issuesByLine(newIssues) };\n    });\n    if (this.props.onIssueChange) {\n      this.props.onIssueChange(issue);\n    }\n  };\n\n  handleFilterLine = (line: SourceLine) => {\n    const { component } = this.state;\n    const leakPeriodDate = component && component.leakPeriodDate;\n    return leakPeriodDate\n      ? line.scmDate !== undefined && parseDate(line.scmDate) > parseDate(leakPeriodDate)\n      : false;\n  };\n\n  renderDuplicationPopup = (index: number, line: number) => {\n    const { component, duplicatedFiles, duplications } = this.state;\n\n    if (!component || !duplicatedFiles) return <></>;\n\n    const duplication = duplications && duplications[index];\n    let blocks = (duplication && duplication.blocks) || [];\n    /* eslint-disable no-underscore-dangle */\n    const inRemovedComponent = blocks.some(b => b._ref === undefined);\n    let foundOne = false;\n    blocks = blocks.filter(b => {\n      const outOfBounds = b.from > line || b.from + b.size < line;\n      const currentFile = b._ref === '1';\n      const shouldDisplayForCurrentFile = outOfBounds || foundOne;\n      const shouldDisplay = !currentFile || shouldDisplayForCurrentFile;\n      const isOk = b._ref !== undefined && shouldDisplay;\n      if (b._ref === '1' && !outOfBounds) {\n        foundOne = true;\n      }\n      return isOk;\n    });\n    /* eslint-enable no-underscore-dangle */\n\n    return (\n      <DuplicationPopup\n        blocks={blocks}\n        branchLike={this.props.branchLike}\n        duplicatedFiles={duplicatedFiles}\n        inRemovedComponent={inRemovedComponent}\n        onClose={this.closeLinePopup}\n        sourceViewerFile={component}\n      />\n    );\n  };\n\n  renderCode(sources: SourceLine[]) {\n    const hasSourcesBefore = sources.length > 0 && sources[0].line > 1;\n    return (\n      <SourceViewerCode\n        branchLike={this.props.branchLike}\n        componentKey={this.props.component}\n        displayAllIssues={this.props.displayAllIssues}\n        displayIssueLocationsCount={this.props.displayIssueLocationsCount}\n        displayIssueLocationsLink={this.props.displayIssueLocationsLink}\n        displayLocationMarkers={this.props.displayLocationMarkers}\n        duplications={this.state.duplications}\n        duplicationsByLine={this.state.duplicationsByLine}\n        filterLine={this.handleFilterLine}\n        hasSourcesAfter={this.state.hasSourcesAfter}\n        hasSourcesBefore={hasSourcesBefore}\n        highlightedLine={this.props.highlightedLine}\n        highlightedLocationMessage={this.props.highlightedLocationMessage}\n        highlightedLocations={this.props.highlightedLocations}\n        highlightedSymbols={this.state.highlightedSymbols}\n        issueLocationsByLine={this.state.issueLocationsByLine}\n        issuePopup={this.state.issuePopup}\n        issues={this.state.issues}\n        issuesByLine={this.state.issuesByLine}\n        linePopup={this.state.linePopup}\n        loadDuplications={this.loadDuplications}\n        loadSourcesAfter={this.loadSourcesAfter}\n        loadSourcesBefore={this.loadSourcesBefore}\n        loadingSourcesAfter={this.state.loadingSourcesAfter}\n        loadingSourcesBefore={this.state.loadingSourcesBefore}\n        onIssueChange={this.handleIssueChange}\n        onIssuePopupToggle={this.handleIssuePopupToggle}\n        onIssueSelect={this.handleIssueSelect}\n        onIssueUnselect={this.handleIssueUnselect}\n        onIssuesClose={this.handleCloseIssues}\n        onIssuesOpen={this.handleOpenIssues}\n        onLinePopupToggle={this.handleLinePopupToggle}\n        onLocationSelect={this.props.onLocationSelect}\n        onSymbolClick={this.handleSymbolClick}\n        openIssuesByLine={this.state.openIssuesByLine}\n        renderDuplicationPopup={this.renderDuplicationPopup}\n        scroll={this.props.scroll}\n        selectedIssue={this.state.selectedIssue}\n        sources={sources}\n        symbolsByLine={this.state.symbolsByLine}\n      />\n    );\n  }\n\n  render() {\n    const { component, loading, sources, notAccessible, sourceRemoved } = this.state;\n\n    if (loading) {\n      return null;\n    }\n\n    if (this.state.notExist) {\n      return (\n        <div className=\"alert alert-warning spacer-top\">\n          {translate('component_viewer.no_component')}\n        </div>\n      );\n    }\n\n    if (notAccessible) {\n      return (\n        <div className=\"alert alert-warning spacer-top\">\n          {translate('code_viewer.no_source_code_displayed_due_to_security')}\n        </div>\n      );\n    }\n\n    if (!component) {\n      return null;\n    }\n\n    const className = classNames('source-viewer', {\n      'source-duplications-expanded': this.state.displayDuplications\n    });\n\n    return (\n      <div className={className} ref={node => (this.node = node)}>\n        {this.state.component && (\n          <SourceViewerHeader\n            branchLike={this.props.branchLike}\n            sourceViewerFile={this.state.component}\n          />\n        )}\n        {sourceRemoved && (\n          <div className=\"alert alert-warning spacer-top\">\n            {translate('code_viewer.no_source_code_displayed_due_to_source_removed')}\n          </div>\n        )}\n        {!sourceRemoved && sources !== undefined && this.renderCode(sources)}\n      </div>\n    );\n  }\n}\n\nfunction defaultLoadComponent(key: string, branchLike: BranchLike | undefined) {\n  return Promise.all([\n    getComponentForSourceViewer({ component: key, ...getBranchLikeQuery(branchLike) }),\n    getComponentData({ component: key, ...getBranchLikeQuery(branchLike) })\n  ]).then(([component, data]) => ({\n    ...component,\n    leakPeriodDate: data.leakPeriodDate && parseDate(data.leakPeriodDate)\n  }));\n}\n\nfunction defaultLoadSources(\n  key: string,\n  from: number | undefined,\n  to: number | undefined,\n  branchLike: BranchLike | undefined\n) {\n  return getSources({ key, from, to, ...getBranchLikeQuery(branchLike) });\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2018 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport { SourceLine } from '../../../app/types';\n\nexport default function getCoverageStatus(s: SourceLine): string | undefined {\n  let status: string | undefined;\n  if (s.lineHits != null && s.lineHits > 0) {\n    status = 'partially-covered';\n  }\n  if (s.lineHits != null && s.lineHits > 0 && s.conditions === s.coveredConditions) {\n    status = 'covered';\n  }\n  if (s.lineHits === 0 || s.coveredConditions === 0) {\n    status = 'uncovered';\n  }\n  return status;\n}\n","/*\n * SonarQube\n * Copyright (C) 2009-2018 SonarSource SA\n * mailto:info AT sonarsource DOT com\n *\n * This program is free software; you can redistribute it and/or\n * modify it under the terms of the GNU Lesser General Public\n * License as published by the Free Software Foundation; either\n * version 3 of the License, or (at your option) any later version.\n *\n * This program is distributed in the hope that it will be useful,\n * but WITHOUT ANY WARRANTY; without even the implied warranty of\n * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU\n * Lesser General Public License for more details.\n *\n * You should have received a copy of the GNU Lesser General Public License\n * along with this program; if not, write to the Free Software Foundation,\n * Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.\n */\nimport { Dispatch } from 'redux';\nimport { connect } from 'react-redux';\nimport SourceViewerBase from './SourceViewerBase';\nimport { SourceViewerFile } from '../../app/types';\nimport { receiveFavorites } from '../../store/favorites/duck';\n\nconst mapStateToProps = null;\n\ninterface DispatchProps {\n  onReceiveComponent: (component: SourceViewerFile) => void;\n}\n\nconst onReceiveComponent = (component: SourceViewerFile) => (dispatch: Dispatch<any>) => {\n  if (component.canMarkAsFavorite) {\n    const favorites = [];\n    const notFavorites = [];\n    if (component.fav) {\n      favorites.push({ key: component.key });\n    } else {\n      notFavorites.push({ key: component.key });\n    }\n    dispatch(receiveFavorites(favorites, notFavorites));\n  }\n};\n\nconst mapDispatchToProps: DispatchProps = { onReceiveComponent };\n\nexport default connect(mapStateToProps, mapDispatchToProps)(SourceViewerBase);\n"],"sourceRoot":""}