(window.webpackJsonp=window.webpackJsonp||[]).push([[321],{1084:function(e,t,n){"use strict";n.d(t,"a",function(){return s});var o=n(0),r=n(2),i=n(1);n(1138);function s(e){var t=e.organization;return o.createElement("div",{className:"boxed-group boxed-group-inner upgrade-organization-box"},o.createElement("h3",{className:"spacer-bottom"},Object(i.l)("billing.upgrade_box.header")),o.createElement("p",null,Object(i.l)("billing.upgrade_box.text")),Object(i.i)("billing.upgrade_box.button")&&o.createElement("div",{className:"big-spacer-top"},o.createElement(r.Link,{className:"button",to:{pathname:"organizations/"+t+"/extension/billing/billing",query:{page:"upgrade"}}},Object(i.l)("billing.upgrade_box.button"))))}},1135:function(e,t,n){"use strict";var o,r=n(0),i=n(7),s=n(1),a=(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),p=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.handlePublicClick=function(e){e.preventDefault(),e.currentTarget.blur(),t.props.onChange("public")},t.handlePrivateClick=function(e){e.preventDefault(),e.currentTarget.blur(),t.props.onChange("private")},t}return a(t,e),t.prototype.render=function(){return r.createElement("div",{className:this.props.className},r.createElement("a",{className:"link-base-color link-no-underline",id:"visibility-public",href:"#",onClick:this.handlePublicClick},r.createElement("i",{className:i("icon-radio",{"is-checked":"public"===this.props.visibility})}),r.createElement("span",{className:"spacer-left"},Object(s.l)("visibility.public"))),this.props.canTurnToPrivate?r.createElement("a",{className:"link-base-color link-no-underline huge-spacer-left",id:"visibility-private",href:"#",onClick:this.handlePrivateClick},r.createElement("i",{className:i("icon-radio",{"is-checked":"private"===this.props.visibility})}),r.createElement("span",{className:"spacer-left"},Object(s.l)("visibility.private"))):r.createElement("span",{className:"huge-spacer-left text-muted cursor-not-allowed",id:"visibility-private"},r.createElement("i",{className:i("icon-radio",{"is-checked":"private"===this.props.visibility})}),r.createElement("span",{className:"spacer-left"},Object(s.l)("visibility.private"))))},t}(r.PureComponent);t.a=p},1136:function(e,t,n){"use strict";var o,r=n(0),i=n(968),s=n(42),a=n(897),p=n(213),l=n(34),c=n(1),u=(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),m=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.mounted=!1,t.state={done:!1,loading:!0},t.fetchPermissionTemplates=function(){Object(i.k)(t.props.organization).then(function(e){var n=e.permissionTemplates;t.mounted&&t.setState({loading:!1,permissionTemplates:n})},function(){t.mounted&&t.setState({loading:!1})})},t.handleSubmit=function(){return t.state.permissionTemplate?Object(i.b)({organization:t.props.organization,projectKey:t.props.project.key,templateId:t.state.permissionTemplate}).then(function(){t.mounted&&(t.props.onApply&&t.props.onApply(),t.setState({done:!0}))}):Promise.reject(void 0)},t.handlePermissionTemplateChange=function(e){var n=e.value;t.setState({permissionTemplate:n})},t}return u(t,e),t.prototype.componentDidMount=function(){this.mounted=!0,this.fetchPermissionTemplates()},t.prototype.componentWillUnmount=function(){this.mounted=!1},t.prototype.render=function(){var e=this,t=Object(c.m)("projects_role.apply_template_to_xxx",this.props.project.name);return r.createElement(a.a,{header:t,onClose:this.props.onClose,onSubmit:this.handleSubmit},function(n){var o=n.onCloseClick,i=n.onFormSubmit,a=n.submitting;return r.createElement("form",{id:"project-permissions-apply-template-form",onSubmit:i},r.createElement("header",{className:"modal-head"},r.createElement("h2",null,t)),r.createElement("div",{className:"modal-body"},e.state.done?r.createElement("div",{className:"alert alert-success"},Object(c.l)("projects_role.apply_template.success")):r.createElement(r.Fragment,null,e.state.loading?r.createElement("i",{className:"spinner"}):r.createElement("div",{className:"modal-field"},r.createElement("label",{htmlFor:"project-permissions-template"},Object(c.l)("template"),r.createElement("em",{className:"mandatory"},"*")),e.state.permissionTemplates&&r.createElement(p.c,{clearable:!1,onChange:e.handlePermissionTemplateChange,options:e.state.permissionTemplates.map(function(e){return{label:e.name,value:e.id}}),value:e.state.permissionTemplate})))),r.createElement("footer",{className:"modal-foot"},r.createElement(s.a,{className:"spacer-right",loading:a}),!e.state.done&&r.createElement(l.f,{disabled:a||!e.state.permissionTemplate},Object(c.l)("apply")),r.createElement(l.e,{onClick:o},Object(c.l)(e.state.done?"close":"cancel"))))})},t}(r.PureComponent);t.a=m},1137:function(e,t,n){(e.exports=n(28)(!1)).push([e.i,".upgrade-organization-box{max-width:400px;background-color:#f3f3f3!important}",""])},1138:function(e,t,n){var o=n(1137);"string"==typeof o&&(o=[[e.i,o,""]]);var r={hmr:!0,transform:void 0,insertInto:void 0};n(27)(o,r);o.locals&&(e.exports=o.locals)},1139:function(e,t,n){"use strict";n.d(t,"b",function(){return o}),n.d(t,"a",function(){return i});var o=["user","codeviewer","issueadmin","admin","scan"],r=["user","admin"],i={TRK:o,VW:r,SVW:r,APP:r,DEV:["user","admin"]}},1141:function(e,t,n){"use strict";var o=n(0),r=n(15),i=n(13);t.a=Object(r.connect)(function(e){return{message:Object(i.getPermissionsAppError)(e)}})(function(e){var t=e.message;return t?o.createElement("div",{className:"alert alert-danger"},t):null})},1562:function(e,t,n){"use strict";n.r(t);var o,r=n(15),i=n(73),s=n.n(i),a=n(0),p=n.n(a),l=n(212),c=n.n(l),u=n(1142),m=n(1127),d=n(1),f=n(1139),h=(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),g=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.handleToggleUser=function(e,n){return e.permissions.includes(n)?t.props.revokePermissionFromUser(e.login,n):t.props.grantPermissionToUser(e.login,n)},t.handleToggleGroup=function(e,n){return e.permissions.includes(n)?t.props.revokePermissionFromGroup(e.name,n):t.props.grantPermissionToGroup(e.name,n)},t.handleSelectPermission=function(e){t.props.onPermissionSelect(e)},t}return h(t,e),t.prototype.render=function(){var e=f.a[this.props.component.qualifier];"public"===this.props.visibility&&(e=s()(e,"user","codeviewer"));var t=e.map(function(e){return{key:e,name:Object(d.l)("projects_role",e),description:Object(d.l)("projects_role",e,"desc")}});return p.a.createElement(m.a,{groups:this.props.groups,onSelectPermission:this.handleSelectPermission,onToggleGroup:this.handleToggleGroup,onToggleUser:this.handleToggleUser,permissions:t,selectedPermission:this.props.selectedPermission,users:this.props.users},p.a.createElement(u.a,{filter:this.props.filter,onFilter:this.props.onFilterChange,onSearch:this.props.onQueryChange,query:this.props.query}))},t}(p.a.PureComponent),b=n(1136),y=n(34),v=function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),P=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.mounted=!1,t.state={applyTemplateModal:!1},t.handleApplyTemplate=function(){t.setState({applyTemplateModal:!0})},t.handleApplyTemplateClose=function(){t.mounted&&t.setState({applyTemplateModal:!1})},t}return v(t,e),t.prototype.componentDidMount=function(){this.mounted=!0},t.prototype.componentWillUnmount=function(){this.mounted=!1},t.prototype.render=function(){var e=this.props.component,t=e.configuration,n=null!=t&&t.canApplyPermissionTemplate,o=["VW","SVW","APP"].includes(e.qualifier)?Object(d.l)("roles.page.description_portfolio"):Object(d.l)("roles.page.description2"),r="TRK"===e.qualifier&&e.visibility?Object(d.l)("visibility",e.visibility,"description",e.qualifier):null;return a.createElement("header",{className:"page-header"},a.createElement("h1",{className:"page-title"},Object(d.l)("permissions.page")),this.props.loading&&a.createElement("i",{className:"spinner"}),n&&a.createElement("div",{className:"page-actions"},a.createElement(y.a,{className:"js-apply-template",onClick:this.handleApplyTemplate},Object(d.l)("projects_role.apply_template")),this.state.applyTemplateModal&&a.createElement(b.a,{onApply:this.props.loadHolders,onClose:this.handleApplyTemplateClose,organization:e.organization,project:e})),a.createElement("div",{className:"page-description"},a.createElement("p",null,o),null!=r&&a.createElement("p",null,r)))},t}(a.PureComponent),_=n(87),j=function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),C=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.handleConfirmClick=function(){t.props.onConfirm(),t.props.onClose()},t}return j(t,e),t.prototype.render=function(){var e=this.props.component.qualifier;return p.a.createElement(_.a,{contentLabel:"modal form",onRequestClose:this.props.onClose},p.a.createElement("header",{className:"modal-head"},p.a.createElement("h2",null,Object(d.m)("projects_role.turn_x_to_public",this.props.component.name))),p.a.createElement("div",{className:"modal-body"},p.a.createElement("p",null,Object(d.l)("projects_role.are_you_sure_to_turn_project_to_public",e)),p.a.createElement("p",{className:"spacer-top"},Object(d.l)("projects_role.are_you_sure_to_turn_project_to_public.2",e))),p.a.createElement("footer",{className:"modal-foot"},p.a.createElement(y.a,{id:"confirm-turn-to-public",onClick:this.handleConfirmClick},Object(d.l)("projects_role.turn_project_to_public",e)),p.a.createElement(y.e,{onClick:this.props.onClose},Object(d.l)("cancel"))))},t}(p.a.PureComponent),E=n(1084),O=n(1135),T=n(1141),S=n(968),k=(n(1140),function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function o(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}()),N=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},F=function(e){function t(t){var n=e.call(this,t)||this;return n.stopLoading=function(){n.mounted&&n.setState({loading:!1})},n.loadHolders=function(){if(n.mounted){n.setState({loading:!0});var e=n.props.component,t=n.state,o=t.filter,r=t.query,i=t.selectedPermission,s="groups"!==o?S.m(e.key,r,i,e.organization):Promise.resolve([]),a="users"!==o?S.l(e.key,r,i,e.organization):Promise.resolve([]);Promise.all([s,a]).then(function(e){n.mounted&&n.setState({loading:!1,groups:e[1],users:e[0]})},function(e){n.mounted&&(n.props.onRequestFail(e),n.setState({loading:!1}))})}},n.handleFilterChange=function(e){n.mounted&&n.setState({filter:e},n.loadHolders)},n.handleQueryChange=function(e){n.mounted&&n.setState({query:e},n.loadHolders)},n.handlePermissionSelect=function(e){n.mounted&&n.setState(function(t){return{selectedPermission:t.selectedPermission===e?void 0:e}},n.loadHolders)},n.addPermissionToGroup=function(e,t){return n.state.groups.map(function(n){return n.name===e?N({},n,{permissions:n.permissions.concat([t])}):n})},n.addPermissionToUser=function(e,t){return n.state.users.map(function(n){return n.login===e?N({},n,{permissions:n.permissions.concat([t])}):n})},n.removePermissionFromGroup=function(e,t){return n.state.groups.map(function(n){return n.name===e?N({},n,{permissions:s()(n.permissions,t)}):n})},n.removePermissionFromUser=function(e,t){return n.state.users.map(function(n){return n.login===e?N({},n,{permissions:s()(n.permissions,t)}):n})},n.grantPermissionToGroup=function(e,t){return n.mounted?(n.setState({loading:!0,groups:n.addPermissionToGroup(e,t)}),S.n(n.props.component.key,e,t,n.props.component.organization).then(n.stopLoading,function(o){n.mounted&&(n.setState({loading:!1,groups:n.removePermissionFromGroup(e,t)}),n.props.onRequestFail(o))})):Promise.resolve()},n.grantPermissionToUser=function(e,t){return n.mounted?(n.setState({loading:!0,users:n.addPermissionToUser(e,t)}),S.o(n.props.component.key,e,t,n.props.component.organization).then(n.stopLoading,function(o){n.mounted&&(n.setState({loading:!1,users:n.removePermissionFromUser(e,t)}),n.props.onRequestFail(o))})):Promise.resolve()},n.revokePermissionFromGroup=function(e,t){return n.mounted?(n.setState({loading:!0,groups:n.removePermissionFromGroup(e,t)}),S.s(n.props.component.key,e,t,n.props.component.organization).then(n.stopLoading,function(o){n.mounted&&(n.setState({loading:!1,groups:n.addPermissionToGroup(e,t)}),n.props.onRequestFail(o))})):Promise.resolve()},n.revokePermissionFromUser=function(e,t){return n.mounted?(n.setState({loading:!0,users:n.removePermissionFromUser(e,t)}),S.t(n.props.component.key,e,t,n.props.component.organization).then(n.stopLoading,function(o){n.mounted&&(n.setState({loading:!1,users:n.addPermissionToUser(e,t)}),n.props.onRequestFail(o))})):Promise.resolve()},n.handleVisibilityChange=function(e){"public"===e?n.openDisclaimer():n.turnProjectToPrivate()},n.turnProjectToPublic=function(){n.props.onComponentChange({visibility:"public"}),S.d(n.props.component.key,"public").then(function(){n.loadHolders()},function(e){n.props.onComponentChange({visibility:"private"}),n.props.onRequestFail(e)})},n.turnProjectToPrivate=function(){n.props.onComponentChange({visibility:"private"}),S.d(n.props.component.key,"private").then(function(){n.loadHolders()},function(e){n.props.onComponentChange({visibility:"public"}),n.props.onRequestFail(e)})},n.openDisclaimer=function(){n.mounted&&n.setState({disclaimer:!0})},n.closeDisclaimer=function(){n.mounted&&n.setState({disclaimer:!1})},n.state={disclaimer:!1,filter:"all",groups:[],loading:!0,query:"",users:[]},n}return k(t,e),t.prototype.componentDidMount=function(){this.mounted=!0,this.loadHolders()},t.prototype.componentWillUnmount=function(){this.mounted=!1},t.prototype.render=function(){var e=null!=this.props.component.configuration&&this.props.component.configuration.canUpdateProjectVisibilityToPrivate;return p.a.createElement("div",{className:"page page-limited",id:"project-permissions-page"},p.a.createElement(c.a,{title:Object(d.l)("permissions.page")}),p.a.createElement(P,{component:this.props.component,loading:this.state.loading,loadHolders:this.loadHolders}),p.a.createElement(T.a,null),p.a.createElement("div",null,p.a.createElement(O.a,{canTurnToPrivate:e,className:"big-spacer-top big-spacer-bottom",onChange:this.handleVisibilityChange,visibility:this.props.component.visibility}),"TRK"===this.props.component.qualifier&&!e&&p.a.createElement(E.a,{organization:this.props.component.organization}),this.state.disclaimer&&p.a.createElement(C,{component:this.props.component,onClose:this.closeDisclaimer,onConfirm:this.turnProjectToPublic})),p.a.createElement(g,{component:this.props.component,filter:this.state.filter,grantPermissionToGroup:this.grantPermissionToGroup,grantPermissionToUser:this.grantPermissionToUser,groups:this.state.groups,onFilterChange:this.handleFilterChange,onPermissionSelect:this.handlePermissionSelect,onQueryChange:this.handleQueryChange,query:this.state.query,revokePermissionFromGroup:this.revokePermissionFromGroup,revokePermissionFromUser:this.revokePermissionFromUser,selectedPermission:this.state.selectedPermission,users:this.state.users,visibility:this.props.component.visibility}))},t}(p.a.PureComponent),w=n(116),q=n(13);t.default=Object(r.connect)(function(e){return{currentUser:Object(q.getCurrentUser)(e)}},function(e){return{onRequestFail:Object(w.g)(e)}})(F)},897:function(e,t,n){"use strict";var o,r=n(0),i=n(87),s=(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),a=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.mounted=!1,t.state={submitting:!1},t.stopSubmitting=function(){t.mounted&&t.setState({submitting:!1})},t.handleCloseClick=function(e){e&&(e.preventDefault(),e.currentTarget.blur()),t.props.onClose()},t.handleFormSubmit=function(e){e.preventDefault(),t.submit()},t.handleSubmitClick=function(e){e&&(e.preventDefault(),e.currentTarget.blur()),t.submit()},t.submit=function(){var e=t.props.onSubmit();e&&(t.setState({submitting:!0}),e.then(t.stopSubmitting,t.stopSubmitting))},t}return s(t,e),t.prototype.componentDidMount=function(){this.mounted=!0},t.prototype.componentWillUnmount=function(){this.mounted=!1},t.prototype.render=function(){return r.createElement(i.a,{contentLabel:this.props.header,onRequestClose:this.props.onClose},this.props.children({onCloseClick:this.handleCloseClick,onFormSubmit:this.handleFormSubmit,onSubmitClick:this.handleSubmitClick,submitting:this.state.submitting}))},t}(r.Component);t.a=a}}]);
//# sourceMappingURL=321.34c8ffcb.chunk.js.map